###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.40194/W32 for 8051         26/May/2020  10:28:46 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  F:\github\zigbee_easy_module\zigbee_easy_module\Co #
#                          mponents\stack\zdo\ZDApp.c                         #
#    Command line       =  -f F:\github\zigbee_easy_module\zigbee_easy_module #
#                          \Projects\zstack\zigbee_easy_module\zigbee_easy_mo #
#                          dule_APP\CC2530DB\..\..\..\Tools\CC2530DB\f8wEndev #
#                          .cfg (-DCPU32MHZ -DROOT=__near_func                #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f F:\github\zigbee_easy_modul #
#                          e\zigbee_easy_module\Projects\zstack\zigbee_easy_m #
#                          odule\zigbee_easy_module_APP\CC2530DB\..\..\..\Too #
#                          ls\CC2530DB\f8wConfig.cfg (-DZIGBEEPRO -DSECURE=0  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x04000000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 F:\github\zigbee_easy_modul #
#                          e\zigbee_easy_module\Components\stack\zdo\ZDApp.c  #
#                          -D NWK_AUTO_POLL -D ZTOOL_P1 -D HAL_UART=TRUE -D   #
#                          NV_INIT -D NV_RESTORE -D MT_TASK -D MT_SYS_FUNC    #
#                          -D MT_ZDO_FUNC -lC F:\github\zigbee_easy_module\zi #
#                          gbee_easy_module\Projects\zstack\zigbee_easy_modul #
#                          e\zigbee_easy_module_APP\CC2530DB\EndDeviceEB\List #
#                          \ -lA F:\github\zigbee_easy_module\zigbee_easy_mod #
#                          ule\Projects\zstack\zigbee_easy_module\zigbee_easy #
#                          _module_APP\CC2530DB\EndDeviceEB\List\             #
#                          --diag_suppress Pe001,Pa010 -o                     #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\EndDeviceEB\Obj\ -e                 #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I F:\github\zigbee_easy_module\zigbee_easy_module #
#                          \Projects\zstack\zigbee_easy_module\zigbee_easy_mo #
#                          dule_APP\CC2530DB\ -I F:\github\zigbee_easy_module #
#                          \zigbee_easy_module\Projects\zstack\zigbee_easy_mo #
#                          dule\zigbee_easy_module_APP\CC2530DB\..\Source\    #
#                          -I F:\github\zigbee_easy_module\zigbee_easy_module #
#                          \Projects\zstack\zigbee_easy_module\zigbee_easy_mo #
#                          dule_APP\CC2530DB\..\..\..\ZMain\TI2530DB\ -I      #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\hal\inclu #
#                          de\ -I F:\github\zigbee_easy_module\zigbee_easy_mo #
#                          dule\Projects\zstack\zigbee_easy_module\zigbee_eas #
#                          y_module_APP\CC2530DB\..\..\..\..\..\Components\ha #
#                          l\target\CC2530EB\ -I F:\github\zigbee_easy_module #
#                          \zigbee_easy_module\Projects\zstack\zigbee_easy_mo #
#                          dule\zigbee_easy_module_APP\CC2530DB\..\..\..\..\. #
#                          .\Components\mac\include\ -I                       #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\mac\high_ #
#                          level\ -I F:\github\zigbee_easy_module\zigbee_easy #
#                          _module\Projects\zstack\zigbee_easy_module\zigbee_ #
#                          easy_module_APP\CC2530DB\..\..\..\..\..\Components #
#                          \mac\low_level\srf04\ -I                           #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\mac\low_l #
#                          evel\srf04\single_chip\ -I                         #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\mt\ -I    #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\osal\incl #
#                          ude\ -I F:\github\zigbee_easy_module\zigbee_easy_m #
#                          odule\Projects\zstack\zigbee_easy_module\zigbee_ea #
#                          sy_module_APP\CC2530DB\..\..\..\..\..\Components\s #
#                          ervices\saddr\ -I F:\github\zigbee_easy_module\zig #
#                          bee_easy_module\Projects\zstack\zigbee_easy_module #
#                          \zigbee_easy_module_APP\CC2530DB\..\..\..\..\..\Co #
#                          mponents\services\sdata\ -I                        #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\stack\af\ #
#                           -I F:\github\zigbee_easy_module\zigbee_easy_modul #
#                          e\Projects\zstack\zigbee_easy_module\zigbee_easy_m #
#                          odule_APP\CC2530DB\..\..\..\..\..\Components\stack #
#                          \nwk\ -I F:\github\zigbee_easy_module\zigbee_easy_ #
#                          module\Projects\zstack\zigbee_easy_module\zigbee_e #
#                          asy_module_APP\CC2530DB\..\..\..\..\..\Components\ #
#                          stack\sapi\ -I F:\github\zigbee_easy_module\zigbee #
#                          _easy_module\Projects\zstack\zigbee_easy_module\zi #
#                          gbee_easy_module_APP\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sec\ -I F:\github\zigbee_easy_module\z #
#                          igbee_easy_module\Projects\zstack\zigbee_easy_modu #
#                          le\zigbee_easy_module_APP\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\sys\ -I                           #
#                          F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\..\..\..\..\..\Components\stack\zdo #
#                          \ -I F:\github\zigbee_easy_module\zigbee_easy_modu #
#                          le\Projects\zstack\zigbee_easy_module\zigbee_easy_ #
#                          module_APP\CC2530DB\..\..\..\..\..\Components\zmac #
#                          \ -I F:\github\zigbee_easy_module\zigbee_easy_modu #
#                          le\Projects\zstack\zigbee_easy_module\zigbee_easy_ #
#                          module_APP\CC2530DB\..\..\..\..\..\Components\zmac #
#                          \f8w\ -Ohz --require_prototypes                    #
#    List file          =  F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\EndDeviceEB\List\ZDApp.lst          #
#    Object file        =  F:\github\zigbee_easy_module\zigbee_easy_module\Pr #
#                          ojects\zstack\zigbee_easy_module\zigbee_easy_modul #
#                          e_APP\CC2530DB\EndDeviceEB\Obj\ZDApp.r51           #
#                                                                             #
#                                                                             #
###############################################################################

F:\github\zigbee_easy_module\zigbee_easy_module\Components\stack\zdo\ZDApp.c
      1          /**************************************************************************************************
      2            Filename:       ZDApp.c
      3            Revised:        $Date: 2012-02-16 16:04:32 -0800 (Thu, 16 Feb 2012) $
      4            Revision:       $Revision: 29348 $
      5          
      6            Description:    This file contains the interface to the Zigbee Device Application. This is the
      7                            Application part that the user can change. This also contains the Task functions.
      8          
      9          
     10            Copyright 2004-2012 Texas Instruments Incorporated. All rights reserved.
     11          
     12            IMPORTANT: Your use of this Software is limited to those specific rights
     13            granted under the terms of a software license agreement between the user
     14            who downloaded the software, his/her employer (which must be your employer)
     15            and Texas Instruments Incorporated (the "License").  You may not use this
     16            Software unless you agree to abide by the terms of the License. The License
     17            limits your use, and you acknowledge, that the Software may not be modified,
     18            copied or distributed unless embedded on a Texas Instruments microcontroller
     19            or used solely and exclusively in conjunction with a Texas Instruments radio
     20            frequency transceiver, which is integrated into your product.  Other than for
     21            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     22            works of, modify, distribute, perform, display or sell this Software and/or
     23            its documentation for any purpose.
     24          
     25            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     26            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     27            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     28            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     29            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     30            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     31            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     32            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     33            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     34            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     35            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     36          
     37            Should you have any questions regarding your right to use this Software,
     38            contact Texas Instruments Incorporated at www.TI.com.
     39          **************************************************************************************************/
     40          
     41          /*********************************************************************
     42           * INCLUDES
     43           */
     44          
     45          #include "ZComDef.h"
     46          #include "ZMac.h"
     47          #include "OSAL.h"
     48          #include "OSAL_Tasks.h"
     49          #include "OSAL_PwrMgr.h"
     50          #include "OSAL_Nv.h"
     51          #include "AF.h"
     52          #include "APSMEDE.h"
     53          #include "NLMEDE.h"
     54          #include "AddrMgr.h"
     55          #include "ZDProfile.h"
     56          #include "ZDObject.h"
     57          #include "ZDConfig.h"
     58          #include "ZDSecMgr.h"
     59          #include "ZDApp.h"
     60          #include "DebugTrace.h"
     61          #include "nwk_util.h"
     62          #include "OnBoard.h"
     63          #include "ZGlobals.h"
     64          #include "ZDNwkMgr.h"
     65          #include "rtg.h"
     66          
     67          #include "ssp.h"
     68          
     69          /* HAL */
     70          #include "hal_led.h"
     71          #include "hal_lcd.h"
     72          #include "hal_key.h"
     73          
     74          #if defined( MT_MAC_FUNC ) || defined( MT_MAC_CB_FUNC )
     75            #error "ERROR! MT_MAC functionalities should be disabled on ZDO devices"
     76          #endif
     77          
     78          /*********************************************************************
     79           * CONSTANTS
     80           */
     81          
     82          #if !defined( NWK_START_DELAY )
     83            #define NWK_START_DELAY             100   // in milliseconds
     84          #endif
     85          
     86          #if !defined( LEAVE_RESET_DELAY )
     87            #define LEAVE_RESET_DELAY           5000  // in milliseconds
     88          #endif
     89          
     90          // Init ZDO, but hold and wait for application to start the joining or
     91          // forming network
     92          #define ZDO_INIT_HOLD_NWK_START       0xFFFF
     93          
     94          #if !defined( EXTENDED_JOINING_RANDOM_MASK )
     95            #define EXTENDED_JOINING_RANDOM_MASK 0x007F
     96          #endif
     97          
     98          #if !defined( BEACON_REQUEST_DELAY )
     99            #define BEACON_REQUEST_DELAY        100   // in milliseconds
    100          #endif
    101          
    102          #if !defined( BEACON_REQ_DELAY_MASK )
    103            #define BEACON_REQ_DELAY_MASK       0x007F
    104          #endif
    105          
    106          #define MAX_RESUME_RETRY            3
    107          
    108          #define MAX_DEVICE_UNAUTH_TIMEOUT   5000  // 5 seconds
    109          
    110          // Beacon Order Settings (see NLMEDE.h)
    111          #define DEFAULT_BEACON_ORDER        BEACON_ORDER_NO_BEACONS
    112          #define DEFAULT_SUPERFRAME_ORDER    DEFAULT_BEACON_ORDER
    113          
    114          #if !defined( MAX_NWK_FRAMECOUNTER_CHANGES )
    115            // The number of times the frame counter can change before
    116            // saving to NV
    117            #define MAX_NWK_FRAMECOUNTER_CHANGES    1000
    118          #endif
    119          
    120          // Leave control bits
    121          #define ZDAPP_LEAVE_CTRL_INIT 0
    122          #define ZDAPP_LEAVE_CTRL_SET  1
    123          #define ZDAPP_LEAVE_CTRL_RA   2
    124          
    125          // Address Manager Stub Implementation
    126          #define ZDApp_NwkWriteNVRequest AddrMgrWriteNVRequest
    127          
    128          
    129          #if !defined ZDO_NV_SAVE_RFDs
    130          #define ZDO_NV_SAVE_RFDs  TRUE
    131          #endif
    132          
    133          // Delay time before updating NWK NV data to force fewer writes during high activity.
    134          #if ZDO_NV_SAVE_RFDs
    135          #define ZDAPP_UPDATE_NWK_NV_TIME 700
    136          #else
    137          #define ZDAPP_UPDATE_NWK_NV_TIME 65000
    138          #endif
    139          
    140          /*********************************************************************
    141           * GLOBAL VARIABLES
    142           */
    143          
    144          #if defined( LCD_SUPPORTED )
    145            uint8 MatchRsps = 0;
    146          #endif
    147          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    148          uint8 zdoDiscCounter = 1;
   \                     zdoDiscCounter:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for zdoDiscCounter>`
   \   000001                REQUIRE __INIT_XDATA_I
    149          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150          zAddrType_t ZDAppNwkAddr;
   \                     ZDAppNwkAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z
    151          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    152          uint8 zdappMgmtNwkDiscRspTransSeq;
   \                     zdappMgmtNwkDiscRspTransSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    153          uint8 zdappMgmtNwkDiscReqInProgress = FALSE;
   \                     zdappMgmtNwkDiscReqInProgress:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    154          zAddrType_t zdappMgmtNwkDiscRspAddr;
   \                     zdappMgmtNwkDiscRspAddr:
   \   000000                DS 9
   \   000009                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    155          uint8 zdappMgmtNwkDiscStartIndex;
   \                     zdappMgmtNwkDiscStartIndex:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    156          uint8 zdappMgmtSavedNwkState;
   \                     zdappMgmtSavedNwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    157          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    158          uint16 nwkFrameCounterChanges = 0;
   \                     nwkFrameCounterChanges:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    159          uint8 continueJoining = TRUE;
   \                     continueJoining:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for continueJoining>`
   \   000001                REQUIRE __INIT_XDATA_I
    160          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    161          uint8  _tmpRejoinState;
   \                     _tmpRejoinState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    162          
    163          // The extended PanID used in ZDO layer for rejoin.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    164          uint8 ZDO_UseExtendedPANID[Z_EXTADDR_LEN];
   \                     ZDO_UseExtendedPANID:
   \   000000                DS 8
   \   000008                REQUIRE __INIT_XDATA_Z
    165          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    166          pfnZdoCb zdoCBFunc[MAX_ZDO_CB_FUNC];
   \                     zdoCBFunc:
   \   000000                DS 14
   \   00000E                REQUIRE __INIT_XDATA_Z
    167          
    168          /*********************************************************************
    169           * EXTERNAL VARIABLES
    170           */
    171          
    172          /*********************************************************************
    173           * EXTERNAL FUNCTIONS
    174           */
    175          
    176          /*********************************************************************
    177           * LOCAL FUNCTIONS
    178           */
    179          
    180          void ZDApp_NetworkStartEvt( void );
    181          void ZDApp_DeviceAuthEvt( void );
    182          void ZDApp_SaveNetworkStateEvt( void );
    183          
    184          uint8 ZDApp_ReadNetworkRestoreState( void );
    185          uint8 ZDApp_RestoreNetworkState( void );
    186          void ZDAppDetermineDeviceType( void );
    187          void ZDApp_InitUserDesc( void );
    188          void ZDAppCheckForHoldKey( void );
    189          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr );
    190          void ZDApp_ProcessNetworkJoin( void );
    191          void ZDApp_SetCoordAddress( uint8 endPoint, uint8 dstEP );
    192          uint8 ZDApp_RestoreNwkKey( void );
    193          networkDesc_t* ZDApp_NwkDescListProcessing(void);
    194          
    195          void ZDApp_SecInit( uint8 state );
    196          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events );
    197          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr );
    198          
    199          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf );
    200          
    201          void ZDApp_ResetTimerStart( uint16 delay );
    202          void ZDApp_ResetTimerCancel( void );
    203          void ZDApp_LeaveCtrlInit( void );
    204          void ZDApp_LeaveCtrlSet( uint8 ra );
    205          uint8 ZDApp_LeaveCtrlBypass( void );
    206          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay );
    207          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
    208                                  uint8 removeChildren );
    209          void ZDApp_NodeProfileSync( uint8 stackProfile );
    210          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg );
    211          void ZDApp_RegisterCBs( void );
    212          void ZDApp_InitZdoCBFunc(void);
    213          
    214          /*********************************************************************
    215           * LOCAL VARIABLES
    216           */
    217          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    218          uint8 ZDAppTaskID;
   \                     ZDAppTaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    219          uint8 nwkStatus;
   \                     nwkStatus:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    220          endPointDesc_t *ZDApp_AutoFindMode_epDesc = (endPointDesc_t *)NULL;
   \                     ZDApp_AutoFindMode_epDesc:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    221          uint8 ZDApp_LeaveCtrl;
   \                     ZDApp_LeaveCtrl:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    222          
    223          #if defined( HOLD_AUTO_START )
    224            devStates_t devState = DEV_HOLD;
    225          #else

   \                                 In  segment XDATA_I, align 1, keep-with-next
    226            devStates_t devState = DEV_INIT;
   \                     devState:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for devState>`
   \   000001                REQUIRE __INIT_XDATA_I
    227          #endif
    228          
    229          #if ( ZG_BUILD_RTRONLY_TYPE ) || ( ZG_BUILD_ENDDEVICE_TYPE )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    230            devStartModes_t devStartMode = MODE_JOIN;     // Assume joining
   \                     devStartMode:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    231            //devStartModes_t devStartMode = MODE_RESUME; // if already "directly joined"
    232                                  // to parent. Set to make the device do an Orphan scan.
    233          #else
    234            // Set the default to coodinator
    235            devStartModes_t devStartMode = MODE_HARD;
    236          #endif
    237          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    238          uint8 retryCnt;
   \                     retryCnt:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    239          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    240          endPointDesc_t ZDApp_epDesc =
   \                     ZDApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for ZDApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
    241          {
    242            ZDO_EP,
    243            &ZDAppTaskID,
    244            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for ZDO
    245            (afNetworkLatencyReq_t)0            // No Network Latency req
    246          };
    247          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    248          uint16 ZDApp_SavedPollRate = POLL_RATE;
   \                     ZDApp_SavedPollRate:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDApp_SavedPollRate>`
   \   000002                REQUIRE __INIT_XDATA_I
    249          
    250          /*********************************************************************
    251           * @fn      ZDApp_Init
    252           *
    253           * @brief   ZDApp Initialization function.
    254           *
    255           * @param   task_id - ZDApp Task ID
    256           *
    257           * @return  None
    258           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    259          void ZDApp_Init( uint8 task_id )
   \                     ZDApp_Init:
    260          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    261            // Save the task ID
    262            ZDAppTaskID = task_id;
   \   000006   90....       MOV     DPTR,#ZDAppTaskID
   \   000009   F0           MOVX    @DPTR,A
    263          
    264            // Initialize the ZDO global device short address storage
    265            ZDAppNwkAddr.addrMode = Addr16Bit;
   \   00000A   90....       MOV     DPTR,#ZDAppNwkAddr + 8
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    266            ZDAppNwkAddr.addr.shortAddr = INVALID_NODE_ADDR;
   \   000010   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000013   74FE         MOV     A,#-0x2
   \   000015   F0           MOVX    @DPTR,A
   \   000016   A3           INC     DPTR
   \   000017   04           INC     A
   \   000018   F0           MOVX    @DPTR,A
    267            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   000019                ; Setup parameters for call to function NLME_GetExtAddr
   \   000019   12....       LCALL   ??NLME_GetExtAddr?relay
    268          
    269            // Check for manual "Hold Auto Start"
    270            ZDAppCheckForHoldKey();
   \   00001C                ; Setup parameters for call to function ZDAppCheckForHoldKey
   \   00001C   12....       LCALL   ??ZDAppCheckForHoldKey?relay
    271          
    272            // Initialize ZDO items and setup the device - type of device to create.
    273            ZDO_Init();
   \   00001F                ; Setup parameters for call to function ZDO_Init
   \   00001F   12....       LCALL   ??ZDO_Init?relay
    274          
    275            // Register the endpoint description with the AF
    276            // This task doesn't have a Simple description, but we still need
    277            // to register the endpoint.
    278            afRegister( (endPointDesc_t *)&ZDApp_epDesc );
   \   000022                ; Setup parameters for call to function afRegister
   \   000022   7A..         MOV     R2,#ZDApp_epDesc & 0xff
   \   000024   7B..         MOV     R3,#(ZDApp_epDesc >> 8) & 0xff
   \   000026   12....       LCALL   ??afRegister?relay
    279          
    280          #if defined( ZDO_USERDESC_RESPONSE )
    281            ZDApp_InitUserDesc();
   \   000029                ; Setup parameters for call to function ZDApp_InitUserDesc
   \   000029   12....       LCALL   ??ZDApp_InitUserDesc?relay
    282          #endif // ZDO_USERDESC_RESPONSE
    283          
    284            // Start the device?
    285            if ( devState != DEV_HOLD )
   \   00002C   90....       MOV     DPTR,#devState
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   6009         JZ      ??ZDApp_Init_0
    286            {
    287              ZDOInitDevice( 0 );
   \   000032                ; Setup parameters for call to function ZDOInitDevice
   \   000032   7A00         MOV     R2,#0x0
   \   000034   7B00         MOV     R3,#0x0
   \   000036   12....       LCALL   ??ZDOInitDevice?relay
   \   000039   8014         SJMP    ??ZDApp_Init_1
    288            }
    289            else
    290            {
    291              ZDOInitDevice( ZDO_INIT_HOLD_NWK_START );
   \                     ??ZDApp_Init_0:
   \   00003B                ; Setup parameters for call to function ZDOInitDevice
   \   00003B   7AFF         MOV     R2,#-0x1
   \   00003D   7BFF         MOV     R3,#-0x1
   \   00003F   12....       LCALL   ??ZDOInitDevice?relay
    292              // Blink LED to indicate HOLD_START
    293              HalLedBlink ( HAL_LED_4, 0, 50, 500 );
   \   000042                ; Setup parameters for call to function HalLedBlink
   \   000042   7CF4         MOV     R4,#-0xc
   \   000044   7D01         MOV     R5,#0x1
   \   000046   7B32         MOV     R3,#0x32
   \   000048   7A00         MOV     R2,#0x0
   \   00004A   7908         MOV     R1,#0x8
   \   00004C   12....       LCALL   ??HalLedBlink?relay
    294            }
    295          
    296            // Initialize the ZDO callback function pointers zdoCBFunc[]
    297            ZDApp_InitZdoCBFunc();
   \                     ??ZDApp_Init_1:
   \   00004F                ; Setup parameters for call to function ZDApp_InitZdoCBFunc
   \   00004F   12....       LCALL   ??ZDApp_InitZdoCBFunc?relay
    298          
    299            ZDApp_RegisterCBs();
   \   000052                ; Setup parameters for call to function ZDApp_RegisterCBs
   \   000052   12....       LCALL   ??ZDApp_RegisterCBs?relay
    300          } /* ZDApp_Init() */
   \   000055   02....       LJMP    ??Subroutine54_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine54_0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    301          
    302          /*********************************************************************
    303           * @fn          ZDApp_SecInit
    304           *
    305           * @brief       ZDApp initialize security.
    306           *
    307           * @param       state - device initialization state
    308           *
    309           * @return      none
    310           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    311          void ZDApp_SecInit( uint8 state )
   \                     ZDApp_SecInit:
    312          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    313            uint8 zgPreConfigKey[SEC_KEY_LEN];
    314          
    315            if ( ZG_SECURE_ENABLED && ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    316            {
    317              // Set the Trust Center bit
    318              ZDO_Config_Node_Descriptor.ServerMask |= PRIM_TRUST_CENTER;
    319            }
    320          
    321            if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
    322            {
    323              ZDO_Config_Node_Descriptor.CapabilityFlags |= CAPINFO_SECURITY_CAPABLE;
    324            }
    325          
    326            // Initialize ZigBee Device Security Manager
    327            ZDSecMgrInit(state);
   \   000005                ; Setup parameters for call to function ZDSecMgrInit
   \   000005   12....       LCALL   ??ZDSecMgrInit?relay
    328          
    329            if ( ZG_SECURE_ENABLED )
    330            {
    331              if ( state != ZDO_INITDEV_RESTORED_NETWORK_STATE )
    332              {
    333                nwkFrameCounter = 0;
    334          
    335                if( _NIB.nwkKeyLoaded == FALSE )
    336                {
    337                  if ( ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE          ) ||
    338                       ( ( zgSecurityMode == ZG_SECURITY_RESIDENTIAL ) && zgPreConfigKeys )    )
    339                  {
    340                      ZDSecMgrReadKeyFromNv(ZCD_NV_PRECFGKEY, zgPreConfigKey);
    341                      SSP_UpdateNwkKey( zgPreConfigKey, 0);
    342                      SSP_SwitchNwkKey( 0 );
    343          
    344                      // clear local copy of key
    345                      osal_memset(zgPreConfigKey, 0x00, SEC_KEY_LEN);
    346                  }
    347                }
    348              }
    349            }
    350          }
   \   000008   02....       LJMP    ??Subroutine54_0 & 0xFFFF
    351          
    352          /*********************************************************************
    353           * @fn      ZDApp_event_loop()
    354           *
    355           * @brief   Main event loop for Zigbee device objects task. This function
    356           *          should be called at periodic intervals.
    357           *
    358           * @param   task_id - Task ID
    359           * @param   events  - Bitmap of events
    360           *
    361           * @return  none
    362           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    363          UINT16 ZDApp_event_loop( uint8 task_id, UINT16 events )
   \                     ZDApp_event_loop:
    364          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    365            uint8 *msg_ptr;
    366          
    367            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7032         JNZ     ??ZDApp_event_loop_0
    368            {
    369              while ( (msg_ptr = osal_msg_receive( ZDAppTaskID )) )
    370              {
    371                ZDApp_ProcessOSALMsg( (osal_event_hdr_t *)msg_ptr );
    372          
    373                // Release the memory
    374                osal_msg_deallocate( msg_ptr );
    375              }
    376          
    377              // Return unprocessed events
    378              return (events ^ SYS_EVENT_MSG);
    379            }
    380          
    381            if ( events & ZDO_NETWORK_INIT )
   \   00000D   EE           MOV     A,R6
   \   00000E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000010   5046         JNC     ??ZDApp_event_loop_1
    382            {
    383              // Initialize apps and start the network
    384              devState = DEV_INIT;
   \   000012   90....       MOV     DPTR,#devState
   \   000015   7401         MOV     A,#0x1
   \   000017   12....       LCALL   ??Subroutine48_0 & 0xFFFF
    385              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    386          
    387              ZDO_StartDevice( (uint8)ZDO_Config_Node_Descriptor.LogicalType, devStartMode,
    388                               DEFAULT_BEACON_ORDER, DEFAULT_SUPERFRAME_ORDER );
   \                     ??CrossCallReturnLabel_73:
   \   00001A                ; Setup parameters for call to function ZDO_StartDevice
   \   00001A   7C0F         MOV     R4,#0xf
   \   00001C   7B0F         MOV     R3,#0xf
   \   00001E   90....       MOV     DPTR,#devStartMode
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FA           MOV     R2,A
   \   000023   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000026   E0           MOVX    A,@DPTR
   \   000027   5407         ANL     A,#0x7
   \   000029   F9           MOV     R1,A
   \   00002A   12....       LCALL   ??ZDO_StartDevice?relay
    389          
    390              // Return unprocessed events
    391              return (events ^ ZDO_NETWORK_INIT);
   \   00002D   EE           MOV     A,R6
   \   00002E   6401         XRL     A,#0x1
   \                     ??ZDApp_event_loop_2:
   \   000030   FA           MOV     R2,A
   \   000031   EF           MOV     A,R7
   \                     ??ZDApp_event_loop_3:
   \   000032   FB           MOV     R3,A
   \   000033   8077         SJMP    ??ZDApp_event_loop_4
    392            }
   \                     ??ZDApp_event_loop_5:
   \   000035                ; Setup parameters for call to function ZDApp_ProcessOSALMsg
   \   000035   12....       LCALL   ??ZDApp_ProcessOSALMsg?relay
   \   000038                ; Setup parameters for call to function osal_msg_deallocate
   \   000038   AA..         MOV     R2,?V0 + 0
   \   00003A   AB..         MOV     R3,?V0 + 1
   \   00003C   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??ZDApp_event_loop_0:
   \   00003F                ; Setup parameters for call to function osal_msg_receive
   \   00003F   90....       MOV     DPTR,#ZDAppTaskID
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F9           MOV     R1,A
   \   000044   12....       LCALL   ??osal_msg_receive?relay
   \   000047   8A..         MOV     ?V0 + 0,R2
   \   000049   8B..         MOV     ?V0 + 1,R3
   \   00004B   A9..         MOV     R1,?V0 + 1
   \   00004D   EA           MOV     A,R2
   \   00004E   49           ORL     A,R1
   \   00004F   70E4         JNZ     ??ZDApp_event_loop_5
   \   000051   EE           MOV     A,R6
   \   000052   FA           MOV     R2,A
   \   000053   EF           MOV     A,R7
   \   000054   6480         XRL     A,#0x80
   \   000056   80DA         SJMP    ??ZDApp_event_loop_3
    393          
    394            if ( ZSTACK_ROUTER_BUILD )
    395            {
    396              if ( events & ZDO_NETWORK_START )
    397              {
    398                ZDApp_NetworkStartEvt();
    399          
    400                // Return unprocessed events
    401                return (events ^ ZDO_NETWORK_START);
    402              }
    403          
    404              if ( events & ZDO_ROUTER_START )
    405              {
    406                if ( nwkStatus == ZSuccess )
    407                {
    408                  if ( devState == DEV_END_DEVICE )
    409                  { 
    410                    devState = DEV_ROUTER;
    411                    HalLedSet(HAL_LED_1,HAL_LED_MODE_ON);
    412                  }
    413                  osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
    414                }
    415                else
    416                {
    417                  // remain as end device!!
    418                }
    419                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    420          
    421                // Return unprocessed events
    422                return (events ^ ZDO_ROUTER_START);
    423              }
    424            }
    425          
    426            if ( events & ZDO_STATE_CHANGE_EVT )
   \                     ??ZDApp_event_loop_1:
   \   000058   5410         ANL     A,#0x10
   \   00005A   6023         JZ      ??ZDApp_event_loop_6
    427            {
    428              ZDO_UpdateNwkStatus( devState );
   \   00005C                ; Setup parameters for call to function ZDO_UpdateNwkStatus
   \   00005C   90....       MOV     DPTR,#devState
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   F9           MOV     R1,A
   \   000061   12....       LCALL   ??ZDO_UpdateNwkStatus?relay
    429          
    430              // At start up, do one MTO route discovery if the device is a concentrator
    431              if ( zgConcentratorEnable == TRUE )
   \   000064   90....       MOV     DPTR,#zgConcentratorEnable
   \   000067   E0           MOVX    A,@DPTR
   \   000068   6401         XRL     A,#0x1
   \   00006A   700E         JNZ     ??CrossCallReturnLabel_91
    432              {
    433                // Start next event
    434                osal_start_timerEx( NWK_TaskID, NWK_MTO_RTG_REQ_EVT, 100 );
   \   00006C                ; Setup parameters for call to function osal_start_timerEx
   \   00006C   7C64         MOV     R4,#0x64
   \   00006E   7D00         MOV     R5,#0x0
   \   000070   7A00         MOV     R2,#0x0
   \   000072   7B08         MOV     R3,#0x8
   \   000074   90....       MOV     DPTR,#NWK_TaskID
   \   000077   12....       LCALL   ??Subroutine53_0 & 0xFFFF
    435              }
    436          
    437              // Return unprocessed events
    438              return (events ^ ZDO_STATE_CHANGE_EVT);
   \                     ??CrossCallReturnLabel_91:
   \   00007A   EE           MOV     A,R6
   \   00007B   6410         XRL     A,#0x10
   \   00007D   80B1         SJMP    ??ZDApp_event_loop_2
    439            }
    440          
    441            if ( events & ZDO_COMMAND_CNF )
   \                     ??ZDApp_event_loop_6:
   \   00007F   EE           MOV     A,R6
   \   000080   5408         ANL     A,#0x8
   \   000082   6006         JZ      ??ZDApp_event_loop_7
    442            {
    443              // User defined logic
    444          
    445              // Return unprocessed events
    446              return (events ^ ZDO_COMMAND_CNF);
   \   000084   EE           MOV     A,R6
   \   000085   6408         XRL     A,#0x8
   \   000087   FA           MOV     R2,A
   \   000088   8022         SJMP    ??ZDApp_event_loop_4
    447            }
    448          
    449            if ( events & ZDO_NWK_UPDATE_NV )
   \                     ??ZDApp_event_loop_7:
   \   00008A   EF           MOV     A,R7
   \   00008B   5402         ANL     A,#0x2
   \   00008D   600A         JZ      ??ZDApp_event_loop_8
    450            {
    451              ZDApp_SaveNetworkStateEvt();
   \   00008F                ; Setup parameters for call to function ZDApp_SaveNetworkStateEvt
   \   00008F   12....       LCALL   ??ZDApp_SaveNetworkStateEvt?relay
    452          
    453              // Return unprocessed events
    454              return (events ^ ZDO_NWK_UPDATE_NV);
   \   000092   EE           MOV     A,R6
   \   000093   FA           MOV     R2,A
   \   000094   EF           MOV     A,R7
   \   000095   6402         XRL     A,#0x2
   \   000097   8099         SJMP    ??ZDApp_event_loop_3
    455            }
    456          
    457            if ( events & ZDO_DEVICE_RESET )
   \                     ??ZDApp_event_loop_8:
   \   000099   EE           MOV     A,R6
   \   00009A   5404         ANL     A,#0x4
   \   00009C   600A         JZ      ??ZDApp_event_loop_9
    458            {
    459          #ifdef ZBA_FALLBACK_NWKKEY
    460              if ( devState == DEV_END_DEVICE_UNAUTH )
    461              {
    462                ZDSecMgrFallbackNwkKey();
    463              }
    464              else
    465          #endif
    466              {
    467                // Set the NV startup option to force a "new" join.
    468                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   00009E                ; Setup parameters for call to function zgWriteStartupOptions
   \   00009E   7A02         MOV     R2,#0x2
   \   0000A0   79FF         MOV     R1,#-0x1
   \   0000A2   12....       LCALL   ??zgWriteStartupOptions?relay
    469          
    470                // The device has been in the UNAUTH state, so reset
    471                // Note: there will be no return from this call
    472                SystemResetSoft();
   \   0000A5                ; Setup parameters for call to function Onboard_soft_reset
   \   0000A5   12....       LCALL   Onboard_soft_reset & 0xFFFF
    473              }
    474            }
    475          
    476            if ( ZG_SECURE_ENABLED )
    477            {
    478              return ( ZDApp_ProcessSecEvent( task_id, events ) );
    479            }
    480            else
    481            {
    482              // Discard or make more handlers
    483              return 0;
   \                     ??ZDApp_event_loop_9:
   \   0000A8   7A00         MOV     R2,#0x0
   \   0000AA   7B00         MOV     R3,#0x0
    484            }
   \                     ??ZDApp_event_loop_4:
   \   0000AC   80..         SJMP    ??Subroutine44_0
    485          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine44_0:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine48_0:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001                ; Setup parameters for call to function osal_set_event
   \   000001   7A10         MOV     R2,#0x10
   \   000003   7B00         MOV     R3,#0x0
   \   000005   90....       MOV     DPTR,#ZDAppTaskID
   \   000008   E0           MOVX    A,@DPTR
   \   000009   F9           MOV     R1,A
   \   00000A   12....       LCALL   ??osal_set_event?relay
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine53_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F9           MOV     R1,A
   \   000002   12....       LCALL   ??osal_start_timerEx?relay
   \   000005   22           RET
    486          
    487          /*********************************************************************
    488           * @fn      ZDApp_ProcessSecEvent()
    489           *
    490           * @brief   Process incoming security events.
    491           *
    492           * @param   task_id - Task ID
    493           * @param   events  - Bitmap of events
    494           *
    495           * @return  none
    496           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    497          UINT16 ZDApp_ProcessSecEvent( uint8 task_id, UINT16 events )
   \                     ZDApp_ProcessSecEvent:
    498          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    499            (void)task_id;  // Intentionally unreferenced parameter
    500          
    501            if ( ZSTACK_ROUTER_BUILD )
    502            {
    503              if ( events & ZDO_NEW_DEVICE )
    504              {
    505                // process the new device event
    506                if ( ZDSecMgrNewDeviceEvent() == TRUE )
    507                {
    508                  osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 1000 );
    509                }
    510          
    511                // Return unprocessed events
    512                return (events ^ ZDO_NEW_DEVICE);
    513              }
    514            }
    515          
    516            if ( (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH)
    517                || (ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD) )
    518            {
    519              if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    520              {
    521                if ( events & ZDO_SECMGR_EVENT )
    522                {
    523                  ZDSecMgrEvent();
    524          
    525                  // Return unprocessed events
    526                  return (events ^ ZDO_SECMGR_EVENT);
    527                }
    528              }
    529            }
    530          
    531            if ( events & ZDO_DEVICE_AUTH )
   \   000009   EE           MOV     A,R6
   \   00000A   5480         ANL     A,#0x80
   \   00000C   600B         JZ      ??ZDApp_ProcessSecEvent_0
    532            {
    533              ZDApp_DeviceAuthEvt();
   \   00000E                ; Setup parameters for call to function ZDApp_DeviceAuthEvt
   \   00000E   12....       LCALL   ??ZDApp_DeviceAuthEvt?relay
    534          
    535              // Return unprocessed events
    536              return (events ^ ZDO_DEVICE_AUTH);
   \   000011   EE           MOV     A,R6
   \   000012   6480         XRL     A,#0x80
   \   000014   FA           MOV     R2,A
   \   000015   EF           MOV     A,R7
   \                     ??ZDApp_ProcessSecEvent_1:
   \   000016   FB           MOV     R3,A
   \   000017   804E         SJMP    ??ZDApp_ProcessSecEvent_2
    537            }
    538          
    539            if ( events & ZDO_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_0:
   \   000019   EF           MOV     A,R7
   \   00001A   5404         ANL     A,#0x4
   \   00001C   6027         JZ      ??ZDApp_ProcessSecEvent_3
    540            {
    541              if ( nwkFrameCounterChanges++ > MAX_NWK_FRAMECOUNTER_CHANGES )
   \   00001E   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000021   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_77:
   \   000024   E8           MOV     A,R0
   \   000025   2401         ADD     A,#0x1
   \   000027   FA           MOV     R2,A
   \   000028   E9           MOV     A,R1
   \   000029   3400         ADDC    A,#0x0
   \   00002B   FB           MOV     R3,A
   \   00002C   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00002F   12....       LCALL   ??Subroutine63_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_125:
   \   000032   C3           CLR     C
   \   000033   E8           MOV     A,R0
   \   000034   94E9         SUBB    A,#-0x17
   \   000036   E9           MOV     A,R1
   \   000037   9403         SUBB    A,#0x3
   \   000039   4003         JC      ??ZDApp_ProcessSecEvent_4
    542              {
    543                ZDApp_SaveNwkKey();
   \   00003B                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   00003B   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    544              }
    545          
    546              // Return unprocessed events
    547              return (events ^ ZDO_FRAMECOUNTER_CHANGE);
   \                     ??ZDApp_ProcessSecEvent_4:
   \   00003E   EE           MOV     A,R6
   \   00003F   FA           MOV     R2,A
   \   000040   EF           MOV     A,R7
   \   000041   6404         XRL     A,#0x4
   \   000043   80D1         SJMP    ??ZDApp_ProcessSecEvent_1
    548            }
    549          
    550            if ( events & ZDO_APS_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_3:
   \   000045   EF           MOV     A,R7
   \   000046   5410         ANL     A,#0x10
   \   000048   600A         JZ      ??ZDApp_ProcessSecEvent_5
    551            {
    552          #if defined (NV_RESTORE)
    553              ZDSecMgrSaveApsLinkKey();
   \   00004A                ; Setup parameters for call to function ZDSecMgrSaveApsLinkKey
   \   00004A   12....       LCALL   ??ZDSecMgrSaveApsLinkKey?relay
    554          #endif // (NV_RESTORE)
    555          
    556              // Return unprocessed events
    557              return (events ^ ZDO_APS_FRAMECOUNTER_CHANGE);
   \   00004D   EE           MOV     A,R6
   \   00004E   FA           MOV     R2,A
   \   00004F   EF           MOV     A,R7
   \   000050   6410         XRL     A,#0x10
   \   000052   80C2         SJMP    ??ZDApp_ProcessSecEvent_1
    558            }
    559          
    560            if ( events & ZDO_TCLK_FRAMECOUNTER_CHANGE )
   \                     ??ZDApp_ProcessSecEvent_5:
   \   000054   EF           MOV     A,R7
   \   000055   5408         ANL     A,#0x8
   \   000057   600A         JZ      ??ZDApp_ProcessSecEvent_6
    561            {
    562              ZDSecMgrSaveTCLinkKey();
   \   000059                ; Setup parameters for call to function ZDSecMgrSaveTCLinkKey
   \   000059   12....       LCALL   ??ZDSecMgrSaveTCLinkKey?relay
    563          
    564              // Return unprocessed events
    565              return (events ^ ZDO_TCLK_FRAMECOUNTER_CHANGE);
   \   00005C   EE           MOV     A,R6
   \   00005D   FA           MOV     R2,A
   \   00005E   EF           MOV     A,R7
   \   00005F   6408         XRL     A,#0x8
   \   000061   80B3         SJMP    ??ZDApp_ProcessSecEvent_1
    566            }
    567          
    568            // Discard or make more handlers
    569            return 0;
   \                     ??ZDApp_ProcessSecEvent_6:
   \   000063   7A00         MOV     R2,#0x0
   \   000065   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessSecEvent_2:
   \   000067   02....       LJMP    ??Subroutine54_0 & 0xFFFF
    570          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine50_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine63_0:
   \   000000   EA           MOV     A,R2
   \   000001   F0           MOVX    @DPTR,A
   \   000002   A3           INC     DPTR
   \   000003   EB           MOV     A,R3
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET
    571          
    572          /*********************************************************************
    573           * Application Functions
    574           */
    575          
    576          /*********************************************************************
    577           * @fn      ZDOInitDevice
    578           *
    579           * @brief   Start the device in the network.  This function will read
    580           *   ZCD_NV_STARTUP_OPTION (NV item) to determine whether or not to
    581           *   restore the network state of the device.
    582           *
    583           * @param   startDelay - timeDelay to start device (in milliseconds).
    584           *                       There is a jitter added to this delay:
    585           *                       ((NWK_START_DELAY + startDelay)
    586           *                       + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK))
    587           *                       When startDelay is set to ZDO_INIT_HOLD_NWK_START
    588           *                       this function will hold the network init. Application
    589           *                       can start the device.
    590           *
    591           * NOTE:    If the application would like to force a "new" join, the
    592           *          application should set the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    593           *          bit in the ZCD_NV_STARTUP_OPTION NV item before calling
    594           *          this function. "new" join means to not restore the network
    595           *          state of the device. Use zgWriteStartupOptions() to set these
    596           *          options.
    597           *
    598           * @return
    599           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    600           *          restored.
    601           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was initialized.
    602           *          This could mean that ZCD_NV_STARTUP_OPTION said to not restore, or
    603           *          it could mean that there was no network state to restore.
    604           *    ZDO_INITDEV_LEAVE_NOT_STARTED - Before the reset, a network leave was issued
    605           *          with the rejoin option set to TRUE.  So, the device was not
    606           *          started in the network (one time only).  The next time this
    607           *          function is called it will start.
    608           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    609          uint8 ZDOInitDevice( uint16 startDelay )
   \                     ZDOInitDevice:
    610          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
    611            uint8 networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
    612            uint16 extendedDelay = 0;
   \                     ??CrossCallReturnLabel_130:
   \   00000D   7E00         MOV     R6,#0x0
   \   00000F   7F00         MOV     R7,#0x0
    613          
    614            if ( devState == DEV_HOLD )
   \   000011   90....       MOV     DPTR,#devState
   \   000014   E0           MOVX    A,@DPTR
   \   000015   7005         JNZ     ??ZDOInitDevice_0
    615            {
    616              // Initialize the RAM items table, in case an NV item has been updated.
    617              zgInitItems( FALSE );
   \   000017                ; Setup parameters for call to function zgInitItems
   \   000017   7900         MOV     R1,#0x0
   \   000019   12....       LCALL   ??zgInitItems?relay
    618            }
    619          
    620            ZDConfig_InitDescriptors();
   \                     ??ZDOInitDevice_0:
   \   00001C                ; Setup parameters for call to function ZDConfig_InitDescriptors
   \   00001C   12....       LCALL   ??ZDConfig_InitDescriptors?relay
    621            //devtag.071807.todo - fix this temporary solution
    622            _NIB.CapabilityFlags = ZDO_Config_Node_Descriptor.CapabilityFlags;
   \   00001F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000022   E0           MOVX    A,@DPTR
   \   000023   90....       MOV     DPTR,#_NIB + 14
   \   000026   F0           MOVX    @DPTR,A
    623          
    624          #if defined ( NV_RESTORE )
    625            // Get Keypad directly to see if a reset nv is needed.
    626            // Hold down the SW_BYPASS_NV key (defined in OnBoard.h)
    627            // while booting to skip past NV Restore.
    628            if ( HalKeyRead() == SW_BYPASS_NV )
   \   000027                ; Setup parameters for call to function HalKeyRead
   \   000027   12....       LCALL   ??HalKeyRead?relay
   \   00002A   E9           MOV     A,R1
   \   00002B   6404         XRL     A,#0x4
   \   00002D   7074         JNZ     ??ZDOInitDevice_1
    629              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00002F   75..01       MOV     ?V0 + 0,#0x1
    630            else
    631            {
    632              // Determine if NV should be restored
    633              networkStateNV = ZDApp_ReadNetworkRestoreState();
    634            }
    635          
    636            if ( networkStateNV == ZDO_INITDEV_RESTORED_NETWORK_STATE )
    637            {
    638              networkStateNV = ZDApp_RestoreNetworkState();
    639            }
    640            else
    641            {
    642              // Wipe out the network state in NV
    643              NLME_InitNV();
   \                     ??ZDOInitDevice_2:
   \   000032                ; Setup parameters for call to function NLME_InitNV
   \   000032   12....       LCALL   ??NLME_InitNV?relay
    644              NLME_SetDefaultNV();
   \   000035                ; Setup parameters for call to function NLME_SetDefaultNV
   \   000035   12....       LCALL   ??NLME_SetDefaultNV?relay
    645              // clear NWK key values
    646              ZDSecMgrClearNVKeyValues();
   \   000038                ; Setup parameters for call to function ZDSecMgrClearNVKeyValues
   \   000038   12....       LCALL   ??ZDSecMgrClearNVKeyValues?relay
    647            }
    648          #endif
    649          
    650            if ( networkStateNV == ZDO_INITDEV_NEW_NETWORK_STATE )
   \                     ??ZDOInitDevice_3:
   \   00003B   7401         MOV     A,#0x1
   \   00003D   65..         XRL     A,?V0 + 0
   \   00003F   7020         JNZ     ??ZDOInitDevice_4
    651            {
    652              ZDAppDetermineDeviceType();
   \   000041                ; Setup parameters for call to function ZDAppDetermineDeviceType
   \   000041   12....       LCALL   ??ZDAppDetermineDeviceType?relay
    653          
    654              // Only delay if joining network - not restoring network state
    655              extendedDelay = (uint16)((NWK_START_DELAY + startDelay)
    656                        + (osal_rand() & EXTENDED_JOINING_RANDOM_MASK));
   \   000044                ; Setup parameters for call to function osal_rand
   \   000044   12....       LCALL   ??osal_rand?relay
   \   000047   85..82       MOV     DPL,?XSP + 0
   \   00004A   85..83       MOV     DPH,?XSP + 1
   \   00004D   EA           MOV     A,R2
   \   00004E   547F         ANL     A,#0x7f
   \   000050   F8           MOV     R0,A
   \   000051   E0           MOVX    A,@DPTR
   \   000052   28           ADD     A,R0
   \   000053   F8           MOV     R0,A
   \   000054   A3           INC     DPTR
   \   000055   E0           MOVX    A,@DPTR
   \   000056   3400         ADDC    A,#0x0
   \   000058   F9           MOV     R1,A
   \   000059   E8           MOV     A,R0
   \   00005A   2464         ADD     A,#0x64
   \   00005C   FE           MOV     R6,A
   \   00005D   E9           MOV     A,R1
   \   00005E   3400         ADDC    A,#0x0
   \   000060   FF           MOV     R7,A
    657            }
    658          
    659            // Initialize the security for type of device
    660            ZDApp_SecInit( networkStateNV );
   \                     ??ZDOInitDevice_4:
   \   000061                ; Setup parameters for call to function ZDSecMgrInit
   \   000061   A9..         MOV     R1,?V0 + 0
   \   000063   12....       LCALL   ??ZDSecMgrInit?relay
    661          
    662            if( ZDO_INIT_HOLD_NWK_START != startDelay )
   \   000066   85..82       MOV     DPL,?XSP + 0
   \   000069   85..83       MOV     DPH,?XSP + 1
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   F4           CPL     A
   \   00006E   7003         JNZ     ??ZDOInitDevice_5
   \   000070   A3           INC     DPTR
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F4           CPL     A
   \                     ??ZDOInitDevice_5:
   \   000073   6045         JZ      ??ZDOInitDevice_6
    663            {
    664              devState = DEV_INIT;    // Remove the Hold state
   \   000075   90....       MOV     DPTR,#devState
   \   000078   7401         MOV     A,#0x1
   \   00007A   F0           MOVX    @DPTR,A
    665          
    666              // Initialize leave control logic
    667              ZDApp_LeaveCtrlInit();
   \   00007B                ; Setup parameters for call to function ZDApp_LeaveCtrlInit
   \   00007B   12....       LCALL   ??ZDApp_LeaveCtrlInit?relay
    668          
    669              // Check leave control reset settings
    670              ZDApp_LeaveCtrlStartup( &devState, &startDelay );
   \   00007E                ; Setup parameters for call to function ZDApp_LeaveCtrlStartup
   \   00007E   85..82       MOV     DPL,?XSP + 0
   \   000081   85..83       MOV     DPH,?XSP + 1
   \   000084   AC82         MOV     R4,DPL
   \   000086   AD83         MOV     R5,DPH
   \   000088   7A..         MOV     R2,#devState & 0xff
   \   00008A   7B..         MOV     R3,#(devState >> 8) & 0xff
   \   00008C   12....       LCALL   ??ZDApp_LeaveCtrlStartup?relay
    671          
    672              // Leave may make the hold state come back
    673              if ( devState == DEV_HOLD )
   \   00008F   90....       MOV     DPTR,#devState
   \   000092   E0           MOVX    A,@DPTR
   \   000093   701E         JNZ     ??ZDOInitDevice_7
    674              {
    675                // Set the NV startup option to force a "new" join.
    676                zgWriteStartupOptions( ZG_STARTUP_SET, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   000095                ; Setup parameters for call to function zgWriteStartupOptions
   \   000095   7A02         MOV     R2,#0x2
   \   000097   79FF         MOV     R1,#-0x1
   \   000099   12....       LCALL   ??zgWriteStartupOptions?relay
    677          
    678                // Notify the applications
    679                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00009C                ; Setup parameters for call to function osal_set_event
   \   00009C   12....       LCALL   ?Subroutine19 & 0xFFFF
    680          
    681                return ( ZDO_INITDEV_LEAVE_NOT_STARTED );   // Don't join - (one time).
   \                     ??CrossCallReturnLabel_64:
   \   00009F   7902         MOV     R1,#0x2
   \   0000A1   8021         SJMP    ??ZDOInitDevice_8
    682              }
   \                     ??ZDOInitDevice_1:
   \   0000A3                ; Setup parameters for call to function ZDApp_ReadNetworkRestoreState
   \   0000A3   12....       LCALL   ??ZDApp_ReadNetworkRestoreState?relay
   \   0000A6   E9           MOV     A,R1
   \   0000A7   F5..         MOV     ?V0 + 0,A
   \   0000A9   7087         JNZ     ??ZDOInitDevice_2
   \   0000AB                ; Setup parameters for call to function ZDApp_RestoreNetworkState
   \   0000AB   12....       LCALL   ??ZDApp_RestoreNetworkState?relay
   \   0000AE   E9           MOV     A,R1
   \   0000AF   F5..         MOV     ?V0 + 0,A
   \   0000B1   8088         SJMP    ??ZDOInitDevice_3
    683          
    684              // Trigger the network start
    685              ZDApp_NetworkInit( extendedDelay );
   \                     ??ZDOInitDevice_7:
   \   0000B3                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000B3   EE           MOV     A,R6
   \   0000B4   FA           MOV     R2,A
   \   0000B5   EF           MOV     A,R7
   \   0000B6   FB           MOV     R3,A
   \   0000B7   12....       LCALL   ??ZDApp_NetworkInit?relay
    686            }
    687          
    688            // set broadcast address mask to support broadcast filtering
    689            NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \                     ??ZDOInitDevice_6:
   \   0000BA                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   0000BA   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000BD   E0           MOVX    A,@DPTR
   \   0000BE   F9           MOV     R1,A
   \   0000BF   12....       LCALL   ??NLME_SetBroadcastFilter?relay
    690          
    691            return ( networkStateNV );
   \   0000C2   A9..         MOV     R1,?V0 + 0
   \                     ??ZDOInitDevice_8:
   \   0000C4   7402         MOV     A,#0x2
   \   0000C6   80..         SJMP    ??Subroutine46_0
    692          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   7A10         MOV     R2,#0x10
   \   000002                REQUIRE ??Subroutine45_0
   \   000002                ; // Fall through to label ??Subroutine45_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine45_0:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   90....       MOV     DPTR,#ZDAppTaskID
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   12....       LCALL   ??osal_set_event?relay
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine46_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine47_0
   \   000003                ; // Fall through to label ??Subroutine47_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine47_0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006                REQUIRE ??Subroutine63_0
   \   000006                ; // Fall through to label ??Subroutine63_0
    693          
    694          /*********************************************************************
    695           * @fn      ZDApp_ReadNetworkRestoreState
    696           *
    697           * @brief   Read the ZCD_NV_STARTUP_OPTION NV Item to state whether
    698           *          or not to restore the network state.
    699           *          If the read value has the ZCD_STARTOPT_DEFAULT_NETWORK_STATE
    700           *          bit set return the ZDO_INITDEV_NEW_NETWORK_STATE.
    701           *
    702           * @param   none
    703           *
    704           * @return  ZDO_INITDEV_NEW_NETWORK_STATE
    705           *          or ZDO_INITDEV_RESTORED_NETWORK_STATE based on whether or
    706           *          not ZCD_STARTOPT_DEFAULT_NETWORK_STATE bit is set in
    707           *          ZCD_NV_STARTUP_OPTION
    708           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    709          uint8 ZDApp_ReadNetworkRestoreState( void )
   \                     ZDApp_ReadNetworkRestoreState:
    710          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    711            uint8 networkStateNV = ZDO_INITDEV_RESTORED_NETWORK_STATE;
   \   000005   7E00         MOV     R6,#0x0
    712          
    713            // Look for the New Network State option.
    714            if ( zgReadStartupOptions() & ZCD_STARTOPT_DEFAULT_NETWORK_STATE )
   \   000007                ; Setup parameters for call to function zgReadStartupOptions
   \   000007   12....       LCALL   ??zgReadStartupOptions?relay
   \   00000A   E9           MOV     A,R1
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   5001         JNC     ??ZDApp_ReadNetworkRestoreState_0
    715            {
    716              networkStateNV = ZDO_INITDEV_NEW_NETWORK_STATE;
   \   00000F   0E           INC     R6
    717            }
    718          
    719            return ( networkStateNV );
   \                     ??ZDApp_ReadNetworkRestoreState_0:
   \   000010   EE           MOV     A,R6
   \   000011   F9           MOV     R1,A
   \   000012   02....       LJMP    ??Subroutine54_0 & 0xFFFF
    720          }
    721          
    722          /*********************************************************************
    723           * @fn      ZDAppDetermineDeviceType()
    724           *
    725           * @brief   Determines the type of device to start.
    726           *
    727           *          Looks at zgDeviceLogicalType and determines what type of
    728           *          device to start.  The types are:
    729           *            ZG_DEVICETYPE_COORDINATOR
    730           *            ZG_DEVICETYPE_ROUTER
    731           *            ZG_DEVICETYPE_ENDDEVICE
    732           *
    733           * @param   none
    734           *
    735           * @return  none
    736           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    737          void ZDAppDetermineDeviceType( void )
   \                     ZDAppDetermineDeviceType:
    738          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    739            if ( zgDeviceLogicalType == ZG_DEVICETYPE_COORDINATOR )
   \   000004   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000007   E0           MOVX    A,@DPTR
   \   000008   700E         JNZ     ??ZDAppDetermineDeviceType_0
    740            {
    741              devStartMode = MODE_HARD;     // Start as a coordinator
   \   00000A   90....       MOV     DPTR,#devStartMode
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    742              ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000010   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000013   E0           MOVX    A,@DPTR
   \   000014   54F8         ANL     A,#0xf8
   \   000016   802E         SJMP    ??ZDAppDetermineDeviceType_1
    743            }
    744            else
    745            {
    746              if ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER  )
   \                     ??ZDAppDetermineDeviceType_0:
   \   000018   6401         XRL     A,#0x1
   \   00001A   700A         JNZ     ??ZDAppDetermineDeviceType_2
    747                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_ROUTER;
   \   00001C   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   54F8         ANL     A,#0xf8
   \   000022   4401         ORL     A,#0x1
   \   000024   800D         SJMP    ??ZDAppDetermineDeviceType_3
    748              else if ( zgDeviceLogicalType == ZG_DEVICETYPE_ENDDEVICE )
   \                     ??ZDAppDetermineDeviceType_2:
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6402         XRL     A,#0x2
   \   000029   7009         JNZ     ??ZDAppDetermineDeviceType_4
    749                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   00002B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   54F8         ANL     A,#0xf8
   \   000031   4402         ORL     A,#0x2
   \                     ??ZDAppDetermineDeviceType_3:
   \   000033   F0           MOVX    @DPTR,A
    750          
    751              // If AIB_apsUseExtendedPANID is set to a non-zero value by commissioning
    752              // The device shall do rejoin the network. Otherwise, do normal join
    753              if ( nwk_ExtPANIDValid( AIB_apsUseExtendedPANID ) == false )
   \                     ??ZDAppDetermineDeviceType_4:
   \   000034                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   000034   7A..         MOV     R2,#AIB_apsUseExtendedPANID & 0xff
   \   000036   7B..         MOV     R3,#(AIB_apsUseExtendedPANID >> 8) & 0xff
   \   000038   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   00003B   E9           MOV     A,R1
   \   00003C   90....       MOV     DPTR,#devStartMode
   \   00003F   7003         JNZ     ??ZDAppDetermineDeviceType_5
    754              {
    755                devStartMode = MODE_JOIN;     // Assume joining
   \   000041   E4           CLR     A
   \   000042   8002         SJMP    ??ZDAppDetermineDeviceType_1
    756              }
    757              else
    758              {
    759                devStartMode = MODE_REJOIN;
   \                     ??ZDAppDetermineDeviceType_5:
   \   000044   7403         MOV     A,#0x3
   \                     ??ZDAppDetermineDeviceType_1:
   \   000046   F0           MOVX    @DPTR,A
    760              }
    761            }
    762          }
   \   000047   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine52_0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    763          
    764          /*********************************************************************
    765           * @fn      ZDApp_NetworkStartEvt()
    766           *
    767           * @brief   Process the Network Start Event
    768           *
    769           * @param   none
    770           *
    771           * @return  none
    772           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    773          void ZDApp_NetworkStartEvt( void )
   \                     ZDApp_NetworkStartEvt:
    774          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    775            if ( nwkStatus == ZSuccess )
   \   000004   90....       MOV     DPTR,#nwkStatus
   \   000007   E0           MOVX    A,@DPTR
   \   000008   7014         JNZ     ??ZDApp_NetworkStartEvt_0
    776            {
    777              // Successfully started a ZigBee network
    778              if ( devState == DEV_COORD_STARTING )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6408         XRL     A,#0x8
   \   000010   7005         JNZ     ??CrossCallReturnLabel_8
    779              {
    780                devState = DEV_ZB_COORD;
   \   000012   7409         MOV     A,#0x9
   \   000014   12....       LCALL   ?Subroutine14 & 0xFFFF
    781                HalLedSet(HAL_LED_1,HAL_LED_MODE_ON);
    782              }
    783          
    784              osal_pwrmgr_device( PWRMGR_ALWAYS_ON );
   \                     ??CrossCallReturnLabel_8:
   \   000017                ; Setup parameters for call to function osal_pwrmgr_device
   \   000017   7900         MOV     R1,#0x0
   \   000019   12....       LCALL   ??osal_pwrmgr_device?relay
    785              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00001C                ; Setup parameters for call to function osal_set_event
   \   00001C   802B         SJMP    ??ZDApp_NetworkStartEvt_1
    786            }
    787            else
    788            {
    789              // Try again with a higher energy threshold !!
    790              if ( ( NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT ) < 0xff )
   \                     ??ZDApp_NetworkStartEvt_0:
   \   00001E                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   00001E   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000021   E9           MOV     A,R1
   \   000022   2410         ADD     A,#0x10
   \   000024   F8           MOV     R0,A
   \   000025   E4           CLR     A
   \   000026   3400         ADDC    A,#0x0
   \   000028   F9           MOV     R1,A
   \   000029   E8           MOV     A,R0
   \   00002A   94FF         SUBB    A,#-0x1
   \   00002C   E9           MOV     A,R1
   \   00002D   9400         SUBB    A,#0x0
   \   00002F   C3           CLR     C
   \   000030   65D0         XRL     A,PSW
   \   000032   33           RLC     A
   \   000033   500E         JNC     ??ZDApp_NetworkStartEvt_2
    791              {
    792                NLME_SetEnergyThreshold( (uint8)(NLME_GetEnergyThreshold() + ENERGY_SCAN_INCREMENT) );
   \   000035                ; Setup parameters for call to function NLME_SetEnergyThreshold
   \   000035                ; Setup parameters for call to function NLME_GetEnergyThreshold
   \   000035   12....       LCALL   ??NLME_GetEnergyThreshold?relay
   \   000038   E9           MOV     A,R1
   \   000039   2410         ADD     A,#0x10
   \   00003B   F9           MOV     R1,A
   \   00003C   12....       LCALL   ??NLME_SetEnergyThreshold?relay
    793                osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \   00003F                ; Setup parameters for call to function osal_set_event
   \   00003F   7A01         MOV     R2,#0x1
   \   000041   8008         SJMP    ??ZDApp_NetworkStartEvt_3
    794              }
    795              else
    796              {
    797                // Failed to start network. Enter a dormant state (until user intervenes)
    798                devState = DEV_INIT;
   \                     ??ZDApp_NetworkStartEvt_2:
   \   000043   90....       MOV     DPTR,#devState
   \   000046   7401         MOV     A,#0x1
   \   000048   F0           MOVX    @DPTR,A
    799                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000049                ; Setup parameters for call to function osal_set_event
   \                     ??ZDApp_NetworkStartEvt_1:
   \   000049   7A10         MOV     R2,#0x10
    800              }
    801            }
   \                     ??ZDApp_NetworkStartEvt_3:
   \   00004B   12....       LCALL   ??Subroutine45_0 & 0xFFFF
    802          }
   \                     ??CrossCallReturnLabel_68:
   \   00004E   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function HalLedSet
   \   000001                ; Setup parameters for call to function HalLedSet
   \   000001   7A01         MOV     R2,#0x1
   \   000003   7901         MOV     R1,#0x1
   \   000005   12....       LCALL   ??HalLedSet?relay
   \   000008   22           RET
    803          
    804          /*********************************************************************
    805           * @fn      ZDApp_DeviceAuthEvt()
    806           *
    807           * @brief   Process the Device Authentic Event
    808           *
    809           * @param   none
    810           *
    811           * @return  none
    812           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    813          void ZDApp_DeviceAuthEvt( void )
   \                     ZDApp_DeviceAuthEvt:
    814          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    815            // received authentication from trust center
    816            if ( devState == DEV_END_DEVICE_UNAUTH )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6405         XRL     A,#0x5
   \   00000A   7022         JNZ     ??ZDApp_DeviceAuthEvt_0
    817            {
    818              // Stop the reset timer so it doesn't reset
    819              ZDApp_ResetTimerCancel();
   \   00000C                ; Setup parameters for call to function ZDApp_ResetTimerCancel
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerCancel?relay
    820          
    821              devState = DEV_END_DEVICE;
   \   00000F   12....       LCALL   ?Subroutine8 & 0xFFFF
    822              osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
    823          
    824              // Set the Power Manager Device
    825          #if defined ( POWER_SAVING )
    826              osal_pwrmgr_device( PWRMGR_BATTERY );
    827          #endif
    828          
    829              if ( ZSTACK_ROUTER_BUILD )
    830              {
    831                if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
    832                {
    833                  // NOTE: first two parameters are not used, see NLMEDE.h for details
    834                  NLME_StartRouterRequest( 0, 0, false );
    835                }
    836              }
    837          
    838              // Notify to save info into NV
    839              ZDApp_NVUpdate();
   \                     ??CrossCallReturnLabel_71:
   \   000012                ; Setup parameters for call to function ZDApp_NVUpdate
   \   000012   12....       LCALL   ??ZDApp_NVUpdate?relay
    840          
    841              // Save off the security
    842              ZDApp_SaveNwkKey();
   \   000015                ; Setup parameters for call to function ZDApp_SaveNwkKey
   \   000015   12....       LCALL   ??ZDApp_SaveNwkKey?relay
    843          
    844              ZDApp_AnnounceNewAddress();
   \   000018                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000018   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
    845          
    846              if ( (ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE) == 0 )
   \   00001B   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   A2E3         MOV     C,0xE0 /* A   */.3
   \   000021   400E         JC      ??ZDApp_DeviceAuthEvt_1
    847              {
    848                NLME_SetPollRate( ZDApp_SavedPollRate );
   \   000023                ; Setup parameters for call to function NLME_SetPollRate
   \   000023   90....       MOV     DPTR,#ZDApp_SavedPollRate
   \   000026   12....       LCALL   ?Subroutine25 & 0xFFFF
    849              }
    850            }
   \                     ??CrossCallReturnLabel_30:
   \   000029   12....       LCALL   ??NLME_SetPollRate?relay
   \   00002C   8003         SJMP    ??ZDApp_DeviceAuthEvt_1
    851            else
    852            {
    853              ZDApp_NVUpdate();
   \                     ??ZDApp_DeviceAuthEvt_0:
   \   00002E                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00002E   12....       LCALL   ??ZDApp_NVUpdate?relay
    854            }
    855          }
   \                     ??ZDApp_DeviceAuthEvt_1:
   \   000031   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   90....       MOV     DPTR,#devState
   \   000003   7406         MOV     A,#0x6
   \   000005                REQUIRE ??Subroutine48_0
   \   000005                ; // Fall through to label ??Subroutine48_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FA           MOV     R2,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FB           MOV     R3,A
   \   000005   22           RET
    856          
    857          /*********************************************************************
    858           * @fn      ZDApp_SaveNetworkStateEvt()
    859           *
    860           * @brief   Process the Save the Network State Event
    861           *
    862           * @param   none
    863           *
    864           * @return  none
    865           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    866          void ZDApp_SaveNetworkStateEvt( void )
   \                     ZDApp_SaveNetworkStateEvt:
    867          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    868          #if defined ( NV_RESTORE )
    869           #if defined ( NV_TURN_OFF_RADIO )
    870            // Turn off the radio's receiver during an NV update
    871            uint8 RxOnIdle;
    872            uint8 x = false;
    873            ZMacGetReq( ZMacRxOnIdle, &RxOnIdle );
    874            ZMacSetReq( ZMacRxOnIdle, &x );
    875           #endif
    876          
    877            // Update the Network State in NV
    878            NLME_UpdateNV( NWK_NV_NIB_ENABLE        |
    879                           NWK_NV_DEVICELIST_ENABLE |
    880                           NWK_NV_BINDING_ENABLE    |
    881                           NWK_NV_ADDRMGR_ENABLE );
   \   000004                ; Setup parameters for call to function NLME_UpdateNV
   \   000004   790F         MOV     R1,#0xf
   \   000006   12....       LCALL   ??NLME_UpdateNV?relay
    882          
    883            // Reset the NV startup option to resume from NV by
    884            // clearing the "New" join option.
    885            zgWriteStartupOptions( FALSE, ZCD_STARTOPT_DEFAULT_NETWORK_STATE );
   \   000009                ; Setup parameters for call to function zgWriteStartupOptions
   \   000009   7A02         MOV     R2,#0x2
   \   00000B   7900         MOV     R1,#0x0
   \   00000D   12....       LCALL   ??zgWriteStartupOptions?relay
    886          
    887           #if defined ( NV_TURN_OFF_RADIO )
    888            ZMacSetReq( ZMacRxOnIdle, &RxOnIdle );
    889           #endif
    890          #endif  // NV_RESTORE
    891          }
   \   000010   02....       LJMP    ??Subroutine52_0 & 0xFFFF
    892          
    893          /*********************************************************************
    894           * @fn      ZDApp_RestoreNetworkState()
    895           *
    896           * @brief   This function will restore the network state of the
    897           *          device if the network state is stored in NV.
    898           *
    899           * @param   none
    900           *
    901           * @return
    902           *    ZDO_INITDEV_RESTORED_NETWORK_STATE  - The device's network state was
    903           *          restored.
    904           *    ZDO_INITDEV_NEW_NETWORK_STATE - The network state was not used.
    905           *          This could mean that zgStartupOption said to not restore, or
    906           *          it could mean that there was no network state to restore.
    907           *
    908           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    909          uint8 ZDApp_RestoreNetworkState( void )
   \                     ZDApp_RestoreNetworkState:
    910          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    911            uint8 nvStat;
    912          
    913            // Initialize NWK NV items
    914            nvStat = NLME_InitNV();
   \   000005                ; Setup parameters for call to function NLME_InitNV
   \   000005   12....       LCALL   ??NLME_InitNV?relay
   \   000008   E9           MOV     A,R1
   \   000009   FE           MOV     R6,A
    915          
    916            if ( nvStat != NV_OPER_FAILED )
   \   00000A   740A         MOV     A,#0xa
   \   00000C   6E           XRL     A,R6
   \   00000D   602D         JZ      ??ZDApp_RestoreNetworkState_0
    917            {
    918              if ( NLME_RestoreFromNV() )
   \   00000F                ; Setup parameters for call to function NLME_RestoreFromNV
   \   00000F   12....       LCALL   ??NLME_RestoreFromNV?relay
   \   000012   E9           MOV     A,R1
   \   000013   6027         JZ      ??ZDApp_RestoreNetworkState_0
    919              {
    920                // Are we a coordinator
    921                ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001B   12....       LCALL   ??Subroutine63_0 & 0xFFFF
    922                if ( ZDAppNwkAddr.addr.shortAddr == 0 )
   \                     ??CrossCallReturnLabel_126:
   \   00001E   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000024   7007         JNZ     ??ZDApp_RestoreNetworkState_1
    923                  ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_COORDINATOR;
   \   000026   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   54F8         ANL     A,#0xf8
   \   00002C   F0           MOVX    @DPTR,A
    924                devStartMode = MODE_RESUME;
   \                     ??ZDApp_RestoreNetworkState_1:
   \   00002D   90....       MOV     DPTR,#devStartMode
   \   000030   7401         MOV     A,#0x1
   \   000032   12....       LCALL   ?Subroutine10 & 0xFFFF
    925                osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
    926              }
    927              else
    928                nvStat = NV_ITEM_UNINIT;
    929          
    930              if ( ZG_SECURE_ENABLED )
    931              {
    932                nwkFrameCounterChanges = 0;
    933          
    934                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
    935                {
    936                  ZDApp_RestoreNwkKey();
    937                }
    938              }
    939          
    940              // The default for RxOnWhenIdle is true for Routers and false for end devices
    941              // [setup in the NLME_RestoreFromNV()].  Change it here if you want something
    942              // other than default.
    943            }
    944          
    945            if ( nvStat == ZSUCCESS )
   \                     ??CrossCallReturnLabel_2:
   \   000035   EE           MOV     A,R6
   \   000036   7004         JNZ     ??ZDApp_RestoreNetworkState_0
    946              return ( ZDO_INITDEV_RESTORED_NETWORK_STATE );
   \   000038   7900         MOV     R1,#0x0
   \   00003A   8002         SJMP    ??ZDApp_RestoreNetworkState_2
    947            else
    948              return ( ZDO_INITDEV_NEW_NETWORK_STATE );
   \                     ??ZDApp_RestoreNetworkState_0:
   \   00003C   7901         MOV     R1,#0x1
   \                     ??ZDApp_RestoreNetworkState_2:
   \   00003E   02....       LJMP    ??Subroutine54_0 & 0xFFFF
    949          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001                ; Setup parameters for call to function sAddrExtCpy
   \   000001   7C..         MOV     R4,#(_NIB + 53) & 0xff
   \   000003   7D..         MOV     R5,#((_NIB + 53) >> 8) & 0xff
   \   000005   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000007   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000009   12....       LCALL   ??sAddrExtCpy?relay
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   E8           MOV     A,R0
   \   000006   49           ORL     A,R1
   \   000007   22           RET
    950          
    951          /*********************************************************************
    952           * @fn      ZDApp_InitUserDesc()
    953           *
    954           * @brief   Initialize the User Descriptor, the descriptor is read from NV
    955           *          when needed.  If you want to initialize the User descriptor to
    956           *          something other than all zero, do it here.
    957           *
    958           * @param   none
    959           *
    960           * @return  none
    961           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine43_0:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003                REQUIRE ??Subroutine44_0
   \   000003                ; // Fall through to label ??Subroutine44_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    962          void ZDApp_InitUserDesc( void )
   \                     ZDApp_InitUserDesc:
    963          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    964            UserDescriptorFormat_t ZDO_DefaultUserDescriptor;
    965          
    966            // Initialize the User Descriptor, the descriptor is read from NV
    967            // when needed.  If you want to initialize the User descriptor to something
    968            // other than all zero, do it here.
    969            osal_memset( &ZDO_DefaultUserDescriptor, 0, sizeof( UserDescriptorFormat_t ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C11         MOV     R4,#0x11
   \   00000C   12....       LCALL   ?Subroutine35 & 0xFFFF
    970            if ( ZSUCCESS == osal_nv_item_init( ZCD_NV_USERDESC,
    971                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \                     ??CrossCallReturnLabel_49:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   7C11         MOV     R4,#0x11
   \   000014   7D00         MOV     R5,#0x0
   \   000016   7A81         MOV     R2,#-0x7f
   \   000018   7B00         MOV     R3,#0x0
   \   00001A   12....       LCALL   ??osal_nv_item_init?relay
   \   00001D   7402         MOV     A,#0x2
   \   00001F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000022   E9           MOV     A,R1
   \   000023   702F         JNZ     ??ZDApp_InitUserDesc_0
    972            {
    973              if ( ZSUCCESS == osal_nv_read( ZCD_NV_USERDESC, 0,
    974                   sizeof(UserDescriptorFormat_t), (void*)&ZDO_DefaultUserDescriptor ) )
   \   000025                ; Setup parameters for call to function osal_nv_read
   \   000025   78..         MOV     R0,#?V0 + 0
   \   000027   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002A   75..11       MOV     ?V0 + 0,#0x11
   \   00002D   75..00       MOV     ?V0 + 1,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000035   7C00         MOV     R4,#0x0
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7A81         MOV     R2,#-0x7f
   \   00003B   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_51:
   \   00003E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000041   E9           MOV     A,R1
   \   000042   7010         JNZ     ??ZDApp_InitUserDesc_0
    975              {
    976                if ( ZDO_DefaultUserDescriptor.len != 0 )
   \   000044   85..82       MOV     DPL,?XSP + 0
   \   000047   85..83       MOV     DPH,?XSP + 1
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   6007         JZ      ??ZDApp_InitUserDesc_0
    977                {
    978                  ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   \   00004D   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000050   E0           MOVX    A,@DPTR
   \   000051   D2E4         SETB    0xE0 /* A   */.4
   \   000053   F0           MOVX    @DPTR,A
    979                }
    980              }
    981            }
    982          }
   \                     ??ZDApp_InitUserDesc_0:
   \   000054   7411         MOV     A,#0x11
   \   000056   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   7D00         MOV     R5,#0x0
   \   000002   7900         MOV     R1,#0x0
   \   000004   85..82       MOV     DPL,?XSP + 0
   \   000007   85..83       MOV     DPH,?XSP + 1
   \   00000A   AA82         MOV     R2,DPL
   \   00000C   AB83         MOV     R3,DPH
   \   00000E   12....       LCALL   ??osal_memset?relay
   \   000011                ; Setup parameters for call to function osal_nv_item_init
   \   000011                ; Setup parameters for call to function osal_nv_write
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 0,DPL
   \   00001A   8583..       MOV     ?V0 + 1,DPH
   \   00001D   78..         MOV     R0,#?V0 + 0
   \   00001F   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   7B00         MOV     R3,#0x0
   \   000002   12....       LCALL   ??osal_nv_read?relay
   \   000005   7404         MOV     A,#0x4
   \   000007   22           RET
    983          
    984          /*********************************************************************
    985           * @fn      ZDAppCheckForHoldKey()
    986           *
    987           * @brief   Check for key to set the device into Hold Auto Start
    988           *
    989           * @param   none
    990           *
    991           * @return  none
    992           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    993          void ZDAppCheckForHoldKey( void )
   \                     ZDAppCheckForHoldKey:
    994          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    995          #if (defined HAL_KEY) && (HAL_KEY == TRUE)
    996            // Get Keypad directly to see if a HOLD_START is needed.
    997            // Hold down the SW_BYPASS_START key (see OnBoard.h)
    998            // while booting to avoid starting up the device.
    999            if ( HalKeyRead () == SW_BYPASS_START)
   \   000004                ; Setup parameters for call to function HalKeyRead
   \   000004   12....       LCALL   ??HalKeyRead?relay
   \   000007   E9           MOV     A,R1
   \   000008   6401         XRL     A,#0x1
   \   00000A   7005         JNZ     ??ZDAppCheckForHoldKey_0
   1000            {
   1001              // Change the device state to HOLD on start up
   1002              devState = DEV_HOLD;
   \   00000C   90....       MOV     DPTR,#devState
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
   1003            }
   1004          #endif // HAL_KEY
   1005          }
   \                     ??ZDAppCheckForHoldKey_0:
   \   000011   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   1006          
   1007          /*********************************************************************
   1008           * @fn      ZDApp_ProcessOSALMsg()
   1009           *
   1010           * @brief   Process the incoming task message.
   1011           *
   1012           * @param   msgPtr - message to process
   1013           *
   1014           * @return  none
   1015           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1016          void ZDApp_ProcessOSALMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessOSALMsg:
   1017          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1018            // Data Confirmation message fields
   1019            uint8 sentEP;       // This should always be 0
   1020            uint8 sentStatus;
   1021            afDataConfirm_t *afDataConfirm;
   1022            uint8 tmp;
   1023          
   1024            switch ( msgPtr->event )
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   14           DEC     A
   \   000010   6023         JZ      ??ZDApp_ProcessOSALMsg_0
   \   000012   14           DEC     A
   \   000013   7003         JNZ     $+5
   \   000015   02....       LJMP    ??ZDApp_ProcessOSALMsg_1 & 0xFFFF
   \   000018   14           DEC     A
   \   000019   7003         JNZ     $+5
   \   00001B   02....       LJMP    ??ZDApp_ProcessOSALMsg_2 & 0xFFFF
   \   00001E   24E9         ADD     A,#-0x17
   \   000020   6007         JZ      ??ZDApp_ProcessOSALMsg_3
   \   000022   2447         ADD     A,#0x47
   \   000024   6009         JZ      ??ZDApp_ProcessOSALMsg_4
   \   000026   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1025            {
   1026              // Incoming ZDO Message
   1027              case AF_INCOMING_MSG_CMD:
   1028                ZDP_IncomingData( (afIncomingMSGPacket_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_3:
   \   000029                ; Setup parameters for call to function ZDP_IncomingData
   \   000029   12....       LCALL   ??ZDP_IncomingData?relay
   1029                break;
   \   00002C   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1030          
   1031              case ZDO_CB_MSG:
   1032                ZDApp_ProcessMsgCBs( (zdoIncomingMsg_t *)msgPtr );
   \                     ??ZDApp_ProcessOSALMsg_4:
   \   00002F                ; Setup parameters for call to function ZDApp_ProcessMsgCBs
   \   00002F   12....       LCALL   ??ZDApp_ProcessMsgCBs?relay
   1033                break;
   \   000032   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1034          
   1035              case AF_DATA_CONFIRM_CMD:
   1036                // This message is received as a confirmation of a data packet sent.
   1037                // The status is of ZStatus_t type [defined in NLMEDE.h]
   1038                // The message fields are defined in AF.h
   1039                afDataConfirm = (afDataConfirm_t *)msgPtr;
   1040                sentEP = afDataConfirm->endpoint;
   1041                sentStatus = afDataConfirm->hdr.status;
   1042          
   1043                // Action taken when confirmation is received.
   1044          #if defined ( ZIGBEE_FREQ_AGILITY )
   1045                if ( pZDNwkMgr_ProcessDataConfirm )
   1046                  pZDNwkMgr_ProcessDataConfirm( afDataConfirm );
   1047          #endif
   1048                (void)sentEP;
   1049                (void)sentStatus;
   1050                break;
   1051          
   1052              case ZDO_NWK_DISC_CNF:
   1053                if (devState != DEV_NWK_DISC)
   \                     ??ZDApp_ProcessOSALMsg_0:
   \   000035   90....       MOV     DPTR,#devState
   \   000038   E0           MOVX    A,@DPTR
   \   000039   6402         XRL     A,#0x2
   \   00003B   6003         JZ      $+5
   \   00003D   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1054                  break;
   1055          
   1056                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \   000040   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000043   E0           MOVX    A,@DPTR
   \   000044   6401         XRL     A,#0x1
   \   000046   6008         JZ      ??ZDApp_ProcessOSALMsg_6
   \   000048   E0           MOVX    A,@DPTR
   \   000049   6402         XRL     A,#0x2
   \   00004B   6003         JZ      $+5
   \   00004D   02....       LJMP    ??ZDApp_ProcessOSALMsg_5 & 0xFFFF
   1057                {
   1058                  // Process the network discovery scan results and choose a parent
   1059                  // device to join/rejoin itself
   1060                  networkDesc_t *pChosenNwk;
   1061                  if ( ( (pChosenNwk = ZDApp_NwkDescListProcessing()) != NULL ) && (zdoDiscCounter > NUM_DISC_ATTEMPTS) )
   \                     ??ZDApp_ProcessOSALMsg_6:
   \   000050                ; Setup parameters for call to function ZDApp_NwkDescListProcessing
   \   000050   12....       LCALL   ??ZDApp_NwkDescListProcessing?relay
   \   000053   8A..         MOV     ?V0 + 0,R2
   \   000055   8B..         MOV     ?V0 + 1,R3
   \   000057   A8..         MOV     R0,?V0 + 0
   \   000059   A9..         MOV     R1,?V0 + 1
   \   00005B   E8           MOV     A,R0
   \   00005C   FE           MOV     R6,A
   \   00005D   E9           MOV     A,R1
   \   00005E   FF           MOV     R7,A
   \   00005F   E8           MOV     A,R0
   \   000060   49           ORL     A,R1
   \   000061   7003         JNZ     $+5
   \   000063   02....       LJMP    ??ZDApp_ProcessOSALMsg_7 & 0xFFFF
   \   000066   90....       MOV     DPTR,#zdoDiscCounter
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   C3           CLR     C
   \   00006B   9403         SUBB    A,#0x3
   \   00006D   5003         JNC     $+5
   \   00006F   02....       LJMP    ??ZDApp_ProcessOSALMsg_7 & 0xFFFF
   1062                  {
   1063                    if ( devStartMode == MODE_JOIN )
   \   000072   90....       MOV     DPTR,#devStartMode
   \   000075   E0           MOVX    A,@DPTR
   \   000076   7059         JNZ     ??ZDApp_ProcessOSALMsg_8
   1064                    {
   1065                      devState = DEV_NWK_JOINING;
   \   000078   90....       MOV     DPTR,#devState
   \   00007B   7403         MOV     A,#0x3
   \   00007D   12....       LCALL   ?Subroutine11 & 0xFFFF
   1066          
   1067                      ZDApp_NodeProfileSync( pChosenNwk->stackProfile);
   \                     ??CrossCallReturnLabel_4:
   \   000080   E0           MOVX    A,@DPTR
   \   000081   F9           MOV     R1,A
   \   000082   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1068          
   1069                      if ( NLME_JoinRequest( pChosenNwk->extendedPANID, pChosenNwk->panId,
   1070                                            pChosenNwk->logicalChannel,
   1071                                            ZDO_Config_Node_Descriptor.CapabilityFlags,
   1072                                            pChosenNwk->chosenRouter, pChosenNwk->chosenRouterDepth ) != ZSuccess )
   \   000085                ; Setup parameters for call to function NLME_JoinRequest
   \   000085   8E82         MOV     DPL,R6
   \   000087   8F83         MOV     DPH,R7
   \   000089   A3           INC     DPTR
   \   00008A   A3           INC     DPTR
   \   00008B   A3           INC     DPTR
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   A3           INC     DPTR
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   E0           MOVX    A,@DPTR
   \   000094   F5..         MOV     ?V0 + 0,A
   \   000096   78..         MOV     R0,#?V0 + 0
   \   000098   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00009B   8E82         MOV     DPL,R6
   \   00009D   8F83         MOV     DPH,R7
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   A3           INC     DPTR
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000A9   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   F5..         MOV     ?V0 + 0,A
   \   0000AF   78..         MOV     R0,#?V0 + 0
   \   0000B1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B4   8E82         MOV     DPL,R6
   \   0000B6   8F83         MOV     DPH,R7
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   E0           MOVX    A,@DPTR
   \   0000BB   F9           MOV     R1,A
   \   0000BC   8E82         MOV     DPL,R6
   \   0000BE   8F83         MOV     DPH,R7
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   FC           MOV     R4,A
   \   0000C2   A3           INC     DPTR
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   12....       LCALL   ?Subroutine36 & 0xFFFF
   1073                      {
   1074                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1075                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   1076                      }
   1077                    } // if ( devStartMode == MODE_JOIN )
   \                     ??CrossCallReturnLabel_75:
   \   0000C7   12....       LCALL   ??NLME_JoinRequest?relay
   \   0000CA   7404         MOV     A,#0x4
   \   0000CC   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000CF   806B         SJMP    ??ZDApp_ProcessOSALMsg_9
   1078                    else if ( devStartMode == MODE_REJOIN )
   \                     ??ZDApp_ProcessOSALMsg_8:
   \   0000D1   6403         XRL     A,#0x3
   \   0000D3   706D         JNZ     ??CrossCallReturnLabel_39
   1079                    {
   1080                      devState = DEV_NWK_REJOIN;
   \   0000D5   90....       MOV     DPTR,#devState
   \   0000D8   7404         MOV     A,#0x4
   \   0000DA   F0           MOVX    @DPTR,A
   1081          
   1082                      // Before trying to do rejoin, check if the device has a valid short address
   1083                      // If not, generate a random short address for itself
   1084                      if ( _NIB.nwkDevAddress == INVALID_NODE_ADDR )
   \   0000DB   90....       MOV     DPTR,#_NIB + 20
   \   0000DE   E0           MOVX    A,@DPTR
   \   0000DF   64FE         XRL     A,#0xfe
   \   0000E1   7003         JNZ     ??ZDApp_ProcessOSALMsg_10
   \   0000E3   A3           INC     DPTR
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_10:
   \   0000E6   7012         JNZ     ??ZDApp_ProcessOSALMsg_11
   1085                      {
   1086                        _NIB.nwkDevAddress = osal_rand();
   \   0000E8                ; Setup parameters for call to function osal_rand
   \   0000E8   12....       LCALL   ??osal_rand?relay
   \   0000EB   90....       MOV     DPTR,#_NIB + 20
   \   0000EE   12....       LCALL   ??Subroutine63_0 & 0xFFFF
   1087                        ZMacSetReq( ZMacShortAddress, (byte*)&_NIB.nwkDevAddress );
   \                     ??CrossCallReturnLabel_127:
   \   0000F1                ; Setup parameters for call to function ZMacSetReq
   \   0000F1   7A..         MOV     R2,#(_NIB + 20) & 0xff
   \   0000F3   7B..         MOV     R3,#((_NIB + 20) >> 8) & 0xff
   \   0000F5   7953         MOV     R1,#0x53
   \   0000F7   12....       LCALL   ??ZMacSetReq?relay
   1088                      }
   1089          
   1090                      if ( ZG_SECURE_ENABLED )
   1091                      {
   1092                        ZDApp_RestoreNwkKey();
   1093                      }
   1094          
   1095                      // Check if the device has a valid PanID, if not, set it to the discovered Pan
   1096                      if ( _NIB.nwkPanId == INVALID_PAN_ID )
   \                     ??ZDApp_ProcessOSALMsg_11:
   \   0000FA   90....       MOV     DPTR,#_NIB + 33
   \   0000FD   E0           MOVX    A,@DPTR
   \   0000FE   64FE         XRL     A,#0xfe
   \   000100   7003         JNZ     ??ZDApp_ProcessOSALMsg_12
   \   000102   A3           INC     DPTR
   \   000103   E0           MOVX    A,@DPTR
   \   000104   F4           CPL     A
   \                     ??ZDApp_ProcessOSALMsg_12:
   \   000105   7014         JNZ     ??ZDApp_ProcessOSALMsg_13
   1097                      {
   1098                        _NIB.nwkPanId = pChosenNwk->panId;
   \   000107   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_81:
   \   00010A   90....       MOV     DPTR,#_NIB + 33
   \   00010D   E8           MOV     A,R0
   \   00010E   F0           MOVX    @DPTR,A
   \   00010F   A3           INC     DPTR
   \   000110   E9           MOV     A,R1
   \   000111   F0           MOVX    @DPTR,A
   1099                        ZMacSetReq( ZMacPanId, (byte*)&(_NIB.nwkPanId) );
   \   000112                ; Setup parameters for call to function ZMacSetReq
   \   000112   7A..         MOV     R2,#(_NIB + 33) & 0xff
   \   000114   7B..         MOV     R3,#((_NIB + 33) >> 8) & 0xff
   \   000116   7950         MOV     R1,#0x50
   \   000118   12....       LCALL   ??ZMacSetReq?relay
   1100                      }
   1101          
   1102                      tmp = true;
   \                     ??ZDApp_ProcessOSALMsg_13:
   \   00011B   85..82       MOV     DPL,?XSP + 0
   \   00011E   85..83       MOV     DPH,?XSP + 1
   \   000121   7401         MOV     A,#0x1
   \   000123   F0           MOVX    @DPTR,A
   1103                      ZMacSetReq( ZMacRxOnIdle, &tmp ); // Set receiver always on during rejoin
   \   000124                ; Setup parameters for call to function ZMacSetReq
   \   000124   AA82         MOV     R2,DPL
   \   000126   AB83         MOV     R3,DPH
   \   000128   7952         MOV     R1,#0x52
   \   00012A   12....       LCALL   ??ZMacSetReq?relay
   1104                      if ( NLME_ReJoinRequest( ZDO_UseExtendedPANID, pChosenNwk->logicalChannel) != ZSuccess )
   \   00012D                ; Setup parameters for call to function NLME_ReJoinRequest
   \   00012D   8E82         MOV     DPL,R6
   \   00012F   8F83         MOV     DPH,R7
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   E0           MOVX    A,@DPTR
   \   000134   F9           MOV     R1,A
   \   000135   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000137   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000139   12....       LCALL   ??NLME_ReJoinRequest?relay
   \                     ??ZDApp_ProcessOSALMsg_9:
   \   00013C   E9           MOV     A,R1
   \   00013D   6003         JZ      ??CrossCallReturnLabel_39
   1105                      {
   1106                        ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1107                                                    + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   00013F                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00013F                ; Setup parameters for call to function osal_rand
   \   00013F   12....       LCALL   ?Subroutine29 & 0xFFFF
   1108                      }
   1109                    } // else if ( devStartMode == MODE_REJOIN )
   1110          
   1111                    if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_39:
   \   000142   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000145   E0           MOVX    A,@DPTR
   \   000146   A2E3         MOV     C,0xE0 /* A   */.3
   \   000148   505A         JNC     ??ZDApp_ProcessOSALMsg_5
   1112                    {
   1113                      // The receiver is on, turn network layer polling off.
   1114                      NLME_SetPollRate( 0 );
   \   00014A                ; Setup parameters for call to function NLME_SetPollRate
   \   00014A   12....       LCALL   ?Subroutine34 & 0xFFFF
   1115                      NLME_SetQueuedPollRate( 0 );
   1116                      NLME_SetResponseRate( 0 );
   1117                    }
   1118                    else
   1119                    {
   1120                      if ( (ZG_SECURE_ENABLED) && (devStartMode == MODE_JOIN) )
   1121                      {
   1122                        ZDApp_SavedPollRate = zgPollRate;
   1123                        NLME_SetPollRate( zgRejoinPollRate );
   1124                      }
   1125                    }
   1126                  }
   \                     ??CrossCallReturnLabel_47:
   \   00014D   8055         SJMP    ??ZDApp_ProcessOSALMsg_5
   1127                  else
   1128                  {
   1129                    if ( continueJoining )
   \                     ??ZDApp_ProcessOSALMsg_7:
   \   00014F   90....       MOV     DPTR,#continueJoining
   \   000152   E0           MOVX    A,@DPTR
   \   000153   604F         JZ      ??ZDApp_ProcessOSALMsg_5
   1130                    {
   1131              #if defined ( MANAGED_SCAN )
   1132                      ZDApp_NetworkInit( MANAGEDSCAN_DELAY_BETWEEN_SCANS );
   1133              #else
   1134                      zdoDiscCounter++;
   \   000155   90....       MOV     DPTR,#zdoDiscCounter
   \   000158   E0           MOVX    A,@DPTR
   \   000159   04           INC     A
   \   00015A   F0           MOVX    @DPTR,A
   1135                      ZDApp_NetworkInit( (uint16)(BEACON_REQUEST_DELAY
   1136                            + ((uint16)(osal_rand()& BEACON_REQ_DELAY_MASK))) );
   \   00015B                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00015B                ; Setup parameters for call to function osal_rand
   \   00015B   12....       LCALL   ??osal_rand?relay
   \   00015E   EA           MOV     A,R2
   \   00015F   2464         ADD     A,#0x64
   \   000161   FA           MOV     R2,A
   \   000162   E4           CLR     A
   \   000163   3400         ADDC    A,#0x0
   \   000165   FB           MOV     R3,A
   \   000166   8039         SJMP    ??ZDApp_ProcessOSALMsg_14
   1137              #endif
   1138                    }
   1139                  }
   1140                }
   1141                break;
   1142          
   1143              case ZDO_NWK_JOIN_IND:
   1144                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_1:
   \   000168   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00016B   E0           MOVX    A,@DPTR
   \   00016C   6401         XRL     A,#0x1
   \   00016E   6005         JZ      ??ZDApp_ProcessOSALMsg_15
   \   000170   E0           MOVX    A,@DPTR
   \   000171   6402         XRL     A,#0x2
   \   000173   702F         JNZ     ??ZDApp_ProcessOSALMsg_5
   1145                {
   1146                  ZDApp_ProcessNetworkJoin();
   \                     ??ZDApp_ProcessOSALMsg_15:
   \   000175                ; Setup parameters for call to function ZDApp_ProcessNetworkJoin
   \   000175   12....       LCALL   ??ZDApp_ProcessNetworkJoin?relay
   \   000178   802A         SJMP    ??ZDApp_ProcessOSALMsg_5
   1147                }
   1148                break;
   1149          
   1150              case ZDO_NWK_JOIN_REQ:
   1151                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessOSALMsg_2:
   \   00017A   90....       MOV     DPTR,#zgDeviceLogicalType
   \   00017D   E0           MOVX    A,@DPTR
   \   00017E   6401         XRL     A,#0x1
   \   000180   6005         JZ      ??ZDApp_ProcessOSALMsg_16
   \   000182   E0           MOVX    A,@DPTR
   \   000183   6402         XRL     A,#0x2
   \   000185   701D         JNZ     ??ZDApp_ProcessOSALMsg_5
   1152                {
   1153                  retryCnt = 0;
   \                     ??ZDApp_ProcessOSALMsg_16:
   \   000187   90....       MOV     DPTR,#retryCnt
   \   00018A   E4           CLR     A
   \   00018B   F0           MOVX    @DPTR,A
   1154                  devStartMode = MODE_RESUME;
   \   00018C   90....       MOV     DPTR,#devStartMode
   \   00018F   04           INC     A
   \   000190   F0           MOVX    @DPTR,A
   1155                  _tmpRejoinState = true;
   \   000191   90....       MOV     DPTR,#_tmpRejoinState
   \   000194   12....       LCALL   ?Subroutine10 & 0xFFFF
   1156                  osal_cpyExtAddr( ZDO_UseExtendedPANID, _NIB.extendedPANID );
   1157                  zgDefaultStartingScanDuration = BEACON_ORDER_60_MSEC;
   \                     ??CrossCallReturnLabel_3:
   \   000197   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   00019A   7402         MOV     A,#0x2
   \   00019C   F0           MOVX    @DPTR,A
   1158                  ZDApp_NetworkInit( 0 );
   \   00019D                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00019D   7A00         MOV     R2,#0x0
   \   00019F   7B00         MOV     R3,#0x0
   \                     ??ZDApp_ProcessOSALMsg_14:
   \   0001A1   12....       LCALL   ??ZDApp_NetworkInit?relay
   1159                }
   1160                break;
   1161          
   1162              default:
   1163                if ( ZG_SECURE_ENABLED )
   1164                  ZDApp_ProcessSecMsg( msgPtr );
   1165                break;
   1166            }
   1167          
   1168          }
   \                     ??ZDApp_ProcessOSALMsg_5:
   \   0001A4   7401         MOV     A,#0x1
   \   0001A6   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   FD           MOV     R5,A
   \   000001                REQUIRE ??Subroutine49_0
   \   000001                ; // Fall through to label ??Subroutine49_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine49_0:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003   FA           MOV     R2,A
   \   000004   EF           MOV     A,R7
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004                REQUIRE ??Subroutine50_0
   \   000004                ; // Fall through to label ??Subroutine50_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B00         MOV     R3,#0x0
   \   000004   12....       LCALL   ??NLME_SetPollRate?relay
   \   000007                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000007                ; Setup parameters for call to function NLME_SetQueuedPollRate
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7B00         MOV     R3,#0x0
   \   00000B   12....       LCALL   ??NLME_SetQueuedPollRate?relay
   \   00000E                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000E                ; Setup parameters for call to function NLME_SetResponseRate
   \   00000E   7A00         MOV     R2,#0x0
   \   000010   7B00         MOV     R3,#0x0
   \   000012   12....       LCALL   ??NLME_SetResponseRate?relay
   \   000015   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   12....       LCALL   ??osal_rand?relay
   \   000003   EA           MOV     A,R2
   \   000004   547F         ANL     A,#0x7f
   \   000006   2464         ADD     A,#0x64
   \   000008   FA           MOV     R2,A
   \   000009   7B00         MOV     R3,#0x0
   \   00000B   12....       LCALL   ??ZDApp_NetworkInit?relay
   \   00000E   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   22           RET
   1169          
   1170          /*********************************************************************
   1171           * @fn      ZDApp_ProcessMsgCBs()
   1172           *
   1173           * @brief   Process response messages
   1174           *
   1175           * @param   none
   1176           *
   1177           * @return  none
   1178           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1179          void ZDApp_ProcessMsgCBs( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_ProcessMsgCBs:
   1180          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1181            switch ( inMsg->clusterID )
   \   00000E   12....       LCALL   ?Subroutine32 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   000011   F5..         MOV     ?V0 + 1,A
   \   000013   78..         MOV     R0,#?V0 + 0
   \   000015   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDApp_ProcessMsgCBs>_0`:
   \   000018   0200         DW        2
   \   00001A   2100         DW        33
   \   00001C   2200         DW        34
   \   00001E   ....         DW        ??ZDApp_ProcessMsgCBs_0
   \   000020   0080         DW        32768
   \   000022   0180         DW        32769
   \   000024   ....         DW        ??ZDApp_ProcessMsgCBs_1
   \   000026   0000         DW        0
   \   000028   ....         DW        ??ZDApp_ProcessMsgCBs_2
   1182            {
   1183          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1184              case NWK_addr_rsp:
   1185              case IEEE_addr_rsp:
   1186                {
   1187                  ZDO_NwkIEEEAddrResp_t *pAddrRsp;
   1188                  pAddrRsp = ZDO_ParseAddrRsp( inMsg );
   \                     ??ZDApp_ProcessMsgCBs_1:
   \   00002A                ; Setup parameters for call to function ZDO_ParseAddrRsp
   \   00002A   12....       LCALL   ??ZDO_ParseAddrRsp?relay
   \   00002D   8A..         MOV     ?V0 + 0,R2
   \   00002F   8B..         MOV     ?V0 + 1,R3
   \   000031   AE..         MOV     R6,?V0 + 0
   \   000033   AF..         MOV     R7,?V0 + 1
   1189                  if ( pAddrRsp )
   \   000035   EE           MOV     A,R6
   \   000036   4F           ORL     A,R7
   \   000037   603D         JZ      ??ZDApp_ProcessMsgCBs_2
   1190                  {
   1191                    if ( pAddrRsp->status == ZSuccess )
   \   000039   8E82         MOV     DPL,R6
   \   00003B   8F83         MOV     DPH,R7
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   700F         JNZ     ??ZDApp_ProcessMsgCBs_3
   1192                    {
   1193                      ZDO_UpdateAddrManager( pAddrRsp->nwkAddr, pAddrRsp->extAddr );
   \   000040                ; Setup parameters for call to function ZDO_UpdateAddrManager
   \   000040   EE           MOV     A,R6
   \   000041   2403         ADD     A,#0x3
   \   000043   FC           MOV     R4,A
   \   000044   EF           MOV     A,R7
   \   000045   3400         ADDC    A,#0x0
   \   000047   FD           MOV     R5,A
   \   000048   A3           INC     DPTR
   \   000049   12....       LCALL   ?Subroutine25 & 0xFFFF
   1194                    }
   \                     ??CrossCallReturnLabel_31:
   \   00004C   12....       LCALL   ??ZDO_UpdateAddrManager?relay
   1195                    osal_mem_free( pAddrRsp );
   \                     ??ZDApp_ProcessMsgCBs_3:
   \   00004F                ; Setup parameters for call to function osal_mem_free
   \   00004F   EE           MOV     A,R6
   \   000050   FA           MOV     R2,A
   \   000051   EF           MOV     A,R7
   \   000052   FB           MOV     R3,A
   \   000053   12....       LCALL   ??osal_mem_free?relay
   \   000056   801E         SJMP    ??ZDApp_ProcessMsgCBs_2
   1196                  }
   1197                }
   1198                break;
   1199          #endif
   1200          
   1201          #if defined ( REFLECTOR )
   1202              case Bind_req:
   1203              case Unbind_req:
   1204                {
   1205                  ZDO_BindUnbindReq_t bindReq;
   1206                  ZDO_ParseBindUnbindReq( inMsg, &bindReq );
   \                     ??ZDApp_ProcessMsgCBs_0:
   \   000058                ; Setup parameters for call to function ZDO_ParseBindUnbindReq
   \   000058   85..82       MOV     DPL,?XSP + 0
   \   00005B   85..83       MOV     DPH,?XSP + 1
   \   00005E   AC82         MOV     R4,DPL
   \   000060   AD83         MOV     R5,DPH
   \   000062   12....       LCALL   ??ZDO_ParseBindUnbindReq?relay
   1207                  ZDO_ProcessBindUnbindReq( inMsg, &bindReq );
   \   000065                ; Setup parameters for call to function ZDO_ProcessBindUnbindReq
   \   000065   85..82       MOV     DPL,?XSP + 0
   \   000068   85..83       MOV     DPH,?XSP + 1
   \   00006B   AC82         MOV     R4,DPL
   \   00006D   AD83         MOV     R5,DPH
   \   00006F   EE           MOV     A,R6
   \   000070   FA           MOV     R2,A
   \   000071   EF           MOV     A,R7
   \   000072   FB           MOV     R3,A
   \   000073   12....       LCALL   ??ZDO_ProcessBindUnbindReq?relay
   1208                }
   1209                break;
   1210          #endif
   1211          
   1212          #if ( ZG_BUILD_COORDINATOR_TYPE )
   1213              case Bind_rsp:
   1214              case Unbind_rsp:
   1215                if (ZG_DEVICE_COORDINATOR_TYPE && matchED)
   1216                {
   1217                  ZDMatchSendState(
   1218                       (uint8)((inMsg->clusterID == Bind_rsp) ? ZDMATCH_REASON_BIND_RSP : ZDMATCH_REASON_UNBIND_RSP),
   1219                       ZDO_ParseBindRsp(inMsg), inMsg->TransSeq );
   1220                }
   1221                break;
   1222          
   1223              case End_Device_Bind_req:
   1224                if (ZG_DEVICE_COORDINATOR_TYPE)
   1225                {
   1226                  ZDEndDeviceBind_t bindReq;
   1227                  ZDO_ParseEndDeviceBindReq( inMsg, &bindReq );
   1228                  ZDO_MatchEndDeviceBind( &bindReq );
   1229          
   1230                  // Freeing the cluster lists - if allocated.
   1231                  if ( bindReq.numInClusters )
   1232                    osal_mem_free( bindReq.inClusters );
   1233                  if ( bindReq.numOutClusters )
   1234                    osal_mem_free( bindReq.outClusters );
   1235                }
   1236                break;
   1237          #endif
   1238            }
   1239          }
   \                     ??ZDApp_ProcessMsgCBs_2:
   \   000076                REQUIRE ?Subroutine6
   \   000076                ; // Fall through to label ?Subroutine6

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   7415         MOV     A,#0x15
   \   000002   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine41:
   \   000000   EE           MOV     A,R6
   \   000001   240C         ADD     A,#0xc
   \   000003                REQUIRE ??Subroutine56_0
   \   000003                ; // Fall through to label ??Subroutine56_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine56_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine57_0
   \   000003                ; // Fall through to label ??Subroutine57_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine57_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_123:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F5..         MOV     ?V0 + 0,A
   \   000006   A3           INC     DPTR
   \   000007   E0           MOVX    A,@DPTR
   \   000008   22           RET
   1240          
   1241          /*********************************************************************
   1242           * @fn      ZDApp_RegisterCBs()
   1243           *
   1244           * @brief   Process response messages
   1245           *
   1246           * @param   none
   1247           *
   1248           * @return  none
   1249           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1250          void ZDApp_RegisterCBs( void )
   \                     ZDApp_RegisterCBs:
   1251          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1252          #if defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1253            ZDO_RegisterForZDOMsg( ZDAppTaskID, IEEE_addr_rsp );
   \   000004                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000004   7A01         MOV     R2,#0x1
   \   000006   12....       LCALL   ?Subroutine22 & 0xFFFF
   1254          #endif
   1255          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( REFLECTOR )
   1256            ZDO_RegisterForZDOMsg( ZDAppTaskID, NWK_addr_rsp );
   \                     ??CrossCallReturnLabel_85:
   \   000009                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000009   7A00         MOV     R2,#0x0
   \   00000B   12....       LCALL   ?Subroutine22 & 0xFFFF
   1257          #endif
   1258          #if ZG_BUILD_COORDINATOR_TYPE
   1259            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_rsp );
   1260            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_rsp );
   1261            ZDO_RegisterForZDOMsg( ZDAppTaskID, End_Device_Bind_req );
   1262          #endif
   1263          #if defined ( REFLECTOR )
   1264            ZDO_RegisterForZDOMsg( ZDAppTaskID, Bind_req );
   \                     ??CrossCallReturnLabel_86:
   \   00000E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00000E   7A21         MOV     R2,#0x21
   \   000010   7B00         MOV     R3,#0x0
   \   000012   12....       LCALL   ??Subroutine51_0 & 0xFFFF
   1265            ZDO_RegisterForZDOMsg( ZDAppTaskID, Unbind_req );
   \                     ??CrossCallReturnLabel_87:
   \   000015                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000015   7A22         MOV     R2,#0x22
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   ??Subroutine51_0 & 0xFFFF
   1266          #endif
   1267          }
   \                     ??CrossCallReturnLabel_88:
   \   00001C   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   7B80         MOV     R3,#-0x80
   \   000002                REQUIRE ??Subroutine51_0
   \   000002                ; // Fall through to label ??Subroutine51_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine51_0:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000008   22           RET
   1268          
   1269          /*********************************************************************
   1270           * @fn      ZDApp_ProcessSecMsg()
   1271           *
   1272           * @brief   Process the incoming security message.
   1273           *
   1274           * @param   msgPtr - message to process
   1275           *
   1276           * @return  none
   1277           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1278          void ZDApp_ProcessSecMsg( osal_event_hdr_t *msgPtr )
   \                     ZDApp_ProcessSecMsg:
   1279          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1280            switch ( msgPtr->event )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   E0           MOVX    A,@DPTR
   \   000009   24FA         ADD     A,#-0x6
   \   00000B   6006         JZ      ??ZDApp_ProcessSecMsg_0
   \   00000D   24FC         ADD     A,#-0x4
   \   00000F   6014         JZ      ??ZDApp_ProcessSecMsg_1
   \   000011   8022         SJMP    ??ZDApp_ProcessSecMsg_2
   1281            {
   1282              case ZDO_ESTABLISH_KEY_CFM:
   1283                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1284                {
   1285                  ZDSecMgrEstablishKeyCfm( (ZDO_EstablishKeyCfm_t*)msgPtr );
   1286                }
   1287                break;
   1288          
   1289              case ZDO_ESTABLISH_KEY_IND:
   1290                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1291                {
   1292                  if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   1293                  {
   1294                    ZDSecMgrEstablishKeyInd( (ZDO_EstablishKeyInd_t*)msgPtr );
   1295                  }
   1296                }
   1297                break;
   1298          
   1299              case ZDO_TRANSPORT_KEY_IND:
   1300                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_0:
   \   000013   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000016   E0           MOVX    A,@DPTR
   \   000017   6401         XRL     A,#0x1
   \   000019   6005         JZ      ??ZDApp_ProcessSecMsg_3
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   6402         XRL     A,#0x2
   \   00001E   7015         JNZ     ??ZDApp_ProcessSecMsg_2
   1301                {
   1302                  ZDSecMgrTransportKeyInd( (ZDO_TransportKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_3:
   \   000020                ; Setup parameters for call to function ZDSecMgrTransportKeyInd
   \   000020   12....       LCALL   ??ZDSecMgrTransportKeyInd?relay
   \   000023   8010         SJMP    ??ZDApp_ProcessSecMsg_2
   1303                }
   1304                break;
   1305          
   1306              case ZDO_UPDATE_DEVICE_IND:
   1307                if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1308                {
   1309                  ZDSecMgrUpdateDeviceInd( (ZDO_UpdateDeviceInd_t*)msgPtr );
   1310                }
   1311                break;
   1312          
   1313              case ZDO_REMOVE_DEVICE_IND:
   1314                if ( ZG_BUILD_RTRONLY_TYPE && ( zgDeviceLogicalType == ZG_DEVICETYPE_ROUTER ) )
   1315                {
   1316                  ZDSecMgrRemoveDeviceInd( (ZDO_RemoveDeviceInd_t*)msgPtr );
   1317                }
   1318                break;
   1319          
   1320              case ZDO_REQUEST_KEY_IND:
   1321                if (( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH ) ||
   1322                    ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_SE_STANDARD ))
   1323                {
   1324                  if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
   1325                  {
   1326                    ZDSecMgrRequestKeyInd( (ZDO_RequestKeyInd_t*)msgPtr );
   1327                  }
   1328                }
   1329                break;
   1330          
   1331              case ZDO_SWITCH_KEY_IND:
   1332                if ( ZG_BUILD_JOINING_TYPE && ZG_DEVICE_JOINING_TYPE )
   \                     ??ZDApp_ProcessSecMsg_1:
   \   000025   90....       MOV     DPTR,#zgDeviceLogicalType
   \   000028   E0           MOVX    A,@DPTR
   \   000029   6401         XRL     A,#0x1
   \   00002B   6005         JZ      ??ZDApp_ProcessSecMsg_4
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   6402         XRL     A,#0x2
   \   000030   7003         JNZ     ??ZDApp_ProcessSecMsg_2
   1333                {
   1334                  ZDSecMgrSwitchKeyInd( (ZDO_SwitchKeyInd_t*)msgPtr );
   \                     ??ZDApp_ProcessSecMsg_4:
   \   000032                ; Setup parameters for call to function ZDSecMgrSwitchKeyInd
   \   000032   12....       LCALL   ??ZDSecMgrSwitchKeyInd?relay
   1335                }
   1336                break;
   1337          
   1338              case ZDO_AUTHENTICATE_IND:
   1339                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1340                {
   1341                  ZDSecMgrAuthenticateInd( (ZDO_AuthenticateInd_t*)msgPtr );
   1342                }
   1343                break;
   1344          
   1345              case ZDO_AUTHENTICATE_CFM:
   1346                if ( ZG_CHECK_SECURITY_MODE == ZG_SECURITY_PRO_HIGH )
   1347                {
   1348                  ZDSecMgrAuthenticateCfm( (ZDO_AuthenticateCfm_t*)msgPtr );
   1349                }
   1350                break;
   1351          
   1352              default:
   1353                // Unsupported messages
   1354                break;
   1355            }
   1356          }
   \                     ??ZDApp_ProcessSecMsg_2:
   \   000035   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   1357          
   1358          /*********************************************************************
   1359           * @fn      ZDApp_ProcessNetworkJoin()
   1360           *
   1361           * @brief
   1362           *
   1363           *   Save off the Network key information.
   1364           *
   1365           * @param   none
   1366           *
   1367           * @return  none
   1368           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1369          void ZDApp_ProcessNetworkJoin( void )
   \                     ZDApp_ProcessNetworkJoin:
   1370          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1371            if ( (devState == DEV_NWK_JOINING) ||
   1372                ((devState == DEV_NWK_ORPHAN)  &&
   1373                 (ZDO_Config_Node_Descriptor.LogicalType == NODETYPE_ROUTER)) )
   \   00000A   90....       MOV     DPTR,#devState
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6403         XRL     A,#0x3
   \   000010   6015         JZ      ??ZDApp_ProcessNetworkJoin_0
   \   000012   E0           MOVX    A,@DPTR
   \   000013   640A         XRL     A,#0xa
   \   000015   6003         JZ      $+5
   \   000017   02....       LJMP    ??ZDApp_ProcessNetworkJoin_1 & 0xFFFF
   \   00001A   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   5407         ANL     A,#0x7
   \   000020   6401         XRL     A,#0x1
   \   000022   6003         JZ      $+5
   \   000024   02....       LJMP    ??ZDApp_ProcessNetworkJoin_2 & 0xFFFF
   1374            {
   1375              // Result of a Join attempt by this device.
   1376              if ( nwkStatus == ZSuccess )
   \                     ??ZDApp_ProcessNetworkJoin_0:
   \   000027   90....       MOV     DPTR,#nwkStatus
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   7019         JNZ     ??ZDApp_ProcessNetworkJoin_3
   1377              {
   1378                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   00002D                ; Setup parameters for call to function osal_set_event
   \   00002D   12....       LCALL   ?Subroutine19 & 0xFFFF
   1379          
   1380          #if defined ( POWER_SAVING )
   1381                osal_pwrmgr_device( PWRMGR_BATTERY );
   1382          #endif
   1383          
   1384                if ( ZG_SECURE_ENABLED && ( ZDApp_RestoreNwkKey() == false ) )
   1385                {
   1386                  // wait for auth from trust center!!
   1387                  devState = DEV_END_DEVICE_UNAUTH;
   1388          
   1389                  // Start the reset timer for MAX UNAUTH time
   1390                  ZDApp_ResetTimerStart( 10000 );//MAX_DEVICE_UNAUTH_TIMEOUT );
   1391                }
   1392                else
   1393                {
   1394                  if ( ZSTACK_ROUTER_BUILD )
   1395                  {
   1396                    if ( devState == DEV_NWK_ORPHAN
   1397                      && ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1398                    {
   1399                      // Change NIB state to router for restore
   1400                      _NIB.nwkState = NWK_ROUTER;
   1401                    }
   1402                  }
   1403          
   1404                  if ( devState == DEV_NWK_JOINING )
   \                     ??CrossCallReturnLabel_65:
   \   000030   90....       MOV     DPTR,#devState
   \   000033   E0           MOVX    A,@DPTR
   \   000034   6403         XRL     A,#0x3
   \   000036   7003         JNZ     ??ZDApp_ProcessNetworkJoin_4
   1405                  {
   1406                    ZDApp_AnnounceNewAddress();
   \   000038                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000038   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1407                  }
   1408          
   1409                  devState = DEV_END_DEVICE;
   \                     ??ZDApp_ProcessNetworkJoin_4:
   \   00003B   90....       MOV     DPTR,#devState
   \   00003E   7406         MOV     A,#0x6
   \   000040   12....       LCALL   ?Subroutine14 & 0xFFFF
   1410                  HalLedSet(HAL_LED_1,HAL_LED_MODE_ON);
   1411                  
   1412                  if ( ZSTACK_ROUTER_BUILD )
   \                     ??CrossCallReturnLabel_9:
   \   000043   02....       LJMP    ??CrossCallReturnLabel_66 & 0xFFFF
   1413                  {
   1414                    // NOTE: first two parameters are not used, see NLMEDE.h for details
   1415                    if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1416                    {
   1417                      NLME_StartRouterRequest( 0, 0, false );
   1418                    }
   1419                  }
   1420                }
   1421              }
   1422              else
   1423              {
   1424                if ( (devStartMode == MODE_RESUME) && (++retryCnt >= MAX_RESUME_RETRY) )
   \                     ??ZDApp_ProcessNetworkJoin_3:
   \   000046   90....       MOV     DPTR,#devStartMode
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   6401         XRL     A,#0x1
   \   00004C   7036         JNZ     ??ZDApp_ProcessNetworkJoin_5
   \   00004E   90....       MOV     DPTR,#retryCnt
   \   000051   E0           MOVX    A,@DPTR
   \   000052   04           INC     A
   \   000053   F0           MOVX    @DPTR,A
   \   000054   C3           CLR     C
   \   000055   9403         SUBB    A,#0x3
   \   000057   402B         JC      ??ZDApp_ProcessNetworkJoin_5
   1425                {
   1426                  if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   000059   90....       MOV     DPTR,#_NIB + 33
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   F4           CPL     A
   \   00005E   7003         JNZ     ??ZDApp_ProcessNetworkJoin_6
   \   000060   A3           INC     DPTR
   \   000061   E0           MOVX    A,@DPTR
   \   000062   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_6:
   \   000063   600D         JZ      ??ZDApp_ProcessNetworkJoin_7
   \   000065   90....       MOV     DPTR,#_NIB + 33
   \   000068   E0           MOVX    A,@DPTR
   \   000069   64FE         XRL     A,#0xfe
   \   00006B   7003         JNZ     ??ZDApp_ProcessNetworkJoin_8
   \   00006D   A3           INC     DPTR
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_8:
   \   000070   7006         JNZ     ??ZDApp_ProcessNetworkJoin_9
   1427                    devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_7:
   \   000072   90....       MOV     DPTR,#devStartMode
   \   000075   E4           CLR     A
   \   000076   800B         SJMP    ??ZDApp_ProcessNetworkJoin_10
   1428                  else
   1429                  {
   1430                    devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_9:
   \   000078   90....       MOV     DPTR,#devStartMode
   \   00007B   7403         MOV     A,#0x3
   \   00007D   F0           MOVX    @DPTR,A
   1431                    _tmpRejoinState = true;
   \   00007E   90....       MOV     DPTR,#_tmpRejoinState
   \   000081   7401         MOV     A,#0x1
   \                     ??ZDApp_ProcessNetworkJoin_10:
   \   000083   F0           MOVX    @DPTR,A
   1432                  }
   1433                }
   1434          
   1435                if ( (NLME_GetShortAddr() != INVALID_NODE_ADDR) ||
   1436                     (_NIB.nwkDevAddress != INVALID_NODE_ADDR) )
   \                     ??ZDApp_ProcessNetworkJoin_5:
   \   000084                ; Setup parameters for call to function NLME_GetShortAddr
   \   000084   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000087   8A..         MOV     ?V0 + 0,R2
   \   000089   8B..         MOV     ?V0 + 1,R3
   \   00008B   74FE         MOV     A,#-0x2
   \   00008D   65..         XRL     A,?V0 + 0
   \   00008F   7004         JNZ     ??ZDApp_ProcessNetworkJoin_11
   \   000091   74FF         MOV     A,#-0x1
   \   000093   65..         XRL     A,?V0 + 1
   \                     ??ZDApp_ProcessNetworkJoin_11:
   \   000095   700D         JNZ     ??ZDApp_ProcessNetworkJoin_12
   \   000097   90....       MOV     DPTR,#_NIB + 20
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   64FE         XRL     A,#0xfe
   \   00009D   7003         JNZ     ??ZDApp_ProcessNetworkJoin_13
   \   00009F   A3           INC     DPTR
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_13:
   \   0000A2   601B         JZ      ??ZDApp_ProcessNetworkJoin_14
   1437                {
   1438                  uint16 addr = INVALID_NODE_ADDR;
   \                     ??ZDApp_ProcessNetworkJoin_12:
   \   0000A4   85..82       MOV     DPL,?XSP + 0
   \   0000A7   85..83       MOV     DPH,?XSP + 1
   \   0000AA   74FE         MOV     A,#-0x2
   \   0000AC   F0           MOVX    @DPTR,A
   \   0000AD   A3           INC     DPTR
   \   0000AE   04           INC     A
   \   0000AF   F0           MOVX    @DPTR,A
   1439                  // Invalidate nwk addr so end device does not use in its data reqs.
   1440                  _NIB.nwkDevAddress = INVALID_NODE_ADDR;
   \   0000B0   90....       MOV     DPTR,#_NIB + 20
   \   0000B3   14           DEC     A
   \   0000B4   F0           MOVX    @DPTR,A
   \   0000B5   A3           INC     DPTR
   \   0000B6   04           INC     A
   \   0000B7   12....       LCALL   ?Subroutine12 & 0xFFFF
   1441                  ZMacSetReq( ZMacShortAddress, (uint8 *)&addr );
   1442                }
   \                     ??CrossCallReturnLabel_6:
   \   0000BA   7953         MOV     R1,#0x53
   \   0000BC   12....       LCALL   ??ZMacSetReq?relay
   1443          
   1444                // Clear the neighbor Table and network discovery tables.
   1445                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_14:
   \   0000BF                ; Setup parameters for call to function nwkNeighborInitTable
   \   0000BF   12....       LCALL   ??nwkNeighborInitTable?relay
   1446                NLME_NwkDiscTerm();
   \   0000C2                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   0000C2   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1447          
   1448                zdoDiscCounter = 1;
   \   0000C5   90....       MOV     DPTR,#zdoDiscCounter
   \   0000C8   7401         MOV     A,#0x1
   \   0000CA   F0           MOVX    @DPTR,A
   1449          
   1450          //      ZDApp_NetworkInit( (uint16)
   1451          //                         ((NWK_START_DELAY * (osal_rand() & 0x0F)) +
   1452          //                          (NWK_START_DELAY * 5)) );
   1453                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1454                     + ((uint16)(osal_rand()& EXTENDED_JOINING_RANDOM_MASK))) );
   \   0000CB                ; Setup parameters for call to function ZDApp_NetworkInit
   \   0000CB                ; Setup parameters for call to function osal_rand
   1455              }
   1456            }
   \                     ??ZDApp_ProcessNetworkJoin_15:
   \   0000CB   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   0000CE   807C         SJMP    ??CrossCallReturnLabel_66
   1457            else if ( devState == DEV_NWK_ORPHAN || devState == DEV_NWK_REJOIN )
   \                     ??ZDApp_ProcessNetworkJoin_1:
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   6404         XRL     A,#0x4
   \   0000D3   7069         JNZ     ??ZDApp_ProcessNetworkJoin_16
   1458            {
   1459              // results of an orphaning attempt by this device
   1460              if (nwkStatus == ZSuccess)
   \                     ??ZDApp_ProcessNetworkJoin_2:
   \   0000D5   90....       MOV     DPTR,#nwkStatus
   \   0000D8   E0           MOVX    A,@DPTR
   \   0000D9   7013         JNZ     ??ZDApp_ProcessNetworkJoin_17
   1461              {
   1462                if ( ZG_SECURE_ENABLED )
   1463                {
   1464                  ZDApp_RestoreNwkKey();
   1465                }
   1466          
   1467                devState = DEV_END_DEVICE;
   \   0000DB   12....       LCALL   ?Subroutine8 & 0xFFFF
   1468                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   1469                // setup Power Manager Device
   1470          #if defined ( POWER_SAVING )
   1471                osal_pwrmgr_device( PWRMGR_BATTERY );
   1472          #endif
   1473          
   1474                if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_RCVR_ON_IDLE )
   \                     ??CrossCallReturnLabel_72:
   \   0000DE   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   0000E1   E0           MOVX    A,@DPTR
   \   0000E2   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000E4   5003         JNC     ??CrossCallReturnLabel_48
   1475                {
   1476                  // The receiver is on, turn network layer polling off.
   1477                  NLME_SetPollRate( 0 );
   \   0000E6                ; Setup parameters for call to function NLME_SetPollRate
   \   0000E6   12....       LCALL   ?Subroutine34 & 0xFFFF
   1478                  NLME_SetQueuedPollRate( 0 );
   1479                  NLME_SetResponseRate( 0 );
   1480                }
   1481          
   1482                if ( ZSTACK_ROUTER_BUILD )
   1483                {
   1484                  // NOTE: first two parameters are not used, see NLMEDE.h for details
   1485                  if ( ZDO_Config_Node_Descriptor.LogicalType != NODETYPE_DEVICE )
   1486                  {
   1487                    NLME_StartRouterRequest( 0, 0, false );
   1488                  }
   1489                }
   1490          
   1491                ZDApp_AnnounceNewAddress();
   \                     ??CrossCallReturnLabel_48:
   \   0000E9                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   0000E9   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   \   0000EC   805E         SJMP    ??CrossCallReturnLabel_66
   1492              }
   1493              else
   1494              {
   1495                if ( devStartMode == MODE_RESUME )
   \                     ??ZDApp_ProcessNetworkJoin_17:
   \   0000EE   90....       MOV     DPTR,#devStartMode
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   6401         XRL     A,#0x1
   \   0000F4   7040         JNZ     ??ZDApp_ProcessNetworkJoin_18
   1496                {
   1497                  if ( ++retryCnt <= MAX_RESUME_RETRY )
   \   0000F6   90....       MOV     DPTR,#retryCnt
   \   0000F9   E0           MOVX    A,@DPTR
   \   0000FA   04           INC     A
   \   0000FB   F0           MOVX    @DPTR,A
   \   0000FC   C3           CLR     C
   \   0000FD   9404         SUBB    A,#0x4
   \   0000FF   502D         JNC     ??ZDApp_ProcessNetworkJoin_19
   1498                  {
   1499                    if ( _NIB.nwkPanId == 0xFFFF || _NIB.nwkPanId == INVALID_PAN_ID )
   \   000101   90....       MOV     DPTR,#_NIB + 33
   \   000104   E0           MOVX    A,@DPTR
   \   000105   F4           CPL     A
   \   000106   7003         JNZ     ??ZDApp_ProcessNetworkJoin_20
   \   000108   A3           INC     DPTR
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_20:
   \   00010B   600D         JZ      ??ZDApp_ProcessNetworkJoin_21
   \   00010D   90....       MOV     DPTR,#_NIB + 33
   \   000110   E0           MOVX    A,@DPTR
   \   000111   64FE         XRL     A,#0xfe
   \   000113   7003         JNZ     ??ZDApp_ProcessNetworkJoin_22
   \   000115   A3           INC     DPTR
   \   000116   E0           MOVX    A,@DPTR
   \   000117   F4           CPL     A
   \                     ??ZDApp_ProcessNetworkJoin_22:
   \   000118   7007         JNZ     ??ZDApp_ProcessNetworkJoin_23
   1500                      devStartMode = MODE_JOIN;
   \                     ??ZDApp_ProcessNetworkJoin_21:
   \   00011A   90....       MOV     DPTR,#devStartMode
   \   00011D   E4           CLR     A
   \                     ??ZDApp_ProcessNetworkJoin_24:
   \   00011E   F0           MOVX    @DPTR,A
   \   00011F   8015         SJMP    ??ZDApp_ProcessNetworkJoin_18
   1501                    else
   1502                    {
   1503                      devStartMode = MODE_REJOIN;
   \                     ??ZDApp_ProcessNetworkJoin_23:
   \   000121   90....       MOV     DPTR,#devStartMode
   \   000124   7403         MOV     A,#0x3
   \   000126   F0           MOVX    @DPTR,A
   1504                      _tmpRejoinState = true;
   \   000127   90....       MOV     DPTR,#_tmpRejoinState
   \   00012A   7401         MOV     A,#0x1
   \   00012C   80F0         SJMP    ??ZDApp_ProcessNetworkJoin_24
   1505                    }
   1506                  }
   1507                  // Do a normal join to the network after certain times of rejoin retries
   1508                  else if( AIB_apsUseInsecureJoin == true )
   \                     ??ZDApp_ProcessNetworkJoin_19:
   \   00012E   90....       MOV     DPTR,#AIB_apsUseInsecureJoin
   \   000131   E0           MOVX    A,@DPTR
   \   000132   6401         XRL     A,#0x1
   \   000134   60E4         JZ      ??ZDApp_ProcessNetworkJoin_21
   1509                  {
   1510                    devStartMode = MODE_JOIN;
   1511                  }
   1512                }
   1513          
   1514                // Clear the neighbor Table and network discovery tables.
   1515                nwkNeighborInitTable();
   \                     ??ZDApp_ProcessNetworkJoin_18:
   \   000136                ; Setup parameters for call to function nwkNeighborInitTable
   \   000136   12....       LCALL   ??nwkNeighborInitTable?relay
   1516                NLME_NwkDiscTerm();
   \   000139                ; Setup parameters for call to function NLME_NwkDiscTerm
   \   000139   12....       LCALL   ??NLME_NwkDiscTerm?relay
   1517          
   1518                // setup a retry for later...
   1519                ZDApp_NetworkInit( (uint16)(NWK_START_DELAY
   1520                     + (osal_rand()& EXTENDED_JOINING_RANDOM_MASK)) );
   \   00013C                ; Setup parameters for call to function ZDApp_NetworkInit
   \   00013C                ; Setup parameters for call to function osal_rand
   \   00013C   808D         SJMP    ??ZDApp_ProcessNetworkJoin_15
   1521              }
   1522            }
   1523          #if defined ( ZIGBEE_STOCHASTIC_ADDRESSING )
   1524            else
   1525            {
   1526              // Assume from address conflict
   1527              if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \                     ??ZDApp_ProcessNetworkJoin_16:
   \   00013E   90....       MOV     DPTR,#_NIB + 96
   \   000141   E0           MOVX    A,@DPTR
   \   000142   6402         XRL     A,#0x2
   \   000144   7006         JNZ     ??CrossCallReturnLabel_66
   1528              {
   1529                // Notify the network
   1530                ZDApp_AnnounceNewAddress();
   \   000146                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   000146   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   1531          
   1532                // Notify apps
   1533                osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000149                ; Setup parameters for call to function osal_set_event
   \   000149   12....       LCALL   ?Subroutine19 & 0xFFFF
   1534              }
   1535            }
   1536          #endif
   1537          }
   \                     ??CrossCallReturnLabel_66:
   \   00014C                REQUIRE ?Subroutine7
   \   00014C                ; // Fall through to label ?Subroutine7

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   7402         MOV     A,#0x2
   \   000002   02....       LJMP    ??Subroutine43_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   F0           MOVX    @DPTR,A
   \   000001                ; Setup parameters for call to function ZMacSetReq
   \   000001                ; Setup parameters for indirect call
   \   000001   85..82       MOV     DPL,?XSP + 0
   \   000004   85..83       MOV     DPH,?XSP + 1
   \   000007   AA82         MOV     R2,DPL
   \   000009   AB83         MOV     R3,DPH
   \   00000B   22           RET
   1538          
   1539          /*********************************************************************
   1540           * @fn      ZDApp_SaveNwkKey()
   1541           *
   1542           * @brief   Save off the Network key information.
   1543           *
   1544           * @param   none
   1545           *
   1546           * @return  none
   1547           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7415         MOV     A,#0x15
   \   000002                REQUIRE ??Subroutine46_0
   \   000002                ; // Fall through to label ??Subroutine46_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1548          void ZDApp_SaveNwkKey( void )
   \                     ZDApp_SaveNwkKey:
   1549          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1550            nwkActiveKeyItems keyItems;
   1551          
   1552            SSP_ReadNwkActiveKey( &keyItems );
   \   00000A                ; Setup parameters for call to function SSP_ReadNwkActiveKey
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   AA82         MOV     R2,DPL
   \   000012   AB83         MOV     R3,DPH
   \   000014   12....       LCALL   ??SSP_ReadNwkActiveKey?relay
   1553            keyItems.frameCounter++;
   \   000017   90....       MOV     DPTR,#__Constant_1
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?L_MOV_X
   \   00001F   7411         MOV     A,#0x11
   \   000021   12....       LCALL   ?XSTACK_DISP0_8
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?L_ADD_TO_X
   1554          
   1555            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1556                          (void *)&keyItems );
   \   000029                ; Setup parameters for call to function osal_nv_write
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   8582..       MOV     ?V0 + 0,DPL
   \   000032   8583..       MOV     ?V0 + 1,DPH
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003A   75..15       MOV     ?V0 + 0,#0x15
   \   00003D   75..00       MOV     ?V0 + 1,#0x0
   \   000040   78..         MOV     R0,#?V0 + 0
   \   000042   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000045   7C00         MOV     R4,#0x0
   \   000047   7D00         MOV     R5,#0x0
   \   000049   7A82         MOV     R2,#-0x7e
   \   00004B   7B00         MOV     R3,#0x0
   \   00004D   12....       LCALL   ??osal_nv_write?relay
   \   000050   7404         MOV     A,#0x4
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
   1557          
   1558            nwkFrameCounterChanges = 0;
   \   000055   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   000058   E4           CLR     A
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   F0           MOVX    @DPTR,A
   1559          
   1560            // Clear copy in RAM before return.
   1561            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \   00005C                ; Setup parameters for call to function osal_memset
   \   00005C   7C15         MOV     R4,#0x15
   \   00005E   FD           MOV     R5,A
   \   00005F   F9           MOV     R1,A
   \   000060   85..82       MOV     DPL,?XSP + 0
   \   000063   85..83       MOV     DPH,?XSP + 1
   \   000066   AA82         MOV     R2,DPL
   \   000068   AB83         MOV     R3,DPH
   \   00006A   12....       LCALL   ??osal_memset?relay
   1562          
   1563          }
   \   00006D   02....       LJMP    ?Subroutine2 & 0xFFFF
   1564          
   1565          /*********************************************************************
   1566           * @fn      ZDApp_ResetNwkKey()
   1567           *
   1568           * @brief   Reset the Network key information in NV.
   1569           *
   1570           * @param   none
   1571           *
   1572           * @return  none
   1573           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1574          void ZDApp_ResetNwkKey( void )
   \                     ZDApp_ResetNwkKey:
   1575          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1576            nwkActiveKeyItems keyItems;
   1577          
   1578            osal_memset( &keyItems, 0, sizeof( nwkActiveKeyItems ) );
   \   00000A                ; Setup parameters for call to function osal_memset
   \   00000A   7C15         MOV     R4,#0x15
   \   00000C   12....       LCALL   ?Subroutine35 & 0xFFFF
   1579            osal_nv_write( ZCD_NV_NWKKEY, 0, sizeof( nwkActiveKeyItems ),
   1580                          (void *)&keyItems );
   \                     ??CrossCallReturnLabel_50:
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   75..15       MOV     ?V0 + 0,#0x15
   \   000015   75..00       MOV     ?V0 + 1,#0x0
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   7C00         MOV     R4,#0x0
   \   00001F   7D00         MOV     R5,#0x0
   \   000021   7A82         MOV     R2,#-0x7e
   \   000023   7B00         MOV     R3,#0x0
   \   000025   12....       LCALL   ??osal_nv_write?relay
   \   000028   7404         MOV     A,#0x4
   \   00002A   12....       LCALL   ?DEALLOC_XSTACK8
   1581          }
   \   00002D   02....       LJMP    ?Subroutine6 & 0xFFFF
   1582          
   1583          /*********************************************************************
   1584           * @fn      ZDApp_RestoreNwkKey()
   1585           *
   1586           * @brief
   1587           *
   1588           *   Save off the Network key information.
   1589           *
   1590           * @param   none
   1591           *
   1592           * @return  true if restored from NV, false if not
   1593           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1594          uint8 ZDApp_RestoreNwkKey( void )
   \                     ZDApp_RestoreNwkKey:
   1595          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 21
   \   000005   74EB         MOV     A,#-0x15
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1596            nwkActiveKeyItems keyItems;
   1597            uint8 ret = false;
   \   00000A   7E00         MOV     R6,#0x0
   1598          
   1599            if ( osal_nv_read( ZCD_NV_NWKKEY, 0, sizeof(nwkActiveKeyItems), (void*)&keyItems )
   1600                == ZSUCCESS )
   \   00000C                ; Setup parameters for call to function osal_nv_read
   \   00000C   85..82       MOV     DPL,?XSP + 0
   \   00000F   85..83       MOV     DPH,?XSP + 1
   \   000012   8582..       MOV     ?V0 + 0,DPL
   \   000015   8583..       MOV     ?V0 + 1,DPH
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001D   75..15       MOV     ?V0 + 0,#0x15
   \   000020   8E..         MOV     ?V0 + 1,R6
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   7C00         MOV     R4,#0x0
   \   000029   7D00         MOV     R5,#0x0
   \   00002B   7A82         MOV     R2,#-0x7e
   \   00002D   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_52:
   \   000030   12....       LCALL   ?DEALLOC_XSTACK8
   \   000033   E9           MOV     A,R1
   \   000034   703F         JNZ     ??ZDApp_RestoreNwkKey_0
   1601            {
   1602              if ( keyItems.frameCounter > 0 )
   \   000036   7411         MOV     A,#0x11
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   78..         MOV     R0,#?V0 + 0
   \   00003D   12....       LCALL   ?L_MOV_X
   \   000040   E5..         MOV     A,?V0 + 0
   \   000042   45..         ORL     A,?V0 + 1
   \   000044   45..         ORL     A,?V0 + 2
   \   000046   45..         ORL     A,?V0 + 3
   \   000048   6021         JZ      ??ZDApp_RestoreNwkKey_1
   1603              {
   1604                // Restore the key information
   1605                keyItems.frameCounter += MAX_NWK_FRAMECOUNTER_CHANGES;
   \   00004A   90....       MOV     DPTR,#__Constant_3e8
   \   00004D   78..         MOV     R0,#?V0 + 0
   \   00004F   12....       LCALL   ?L_MOV_X
   \   000052   7411         MOV     A,#0x11
   \   000054   12....       LCALL   ?XSTACK_DISP0_8
   \   000057   78..         MOV     R0,#?V0 + 0
   \   000059   12....       LCALL   ?L_ADD_TO_X
   1606                nwkFrameCounter = keyItems.frameCounter;
   \   00005C   7411         MOV     A,#0x11
   \   00005E   12....       LCALL   ?XSTACK_DISP0_8
   \   000061   12....       LCALL   ?XLOAD_R2345
   \   000064   90....       MOV     DPTR,#nwkFrameCounter
   \   000067   12....       LCALL   ?XSTORE_R2345
   1607                ret = true;
   \   00006A   0E           INC     R6
   1608              }
   1609          
   1610              // Force a save for the first frame counter increment
   1611              nwkFrameCounterChanges = MAX_NWK_FRAMECOUNTER_CHANGES + 1;
   \                     ??ZDApp_RestoreNwkKey_1:
   \   00006B   90....       MOV     DPTR,#nwkFrameCounterChanges
   \   00006E   74E9         MOV     A,#-0x17
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   7403         MOV     A,#0x3
   \   000074   F0           MOVX    @DPTR,A
   1612            }
   1613            // Clear copy in RAM before return.
   1614            osal_memset( &keyItems, 0x00, sizeof(keyItems) );
   \                     ??ZDApp_RestoreNwkKey_0:
   \   000075                ; Setup parameters for call to function osal_memset
   \   000075   7C15         MOV     R4,#0x15
   \   000077   7D00         MOV     R5,#0x0
   \   000079   7900         MOV     R1,#0x0
   \   00007B   85..82       MOV     DPL,?XSP + 0
   \   00007E   85..83       MOV     DPH,?XSP + 1
   \   000081   AA82         MOV     R2,DPL
   \   000083   AB83         MOV     R3,DPH
   \   000085   12....       LCALL   ??osal_memset?relay
   1615          
   1616            return ( ret );
   \   000088   EE           MOV     A,R6
   \   000089   F9           MOV     R1,A
   \   00008A   02....       LJMP    ?Subroutine2 & 0xFFFF
   1617          }
   1618          
   1619          /*********************************************************************
   1620           * @fn      ZDApp_ResetTimerStart
   1621           *
   1622           * @brief   Start the reset timer.
   1623           *
   1624           * @param   delay - delay time(ms) before reset
   1625           *
   1626           * @return  none
   1627           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1628          void ZDApp_ResetTimerStart( uint16 delay )
   \                     ZDApp_ResetTimerStart:
   1629          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1630            // Start the rest timer
   1631            osal_start_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET, delay );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   EA           MOV     A,R2
   \   000005   FC           MOV     R4,A
   \   000006   EB           MOV     A,R3
   \   000007   FD           MOV     R5,A
   \   000008   7A04         MOV     R2,#0x4
   \   00000A   7B00         MOV     R3,#0x0
   \   00000C   02....       LJMP    ?Subroutine3 & 0xFFFF
   1632          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_89:
   \   000003                REQUIRE ??Subroutine52_0
   \   000003                ; // Fall through to label ??Subroutine52_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003                REQUIRE ??Subroutine53_0
   \   000003                ; // Fall through to label ??Subroutine53_0
   1633          
   1634          /*********************************************************************
   1635           * @fn      ZDApp_ResetTimerCancel
   1636           *
   1637           * @brief   Cancel the reset timer.
   1638           *
   1639           * @param   none
   1640           *
   1641           * @return  none
   1642           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1643          void ZDApp_ResetTimerCancel( void )
   \                     ZDApp_ResetTimerCancel:
   1644          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1645            // Cancel the reset timer
   1646            osal_stop_timerEx( ZDAppTaskID, ZDO_DEVICE_RESET );
   \   000004                ; Setup parameters for call to function osal_stop_timerEx
   \   000004   7A04         MOV     R2,#0x4
   \   000006   7B00         MOV     R3,#0x0
   \   000008   90....       MOV     DPTR,#ZDAppTaskID
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   12....       LCALL   ??osal_stop_timerEx?relay
   1647          }
   \   000010   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   1648          
   1649          /*********************************************************************
   1650           * @fn      ZDApp_LeaveCtrlInit
   1651           *
   1652           * @brief   Initialize the leave control logic.
   1653           *
   1654           * @param   none
   1655           *
   1656           * @return  none
   1657           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1658          void ZDApp_LeaveCtrlInit( void )
   \                     ZDApp_LeaveCtrlInit:
   1659          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1660            uint8 status;
   1661          
   1662          
   1663            // Initialize control state
   1664            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1665          
   1666            status = osal_nv_item_init( ZCD_NV_LEAVE_CTRL,
   1667                                        sizeof(ZDApp_LeaveCtrl),
   1668                                        &ZDApp_LeaveCtrl );
   1669          
   1670            if ( status == ZSUCCESS )
   \   00000A                ; Setup parameters for call to function osal_nv_item_init
   \   00000A   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   00000D   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000010   78..         MOV     R0,#?V0 + 0
   \   000012   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000015   7C01         MOV     R4,#0x1
   \   000017   7D00         MOV     R5,#0x0
   \   000019   7A85         MOV     R2,#-0x7b
   \   00001B   7B00         MOV     R3,#0x0
   \   00001D   12....       LCALL   ??osal_nv_item_init?relay
   \   000020   7402         MOV     A,#0x2
   \   000022   12....       LCALL   ?DEALLOC_XSTACK8
   \   000025   E9           MOV     A,R1
   \   000026   701C         JNZ     ??ZDApp_LeaveCtrlInit_0
   1671            {
   1672              // Read saved control
   1673              osal_nv_read( ZCD_NV_LEAVE_CTRL,
   1674                            0,
   1675                            sizeof( uint8 ),
   1676                            &ZDApp_LeaveCtrl);
   \   000028                ; Setup parameters for call to function osal_nv_read
   \   000028   78..         MOV     R0,#?V0 + 0
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002D   75..01       MOV     ?V0 + 0,#0x1
   \   000030   75..00       MOV     ?V0 + 1,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000038   7C00         MOV     R4,#0x0
   \   00003A   7D00         MOV     R5,#0x0
   \   00003C   7A85         MOV     R2,#-0x7b
   \   00003E   12....       LCALL   ?Subroutine37 & 0xFFFF
   1677            }
   \                     ??CrossCallReturnLabel_53:
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
   1678          }
   \                     ??ZDApp_LeaveCtrlInit_0:
   \   000044   02....       LJMP    ??Subroutine44_0 & 0xFFFF
   1679          
   1680          /*********************************************************************
   1681           * @fn      ZDApp_LeaveCtrlSet
   1682           *
   1683           * @brief   Set the leave control logic.
   1684           *
   1685           * @param   ra - reassociate flag
   1686           *
   1687           * @return  none
   1688           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   75....       MOV     ?V0 + 0,#ZDApp_LeaveCtrl & 0xff
   \   000003   75....       MOV     ?V0 + 1,#(ZDApp_LeaveCtrl >> 8) & 0xff
   \   000006   78..         MOV     R0,#?V0 + 0
   \   000008   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00000B   75..01       MOV     ?V0 + 0,#0x1
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000016   7C00         MOV     R4,#0x0
   \   000018   7D00         MOV     R5,#0x0
   \   00001A   7A85         MOV     R2,#-0x7b
   \   00001C   7B00         MOV     R3,#0x0
   \   00001E   12....       LCALL   ??osal_nv_write?relay
   \   000021   7404         MOV     A,#0x4
   \   000023                REQUIRE ??Subroutine43_0
   \   000023                ; // Fall through to label ??Subroutine43_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1689          void ZDApp_LeaveCtrlSet( uint8 ra )
   \                     ZDApp_LeaveCtrlSet:
   1690          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   1691            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_SET;
   \   000007   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000A   7401         MOV     A,#0x1
   \   00000C   F0           MOVX    @DPTR,A
   1692          
   1693            if ( ra == TRUE )
   \   00000D   6E           XRL     A,R6
   \   00000E   7003         JNZ     ??ZDApp_LeaveCtrlSet_0
   1694            {
   1695              ZDApp_LeaveCtrl |= ZDAPP_LEAVE_CTRL_RA;
   \   000010   7403         MOV     A,#0x3
   \   000012   F0           MOVX    @DPTR,A
   1696            }
   1697          
   1698            // Write the leave control
   1699            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1700                           0,
   1701                           sizeof( uint8 ),
   1702                           &ZDApp_LeaveCtrl);
   \                     ??ZDApp_LeaveCtrlSet_0:
   \   000013                ; Setup parameters for call to function osal_nv_write
   \   000013   02....       LJMP    ?Subroutine1 & 0xFFFF
   1703          }
   1704          
   1705          /*********************************************************************
   1706           * @fn      ZDApp_LeaveCtrlReset
   1707           *
   1708           * @brief   Re-initialize the leave control logic.
   1709           *
   1710           * @param   none
   1711           *
   1712           * @return  none
   1713           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1714          void ZDApp_LeaveCtrlReset( void )
   \                     ZDApp_LeaveCtrlReset:
   1715          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   1716            // Set leave control to initialized state
   1717            ZDApp_LeaveCtrl = ZDAPP_LEAVE_CTRL_INIT;
   \   000005   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   1718          
   1719            // Write initialized control
   1720            osal_nv_write( ZCD_NV_LEAVE_CTRL,
   1721                          0,
   1722                          sizeof( uint8 ),
   1723                          &ZDApp_LeaveCtrl);
   \   00000A                ; Setup parameters for call to function osal_nv_write
   \   00000A   02....       LJMP    ?Subroutine1 & 0xFFFF
   1724          }
   1725          
   1726          /*********************************************************************
   1727           * @fn      ZDApp_LeaveCtrlBypass
   1728           *
   1729           * @brief   Check if NV restore should be skipped during a leave reset.
   1730           *
   1731           * @param   none
   1732           *
   1733           * @return  uint8 - (TRUE bypass:FALSE do not bypass)
   1734           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1735          uint8 ZDApp_LeaveCtrlBypass( void )
   \                     ZDApp_LeaveCtrlBypass:
   1736          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1737            uint8 bypass;
   1738          
   1739            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   1740            {
   1741              bypass = TRUE;
   1742            }
   1743            else
   1744            {
   1745              bypass = FALSE;
   1746            }
   1747          
   1748            return bypass;
   \   000004   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   000007   E0           MOVX    A,@DPTR
   \   000008   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000A   E4           CLR     A
   \   00000B   33           RLC     A
   \   00000C   F9           MOV     R1,A
   \   00000D   80..         SJMP    ??Subroutine52_0
   1749          }
   1750          
   1751          /*********************************************************************
   1752           * @fn      ZDApp_LeaveCtrlStartup
   1753           *
   1754           * @brief   Check for startup conditions during a leave reset.
   1755           *
   1756           * @param   state      - devState_t determined by leave control logic
   1757           * @param   startDelay - startup delay
   1758           *
   1759           * @return  none
   1760           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1761          void ZDApp_LeaveCtrlStartup( devStates_t* state, uint16* startDelay )
   \                     ZDApp_LeaveCtrlStartup:
   1762          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   1763            *startDelay = 0;
   \   000004   8C82         MOV     DPL,R4
   \   000006   8D83         MOV     DPH,R5
   \   000008   E4           CLR     A
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   F0           MOVX    @DPTR,A
   1764          
   1765            if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_SET )
   \   00000C   90....       MOV     DPTR,#ZDApp_LeaveCtrl
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   A2E0         MOV     C,0xE0 /* A   */.0
   \   000012   5019         JNC     ??ZDApp_LeaveCtrlStartup_0
   1766            {
   1767              if ( ZDApp_LeaveCtrl & ZDAPP_LEAVE_CTRL_RA )
   \   000014   A2E1         MOV     C,0xE0 /* A   */.1
   \   000016   500C         JNC     ??ZDApp_LeaveCtrlStartup_1
   1768              {
   1769                *startDelay = LEAVE_RESET_DELAY;
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   7488         MOV     A,#-0x78
   \   00001E   F0           MOVX    @DPTR,A
   \   00001F   A3           INC     DPTR
   \   000020   7413         MOV     A,#0x13
   \   000022   8005         SJMP    ??ZDApp_LeaveCtrlStartup_2
   1770              }
   1771              else
   1772              {
   1773                *state = DEV_HOLD;
   \                     ??ZDApp_LeaveCtrlStartup_1:
   \   000024   8A82         MOV     DPL,R2
   \   000026   8B83         MOV     DPH,R3
   \   000028   E4           CLR     A
   \                     ??ZDApp_LeaveCtrlStartup_2:
   \   000029   F0           MOVX    @DPTR,A
   1774              }
   1775          
   1776              // Reset leave control logic
   1777              ZDApp_LeaveCtrlReset();
   \   00002A                ; Setup parameters for call to function ZDApp_LeaveCtrlReset
   \   00002A   12....       LCALL   ??ZDApp_LeaveCtrlReset?relay
   1778            }
   1779          }
   \                     ??ZDApp_LeaveCtrlStartup_0:
   \   00002D   80..         SJMP    ??Subroutine52_0
   1780          
   1781          /*********************************************************************
   1782           * @fn      ZDApp_LeaveReset
   1783           *
   1784           * @brief   Setup a device reset due to a leave indication/confirm.
   1785           *
   1786           * @param   ra - reassociate flag
   1787           *
   1788           * @return  none
   1789           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1790          void ZDApp_LeaveReset( uint8 ra )
   \                     ZDApp_LeaveReset:
   1791          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1792            ZDApp_LeaveCtrlSet( ra );
   \   000005                ; Setup parameters for call to function ZDApp_LeaveCtrlSet
   \   000005   12....       LCALL   ??ZDApp_LeaveCtrlSet?relay
   1793          
   1794            ZDApp_ResetTimerStart( LEAVE_RESET_DELAY );
   \   000008                ; Setup parameters for call to function ZDApp_ResetTimerStart
   \   000008   7A88         MOV     R2,#-0x78
   \   00000A   7B13         MOV     R3,#0x13
   \   00000C   12....       LCALL   ??ZDApp_ResetTimerStart?relay
   1795          }
   \   00000F   80..         SJMP    ??Subroutine54_0
   1796          
   1797          /*********************************************************************
   1798           * @fn      ZDApp_LeaveUpdate
   1799           *
   1800           * @brief   Update local device data related to leaving device.
   1801           *
   1802           * @param   nwkAddr        - NWK address of leaving device
   1803           * @param   extAddr        - EXT address of leaving device
   1804           * @param   removeChildren - remove children of leaving device
   1805           *
   1806           * @return  none
   1807           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1808          void ZDApp_LeaveUpdate( uint16 nwkAddr, uint8* extAddr,
   \                     ZDApp_LeaveUpdate:
   1809                                  uint8 removeChildren )
   1810          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
   1811            // Remove Apps Key for leaving device
   1812            ZDSecMgrDeviceRemoveByExtAddr(extAddr);
   \   000012                ; Setup parameters for call to function ZDSecMgrDeviceRemoveByExtAddr
   \   000012   EE           MOV     A,R6
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   FB           MOV     R3,A
   \   000016   12....       LCALL   ??ZDSecMgrDeviceRemoveByExtAddr?relay
   1813          
   1814            // Clear SECURITY bit from Address Manager
   1815            ZDSecMgrAddrClear( extAddr );
   \   000019                ; Setup parameters for call to function ZDSecMgrAddrClear
   \   000019   EE           MOV     A,R6
   \   00001A   FA           MOV     R2,A
   \   00001B   EF           MOV     A,R7
   \   00001C   FB           MOV     R3,A
   \   00001D   12....       LCALL   ??ZDSecMgrAddrClear?relay
   1816          
   1817            if ( pbindRemoveDev )
   \   000020   90....       MOV     DPTR,#pbindRemoveDev
   \   000023   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000026   603C         JZ      ??ZDApp_LeaveUpdate_0
   1818            {
   1819              zAddrType_t devAddr;
   1820          
   1821              // Remove bind entry and all related data
   1822              devAddr.addrMode = Addr64Bit;
   \   000028   7408         MOV     A,#0x8
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   7403         MOV     A,#0x3
   \   00002F   F0           MOVX    @DPTR,A
   1823              osal_memcpy(devAddr.addr.extAddr, extAddr, Z_EXTADDR_LEN);
   \   000030                ; Setup parameters for call to function osal_memcpy
   \   000030   8E..         MOV     ?V0 + 4,R6
   \   000032   8F..         MOV     ?V0 + 5,R7
   \   000034   75..00       MOV     ?V0 + 6,#0x0
   \   000037   78..         MOV     R0,#?V0 + 4
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00003C   7C08         MOV     R4,#0x8
   \   00003E   7D00         MOV     R5,#0x0
   \   000040   7403         MOV     A,#0x3
   \   000042   12....       LCALL   ?XSTACK_DISP0_8
   \   000045   AA82         MOV     R2,DPL
   \   000047   AB83         MOV     R3,DPH
   \   000049   12....       LCALL   ??osal_memcpy?relay
   \   00004C   7403         MOV     A,#0x3
   \   00004E   12....       LCALL   ?DEALLOC_XSTACK8
   1824          
   1825              pbindRemoveDev(&devAddr);
   \   000051                ; Setup parameters for indirect call
   \   000051   85..82       MOV     DPL,?XSP + 0
   \   000054   85..83       MOV     DPH,?XSP + 1
   \   000057   AA82         MOV     R2,DPL
   \   000059   AB83         MOV     R3,DPH
   \   00005B   90....       MOV     DPTR,#pbindRemoveDev
   \   00005E   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   1826            }
   \                     ??CrossCallReturnLabel_103:
   \   000061   12....       LCALL   ?CALL_IND
   1827          
   1828            // Remove if child
   1829            if ( ZSTACK_ROUTER_BUILD )
   1830            {
   1831              NLME_RemoveChild( extAddr, removeChildren );
   1832            }
   1833          
   1834            // Remove Routing table related entry
   1835            RTG_RemoveRtgEntry( nwkAddr, 0 );
   \                     ??ZDApp_LeaveUpdate_0:
   \   000064                ; Setup parameters for call to function RTG_RemoveRtgEntry
   \   000064   7900         MOV     R1,#0x0
   \   000066   AA..         MOV     R2,?V0 + 0
   \   000068   AB..         MOV     R3,?V0 + 1
   \   00006A   12....       LCALL   ??RTG_RemoveRtgEntry?relay
   1836          
   1837            // Remove entry from neighborTable
   1838            nwkNeighborRemove( nwkAddr, _NIB.nwkPanId );
   \   00006D                ; Setup parameters for call to function nwkNeighborRemove
   \   00006D   90....       MOV     DPTR,#_NIB + 33
   \   000070   E0           MOVX    A,@DPTR
   \   000071   FC           MOV     R4,A
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   FD           MOV     R5,A
   \   000075   AA..         MOV     R2,?V0 + 0
   \   000077   AB..         MOV     R3,?V0 + 1
   \   000079   12....       LCALL   ??nwkNeighborRemove?relay
   1839          
   1840            // Schedule to save data to NV
   1841            ZDApp_NwkWriteNVRequest();
   \   00007C                ; Setup parameters for call to function AddrMgrWriteNVRequest
   \   00007C   12....       LCALL   ??AddrMgrWriteNVRequest?relay
   1842          }
   \   00007F   7409         MOV     A,#0x9
   \   000081   12....       LCALL   ?DEALLOC_XSTACK8
   \   000084   7F07         MOV     R7,#0x7
   \   000086   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine59_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003                REQUIRE ??Subroutine60_0
   \   000003                ; // Fall through to label ??Subroutine60_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine60_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F583         MOV     DPH,A
   \   000003   8882         MOV     DPL,R0
   \   000005   22           RET
   1843          
   1844          /*********************************************************************
   1845           * @fn      ZDApp_NetworkDiscoveryReq
   1846           *
   1847           * @brief   Request a network discovery.
   1848           *
   1849           * @param  scanChannels -
   1850           * @param  scanDuration -
   1851           *
   1852           * @return  ZStatus_t
   1853           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1854          ZStatus_t ZDApp_NetworkDiscoveryReq( uint32 scanChannels, uint8 scanDuration)
   \                     ZDApp_NetworkDiscoveryReq:
   1855          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   1856            // Setup optional filters - tbd
   1857          
   1858            // Request NLME network discovery
   1859            return NLME_NetworkDiscoveryRequest(scanChannels, scanDuration);
   \   000005                ; Setup parameters for call to function NLME_NetworkDiscoveryRequest
   \   000005   12....       LCALL   ??NLME_NetworkDiscoveryRequest?relay
   \   000008   02....       LJMP    ??Subroutine47_0 & 0xFFFF
   1860          }
   1861          
   1862          /*********************************************************************
   1863           * @fn      ZDApp_JoinReq
   1864           *
   1865           * @brief   Request the device to join a parent in a network.
   1866           *
   1867           * @param   channel -
   1868           * @param   panID -
   1869           *
   1870           * @return  ZStatus_t
   1871           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1872          ZStatus_t ZDApp_JoinReq( uint8 channel, uint16 panID, uint8 *extendedPanID,
   \                     ZDApp_JoinReq:
   1873                                   uint16 chosenParent, uint8 parentDepth, uint8 stackProfile )
   1874          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 4,R1
   \   000007   8A..         MOV     ?V0 + 0,R2
   \   000009   8B..         MOV     ?V0 + 1,R3
   \   00000B   EC           MOV     A,R4
   \   00000C   FE           MOV     R6,A
   \   00000D   ED           MOV     A,R5
   \   00000E   FF           MOV     R7,A
   \   00000F   740E         MOV     A,#0xe
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 2,A
   \   000017   A3           INC     DPTR
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F5..         MOV     ?V0 + 3,A
   \   00001B   7410         MOV     A,#0x10
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 5,A
   \   000023   7411         MOV     A,#0x11
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F9           MOV     R1,A
   1875            // Sync up the node with the stack profile (In the case where a pro device
   1876            // joins a non-pro network, or verse versa)
   1877            ZDApp_NodeProfileSync( stackProfile);
   \   00002A                ; Setup parameters for call to function ZDApp_NodeProfileSync
   \   00002A   12....       LCALL   ??ZDApp_NodeProfileSync?relay
   1878          
   1879            // Request NLME Join Request
   1880            return NLME_JoinRequest(extendedPanID, panID,channel,
   1881                                    ZDO_Config_Node_Descriptor.CapabilityFlags,
   1882                                    chosenParent, parentDepth);
   \   00002D                ; Setup parameters for call to function NLME_JoinRequest
   \   00002D   78..         MOV     R0,#?V0 + 5
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000032   78..         MOV     R0,#?V0 + 2
   \   000034   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000037   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   F5..         MOV     ?V0 + 2,A
   \   00003D   78..         MOV     R0,#?V0 + 2
   \   00003F   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000042   A9..         MOV     R1,?V0 + 4
   \   000044   AC..         MOV     R4,?V0 + 0
   \   000046   AD..         MOV     R5,?V0 + 1
   \   000048   EE           MOV     A,R6
   \   000049   FA           MOV     R2,A
   \   00004A   EF           MOV     A,R7
   \   00004B   FB           MOV     R3,A
   \   00004C   12....       LCALL   ??NLME_JoinRequest?relay
   \   00004F   7404         MOV     A,#0x4
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054                REQUIRE ?Subroutine4
   \   000054                ; // Fall through to label ?Subroutine4
   1883          
   1884          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
   1885          
   1886          /*********************************************************************
   1887           * @fn      ZDApp_DeviceConfigured
   1888           *
   1889           * @brief   Check to see if the local device is configured (i.e., part
   1890           *          of a network).
   1891           *
   1892           * @param   none
   1893           *
   1894           * @return  TRUE if configured. FALSE, otherwise.
   1895           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1896          uint8 ZDApp_DeviceConfigured( void )
   \                     ZDApp_DeviceConfigured:
   1897          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   1898            uint16 nwkAddr = INVALID_NODE_ADDR;
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   74FE         MOV     A,#-0x2
   \   000012   F0           MOVX    @DPTR,A
   \   000013   A3           INC     DPTR
   \   000014   04           INC     A
   \   000015   F0           MOVX    @DPTR,A
   1899          
   1900            osal_nv_read( ZCD_NV_NIB, osal_offsetof( nwkIB_t, nwkDevAddress ),
   1901                          sizeof( uint16), &nwkAddr );
   \   000016                ; Setup parameters for call to function osal_nv_read
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   8582..       MOV     ?V0 + 0,DPL
   \   00001F   8583..       MOV     ?V0 + 1,DPH
   \   000022   78..         MOV     R0,#?V0 + 0
   \   000024   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000027   75..02       MOV     ?V0 + 0,#0x2
   \   00002A   75..00       MOV     ?V0 + 1,#0x0
   \   00002D   78..         MOV     R0,#?V0 + 0
   \   00002F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000032   7C14         MOV     R4,#0x14
   \   000034   7D00         MOV     R5,#0x0
   \   000036   7A21         MOV     R2,#0x21
   \   000038   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
   1902          
   1903            // Does the NIB have anything more than default?
   1904            return ( nwkAddr == INVALID_NODE_ADDR ? FALSE : TRUE );
   \   00003E   85..82       MOV     DPL,?XSP + 0
   \   000041   85..83       MOV     DPH,?XSP + 1
   \   000044   E0           MOVX    A,@DPTR
   \   000045   64FE         XRL     A,#0xfe
   \   000047   7003         JNZ     ??ZDApp_DeviceConfigured_0
   \   000049   A3           INC     DPTR
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   F4           CPL     A
   \                     ??ZDApp_DeviceConfigured_0:
   \   00004C   7004         JNZ     ??ZDApp_DeviceConfigured_1
   \   00004E   7900         MOV     R1,#0x0
   \   000050   8002         SJMP    ??ZDApp_DeviceConfigured_2
   \                     ??ZDApp_DeviceConfigured_1:
   \   000052   7901         MOV     R1,#0x1
   \                     ??ZDApp_DeviceConfigured_2:
   \   000054   02....       LJMP    ?Subroutine7 & 0xFFFF
   1905          }
   1906          
   1907          /*********************************************************************
   1908           * CALLBACK FUNCTIONS
   1909           */
   1910          
   1911          
   1912          /*********************************************************************
   1913           * @fn      ZDApp_SendEventMsg()
   1914           *
   1915           * @brief
   1916           *
   1917           *   Sends a Network Join message
   1918           *
   1919           * @param  cmd - command ID
   1920           * @param  len - length (in bytes) of the buf field
   1921           * @param  buf - buffer for the rest of the message.
   1922           *
   1923           * @return  none
   1924           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1925          void ZDApp_SendEventMsg( uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendEventMsg:
   1926          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   1927            ZDApp_SendMsg( ZDAppTaskID, cmd, len, buf );
   \   000008                ; Setup parameters for call to function ZDApp_SendMsg
   \   000008   FB           MOV     R3,A
   \   000009   EE           MOV     A,R6
   \   00000A   FA           MOV     R2,A
   \   00000B   12....       LCALL   ?Subroutine23 & 0xFFFF
   1928          }
   \                     ??CrossCallReturnLabel_24:
   \   00000E   02....       LJMP    ??Subroutine54_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   90....       MOV     DPTR,#ZDAppTaskID
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_SendMsg?relay
   \   000008   22           RET
   1929          
   1930          /*********************************************************************
   1931           * @fn      ZDApp_SendMsg()
   1932           *
   1933           * @brief   Sends a OSAL message
   1934           *
   1935           * @param  taskID - Where to send the message
   1936           * @param  cmd - command ID
   1937           * @param  len - length (in bytes) of the buf field
   1938           * @param  buf - buffer for the rest of the message.
   1939           *
   1940           * @return  none
   1941           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1942          void ZDApp_SendMsg( uint8 taskID, uint8 cmd, uint8 len, uint8 *buf )
   \                     ZDApp_SendMsg:
   1943          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 3,R1
   \   000007   8A..         MOV     ?V0 + 4,R2
   \   000009   8B..         MOV     ?V0 + 5,R3
   \   00000B   8C..         MOV     ?V0 + 0,R4
   \   00000D   8D..         MOV     ?V0 + 1,R5
   1944            osal_event_hdr_t *msgPtr;
   1945          
   1946            // Send the address to the task
   1947            msgPtr = (osal_event_hdr_t *)osal_msg_allocate( len );
   \   00000F                ; Setup parameters for call to function osal_msg_allocate
   \   00000F   8B..         MOV     ?V0 + 6,R3
   \   000011   AA..         MOV     R2,?V0 + 6
   \   000013   7B00         MOV     R3,#0x0
   \   000015   12....       LCALL   ??osal_msg_allocate?relay
   \   000018   8A..         MOV     ?V0 + 6,R2
   \   00001A   8B..         MOV     ?V0 + 7,R3
   \   00001C   AE..         MOV     R6,?V0 + 6
   \   00001E   AF..         MOV     R7,?V0 + 7
   1948            if ( msgPtr )
   \   000020   EE           MOV     A,R6
   \   000021   4F           ORL     A,R7
   \   000022   6031         JZ      ??ZDApp_SendMsg_0
   1949            {
   1950              if ( (len > 0) && (buf != NULL) )
   \   000024   E5..         MOV     A,?V0 + 5
   \   000026   601D         JZ      ??ZDApp_SendMsg_1
   \   000028   E5..         MOV     A,?V0 + 0
   \   00002A   45..         ORL     A,?V0 + 1
   \   00002C   6017         JZ      ??ZDApp_SendMsg_1
   1951                osal_memcpy( msgPtr, buf, len );
   \   00002E                ; Setup parameters for call to function osal_memcpy
   \   00002E   75..00       MOV     ?V0 + 2,#0x0
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000036   85....       MOV     ?V0 + 0,?V0 + 5
   \   000039   AC..         MOV     R4,?V0 + 0
   \   00003B   7D00         MOV     R5,#0x0
   \   00003D   12....       LCALL   ??osal_memcpy?relay
   \   000040   7403         MOV     A,#0x3
   \   000042   12....       LCALL   ?DEALLOC_XSTACK8
   1952          
   1953              msgPtr->event = cmd;
   \                     ??ZDApp_SendMsg_1:
   \   000045   8E82         MOV     DPL,R6
   \   000047   8F83         MOV     DPH,R7
   \   000049   E5..         MOV     A,?V0 + 4
   \   00004B   F0           MOVX    @DPTR,A
   1954              osal_msg_send( taskID, (uint8 *)msgPtr );
   \   00004C                ; Setup parameters for call to function osal_msg_send
   \   00004C   EE           MOV     A,R6
   \   00004D   FA           MOV     R2,A
   \   00004E   EF           MOV     A,R7
   \   00004F   FB           MOV     R3,A
   \   000050   A9..         MOV     R1,?V0 + 3
   \   000052   12....       LCALL   ??osal_msg_send?relay
   1955            }
   1956          }
   \                     ??ZDApp_SendMsg_0:
   \   000055   7F08         MOV     R7,#0x8
   \   000057   02....       LJMP    ?BANKED_LEAVE_XDATA
   1957          
   1958          /*********************************************************************
   1959           * Call Back Functions from NWK  - API
   1960           */
   1961          
   1962          /*********************************************************************
   1963           * @fn          ZDO_NetworkDiscoveryConfirmCB
   1964           *
   1965           * @brief       This function returns a choice of PAN to join.
   1966           *
   1967           * @param       status - return status of the nwk discovery confirm
   1968           *
   1969           * @return      ZStatus_t
   1970           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1971          ZStatus_t ZDO_NetworkDiscoveryConfirmCB(uint8 status)
   \                     ZDO_NetworkDiscoveryConfirmCB:
   1972          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 3
   \   000004   74FD         MOV     A,#-0x3
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
   \   000009   E9           MOV     A,R1
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   F0           MOVX    @DPTR,A
   1973            osal_event_hdr_t msg;
   1974          
   1975            // If Scan is initiated by ZDO_MGMT_NWK_DISC_REQ
   1976            // Send ZDO_MGMT_NWK_DISC_RSP back
   1977          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1978            if ( zdappMgmtNwkDiscReqInProgress )
   1979            {
   1980              zdappMgmtNwkDiscReqInProgress = false;
   1981              ZDO_FinishProcessingMgmtNwkDiscReq();
   1982            }
   1983            else
   1984          #endif
   1985            {
   1986              // Pass the confirm to another task if it registers the callback
   1987              // Otherwise, pass the confirm to ZDApp.
   1988              if (zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID] != NULL )
   \   000011   90....       MOV     DPTR,#zdoCBFunc + 4
   \   000014   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000017   6015         JZ      ??ZDO_NetworkDiscoveryConfirmCB_0
   1989              {
   1990                zdoCBFunc[ZDO_NWK_DISCOVERY_CNF_CBID]( (void*)&status );
   \   000019                ; Setup parameters for indirect call
   \   000019   85..82       MOV     DPL,?XSP + 0
   \   00001C   85..83       MOV     DPH,?XSP + 1
   \   00001F   AA82         MOV     R2,DPL
   \   000021   AB83         MOV     R3,DPH
   \   000023   90....       MOV     DPTR,#zdoCBFunc + 5
   \   000026   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   1991              }
   \                     ??CrossCallReturnLabel_97:
   \   000029   12....       LCALL   ?CALL_IND
   \   00002C   8016         SJMP    ??CrossCallReturnLabel_25
   1992              else
   1993              {
   1994                // Otherwise, send scan confirm to ZDApp task to proceed
   1995                msg.status = ZDO_SUCCESS;
   \                     ??ZDO_NetworkDiscoveryConfirmCB_0:
   \   00002E   7402         MOV     A,#0x2
   \   000030   12....       LCALL   ?XSTACK_DISP0_8
   \   000033   E4           CLR     A
   \   000034   F0           MOVX    @DPTR,A
   1996                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_DISC_CNF, sizeof(osal_event_hdr_t), (uint8 *)&msg );
   \   000035                ; Setup parameters for call to function ZDApp_SendMsg
   \   000035   04           INC     A
   \   000036   12....       LCALL   ?XSTACK_DISP0_8
   \   000039   AC82         MOV     R4,DPL
   \   00003B   AD83         MOV     R5,DPH
   \   00003D   7B02         MOV     R3,#0x2
   \   00003F   7A01         MOV     R2,#0x1
   \   000041   12....       LCALL   ?Subroutine23 & 0xFFFF
   1997              }
   1998            }
   1999            return (ZSuccess);
   \                     ??CrossCallReturnLabel_25:
   \   000044   7900         MOV     R1,#0x0
   \   000046   7403         MOV     A,#0x3
   \   000048   12....       LCALL   ?DEALLOC_XSTACK8
   \   00004B   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2000          }  // ZDO_NetworkDiscoveryConfirmCB
   2001          
   2002          /*********************************************************************
   2003           * @fn          ZDApp_NwkDescListProcessing
   2004           *
   2005           * @brief       This function process the network discovery result and select
   2006           *              a parent device to join itself.
   2007           *
   2008           * @param       none
   2009           *
   2010           * @return      ZStatus_t
   2011           */
   2012          #define STACK_PROFILE_MAX 2

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2013          networkDesc_t* ZDApp_NwkDescListProcessing(void)
   \                     ZDApp_NwkDescListProcessing:
   2014          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   2015            networkDesc_t *pNwkDesc;
   2016            uint8 i, ResultCount = 0;
   \   000005   75..00       MOV     ?V0 + 0,#0x0
   2017            uint8 stackProfile;
   2018            uint8 stackProfilePro;
   2019            uint8 selected;
   2020          
   2021            // Count the number of nwk descriptors in the list
   2022            pNwkDesc = nwk_getNwkDescList();
   \   000008                ; Setup parameters for call to function nwk_getNwkDescList
   \   000008   12....       LCALL   ??nwk_getNwkDescList?relay
   \   00000B   8A..         MOV     ?V0 + 2,R2
   \   00000D   8B..         MOV     ?V0 + 3,R3
   \   00000F   AE..         MOV     R6,?V0 + 2
   \   000011   AF..         MOV     R7,?V0 + 3
   \   000013   8005         SJMP    ??CrossCallReturnLabel_94
   2023            while (pNwkDesc)
   2024            {
   2025              ResultCount++;
   \                     ??ZDApp_NwkDescListProcessing_0:
   \   000015   05..         INC     ?V0 + 0
   2026              pNwkDesc = pNwkDesc->nextDesc;
   \   000017   12....       LCALL   ?Subroutine21 & 0xFFFF
   2027            }
   \                     ??CrossCallReturnLabel_94:
   \   00001A   EE           MOV     A,R6
   \   00001B   4F           ORL     A,R7
   \   00001C   70F7         JNZ     ??ZDApp_NwkDescListProcessing_0
   2028          
   2029            // process discovery results
   2030            stackProfilePro = FALSE;
   \   00001E   75..00       MOV     ?V0 + 3,#0x0
   2031            selected = FALSE;
   2032          
   2033          
   2034            for ( stackProfile = 0; stackProfile < STACK_PROFILE_MAX; stackProfile++ )
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   2035            {
   2036              pNwkDesc = nwk_getNwkDescList();
   \                     ??ZDApp_NwkDescListProcessing_1:
   \   000024                ; Setup parameters for call to function nwk_getNwkDescList
   \   000024   12....       LCALL   ??nwk_getNwkDescList?relay
   \   000027   8A..         MOV     ?V0 + 4,R2
   \   000029   8B..         MOV     ?V0 + 5,R3
   \   00002B   AE..         MOV     R6,?V0 + 4
   \   00002D   AF..         MOV     R7,?V0 + 5
   2037              for ( i = 0; i < ResultCount; i++, pNwkDesc = pNwkDesc->nextDesc )
   \   00002F   75..00       MOV     ?V0 + 2,#0x0
   \   000032   8023         SJMP    ??CrossCallReturnLabel_95
   2038              {
   2039                if ( zgConfigPANID != 0xFFFF )
   2040                {
   2041                  // PAN Id is preconfigured. check if it matches
   2042                  if ( pNwkDesc->panId != zgConfigPANID )
   2043                    continue;
   2044                }
   2045          
   2046                if ( nwk_ExtPANIDValid( ZDO_UseExtendedPANID) == true )
   2047                {
   2048                  // If the extended Pan ID is commissioned to a non zero value
   2049                  // Only join the Pan that has match EPID
   2050                  if ( osal_ExtAddrEqual( ZDO_UseExtendedPANID, pNwkDesc->extendedPANID) == false )
   2051                    continue;
   2052          
   2053                }
   2054          
   2055                // check that network is allowing joining
   2056                if ( ZSTACK_ROUTER_BUILD )
   2057                {
   2058                  if ( stackProfilePro == FALSE )
   2059                  {
   2060                    if ( !pNwkDesc->routerCapacity )
   2061                    {
   2062                      continue;
   2063                    }
   2064                  }
   2065                  else
   2066                  {
   2067                    if ( !pNwkDesc->deviceCapacity )
   2068                    {
   2069                      continue;
   2070                    }
   2071                  }
   2072                }
   2073                else if ( ZSTACK_END_DEVICE_BUILD )
   2074                {
   2075                  if ( !pNwkDesc->deviceCapacity )
   2076                  {
   2077                    continue;
   2078                  }
   2079                }
   2080          
   2081                // check version of zigbee protocol
   2082                if ( pNwkDesc->version != _NIB.nwkProtocolVersion )
   2083                  continue;
   2084          
   2085                // check version of stack profile
   2086                if ( pNwkDesc->stackProfile != zgStackProfile  )
   2087                {
   2088                  if ( ((zgStackProfile == HOME_CONTROLS) && (pNwkDesc->stackProfile == ZIGBEEPRO_PROFILE))
   2089                      || ((zgStackProfile == ZIGBEEPRO_PROFILE) && (pNwkDesc->stackProfile == HOME_CONTROLS))  )
   \                     ??ZDApp_NwkDescListProcessing_2:
   \   000034   E0           MOVX    A,@DPTR
   \   000035   6402         XRL     A,#0x2
   \   000037   7012         JNZ     ??ZDApp_NwkDescListProcessing_3
   \   000039   8E82         MOV     DPL,R6
   \   00003B   8F83         MOV     DPH,R7
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   6401         XRL     A,#0x1
   \   000046   7003         JNZ     ??ZDApp_NwkDescListProcessing_3
   2090                  {
   2091                    stackProfilePro = TRUE;
   \                     ??ZDApp_NwkDescListProcessing_4:
   \   000048   75..01       MOV     ?V0 + 3,#0x1
   2092                  }
   2093          
   2094                  if ( stackProfile == 0 )
   \                     ??ZDApp_NwkDescListProcessing_3:
   \   00004B   E5..         MOV     A,?V0 + 1
   \   00004D   6003         JZ      $+5
   \   00004F   02....       LJMP    ??ZDApp_NwkDescListProcessing_5 & 0xFFFF
   \                     ??ZDApp_NwkDescListProcessing_6:
   \   000052   05..         INC     ?V0 + 2
   \   000054   12....       LCALL   ?Subroutine21 & 0xFFFF
   \                     ??CrossCallReturnLabel_95:
   \   000057   E5..         MOV     A,?V0 + 2
   \   000059   C3           CLR     C
   \   00005A   95..         SUBB    A,?V0 + 0
   \   00005C   4003         JC      $+5
   \   00005E   02....       LJMP    ??ZDApp_NwkDescListProcessing_7 & 0xFFFF
   \   000061   90....       MOV     DPTR,#zgConfigPANID
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F4           CPL     A
   \   000066   7003         JNZ     ??ZDApp_NwkDescListProcessing_8
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F4           CPL     A
   \                     ??ZDApp_NwkDescListProcessing_8:
   \   00006B   600F         JZ      ??ZDApp_NwkDescListProcessing_9
   \   00006D   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_82:
   \   000070   90....       MOV     DPTR,#zgConfigPANID
   \   000073   E0           MOVX    A,@DPTR
   \   000074   68           XRL     A,R0
   \   000075   7003         JNZ     ??ZDApp_NwkDescListProcessing_10
   \   000077   A3           INC     DPTR
   \   000078   E0           MOVX    A,@DPTR
   \   000079   69           XRL     A,R1
   \                     ??ZDApp_NwkDescListProcessing_10:
   \   00007A   70D6         JNZ     ??ZDApp_NwkDescListProcessing_6
   \                     ??ZDApp_NwkDescListProcessing_9:
   \   00007C                ; Setup parameters for call to function nwk_ExtPANIDValid
   \   00007C   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   00007E   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000080   12....       LCALL   ??nwk_ExtPANIDValid?relay
   \   000083   E9           MOV     A,R1
   \   000084   6401         XRL     A,#0x1
   \   000086   7012         JNZ     ??ZDApp_NwkDescListProcessing_11
   \   000088                ; Setup parameters for call to function sAddrExtCmp
   \   000088   EE           MOV     A,R6
   \   000089   240B         ADD     A,#0xb
   \   00008B   FC           MOV     R4,A
   \   00008C   EF           MOV     A,R7
   \   00008D   3400         ADDC    A,#0x0
   \   00008F   FD           MOV     R5,A
   \   000090   7A..         MOV     R2,#ZDO_UseExtendedPANID & 0xff
   \   000092   7B..         MOV     R3,#(ZDO_UseExtendedPANID >> 8) & 0xff
   \   000094   12....       LCALL   ??sAddrExtCmp?relay
   \   000097   E9           MOV     A,R1
   \   000098   60B8         JZ      ??ZDApp_NwkDescListProcessing_6
   \                     ??ZDApp_NwkDescListProcessing_11:
   \   00009A   8E82         MOV     DPL,R6
   \   00009C   8F83         MOV     DPH,R7
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   E0           MOVX    A,@DPTR
   \   0000A3   60AD         JZ      ??ZDApp_NwkDescListProcessing_6
   \   0000A5   8E82         MOV     DPL,R6
   \   0000A7   8F83         MOV     DPH,R7
   \   0000A9   A3           INC     DPTR
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   A3           INC     DPTR
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   F8           MOV     R0,A
   \   0000B0   90....       MOV     DPTR,#_NIB + 17
   \   0000B3   E0           MOVX    A,@DPTR
   \   0000B4   68           XRL     A,R0
   \   0000B5   709B         JNZ     ??ZDApp_NwkDescListProcessing_6
   \   0000B7   8E82         MOV     DPL,R6
   \   0000B9   8F83         MOV     DPH,R7
   \   0000BB   A3           INC     DPTR
   \   0000BC   A3           INC     DPTR
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   A3           INC     DPTR
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   F8           MOV     R0,A
   \   0000C3   90....       MOV     DPTR,#zgStackProfile
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   68           XRL     A,R0
   \   0000C8   6039         JZ      ??ZDApp_NwkDescListProcessing_5
   \   0000CA   E0           MOVX    A,@DPTR
   \   0000CB   6401         XRL     A,#0x1
   \   0000CD   6003         JZ      $+5
   \   0000CF   02....       LJMP    ??ZDApp_NwkDescListProcessing_2 & 0xFFFF
   \   0000D2   8E82         MOV     DPL,R6
   \   0000D4   8F83         MOV     DPH,R7
   \   0000D6   A3           INC     DPTR
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   A3           INC     DPTR
   \   0000DB   A3           INC     DPTR
   \   0000DC   E0           MOVX    A,@DPTR
   \   0000DD   6402         XRL     A,#0x2
   \   0000DF   6003         JZ      $+5
   \   0000E1   02....       LJMP    ??ZDApp_NwkDescListProcessing_3 & 0xFFFF
   \   0000E4   02....       LJMP    ??ZDApp_NwkDescListProcessing_4 & 0xFFFF
   2095                  {
   2096                    continue;
   2097                  }
   2098                }
   2099          
   2100                break;
   2101              }
   2102          
   2103              if (i < ResultCount)
   2104              {
   2105               selected = TRUE;
   2106                break;
   2107              }
   2108          
   2109              // break if selected or stack profile pro wasn't found
   2110              if ( (selected == TRUE) || (stackProfilePro == FALSE) )
   \                     ??ZDApp_NwkDescListProcessing_7:
   \   0000E7   E5..         MOV     A,?V0 + 3
   \   0000E9   600C         JZ      ??ZDApp_NwkDescListProcessing_12
   2111              {
   2112                break;
   2113              }
   2114            }
   \   0000EB   05..         INC     ?V0 + 1
   \   0000ED   E5..         MOV     A,?V0 + 1
   \   0000EF   C3           CLR     C
   \   0000F0   9402         SUBB    A,#0x2
   \   0000F2   5003         JNC     $+5
   \   0000F4   02....       LJMP    ??ZDApp_NwkDescListProcessing_1 & 0xFFFF
   2115          
   2116            if ( i == ResultCount )
   \                     ??ZDApp_NwkDescListProcessing_12:
   \   0000F7   E5..         MOV     A,?V0 + 0
   \   0000F9   65..         XRL     A,?V0 + 2
   \   0000FB   7006         JNZ     ??ZDApp_NwkDescListProcessing_5
   2117            {
   2118              return (NULL);   // couldn't find appropriate PAN to join !
   \   0000FD   7A00         MOV     R2,#0x0
   \   0000FF   7B00         MOV     R3,#0x0
   \   000101   8004         SJMP    ??ZDApp_NwkDescListProcessing_13
   2119            }
   2120            else
   2121            {
   2122              return (pNwkDesc);
   \                     ??ZDApp_NwkDescListProcessing_5:
   \   000103   EE           MOV     A,R6
   \   000104   FA           MOV     R2,A
   \   000105   EF           MOV     A,R7
   \   000106   FB           MOV     R3,A
   2123            }
   \                     ??ZDApp_NwkDescListProcessing_13:
   \   000107   02....       LJMP    ?Subroutine4 & 0xFFFF
   2124          }// ZDApp_NwkDescListProcessing()

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   EE           MOV     A,R6
   \   000001   2414         ADD     A,#0x14
   \   000003   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_120:
   \   000006                REQUIRE ??Subroutine55_0
   \   000006                ; // Fall through to label ??Subroutine55_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine55_0:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FE           MOV     R6,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FF           MOV     R7,A
   \   000005   22           RET
   2125          
   2126          /*********************************************************************
   2127           * @fn          ZDO_NetworkFormationConfirmCB
   2128           *
   2129           * @brief       This function reports the results of the request to
   2130           *              initialize a coordinator in a network.
   2131           *
   2132           * @param       Status - Result of NLME_NetworkFormationRequest()
   2133           *
   2134           * @return      none
   2135           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   000003                REQUIRE ??Subroutine54_0
   \   000003                ; // Fall through to label ??Subroutine54_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2136          void ZDO_NetworkFormationConfirmCB( ZStatus_t Status )
   \                     ZDO_NetworkFormationConfirmCB:
   2137          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2138            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2139          
   2140            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_NetworkFormationConfirmCB_0
   2141            {
   2142              // LED on shows Coordinator started
   2143              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine28 & 0xFFFF
   2144          
   2145              // LED off forgets HOLD_AUTO_START
   2146              HalLedSet (HAL_LED_4, HAL_LED_MODE_OFF);
   2147          
   2148          #if defined ( ZBIT )
   2149              SIM_SetColor(0xd0ffd0);
   2150          #endif
   2151          
   2152              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_36:
   \   00000F   700C         JNZ     ??ZDO_NetworkFormationConfirmCB_1
   2153              {
   2154                // Began with HOLD_AUTO_START
   2155                devState = DEV_COORD_STARTING;
   \   000011   7408         MOV     A,#0x8
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_NetworkFormationConfirmCB_1
   2156              }
   2157            }
   2158          #if defined(BLINK_LEDS)
   2159            else
   2160            {
   2161              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_NetworkFormationConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2162            }
   2163          #endif
   2164          
   2165            osal_set_event( ZDAppTaskID, ZDO_NETWORK_START );
   \                     ??ZDO_NetworkFormationConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A02         MOV     R2,#0x2
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2166          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   7A01         MOV     R2,#0x1
   \   000002   7904         MOV     R1,#0x4
   \   000004   12....       LCALL   ??HalLedSet?relay
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007                ; Setup parameters for call to function HalLedSet
   \   000007   7A00         MOV     R2,#0x0
   \   000009   7908         MOV     R1,#0x8
   \   00000B   12....       LCALL   ??HalLedSet?relay
   \   00000E   90....       MOV     DPTR,#devState
   \   000011   E0           MOVX    A,@DPTR
   \   000012   22           RET
   2167          
   2168          /****************************************************************************
   2169           * @fn          ZDApp_beaconIndProcessing
   2170           *
   2171           * @brief       This function processes the incoming beacon indication.
   2172           *
   2173           *              When another task (MT or App) is registered to process
   2174           *              beacon indication themselves, this function will parse the
   2175           *              beacon payload and pass the beacon descriptor to that task
   2176           *              If no other tasks registered, this function will process
   2177           *              the beacon payload and generate the network descriptor link
   2178           *              list.
   2179           *
   2180           * @param
   2181           *
   2182           * @return      none
   2183           *
   2184           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2185          void ZDO_beaconNotifyIndCB( NLME_beaconInd_t *pBeacon )
   \                     ZDO_beaconNotifyIndCB:
   2186          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2187            // Pass the beacon Indication to another task if it registers the callback
   2188            // Otherwise, process the beacon notification here.
   2189            if (zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID] != NULL )
   \   000009   90....       MOV     DPTR,#zdoCBFunc + 6
   \   00000C   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00000F   6009         JZ      ??ZDO_beaconNotifyIndCB_0
   2190            {
   2191              zdoCBFunc[ZDO_BEACON_NOTIFY_IND_CBID]( (void*)pBeacon );
   \   000011                ; Setup parameters for indirect call
   \   000011   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   2192            }
   \                     ??CrossCallReturnLabel_98:
   \   000014   12....       LCALL   ?CALL_IND
   \   000017   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2193            else
   2194            {
   2195              networkDesc_t *pNwkDesc;
   2196              networkDesc_t *pLastNwkDesc;
   2197              uint8 found = false;
   2198          
   2199              // Add the network to the Network Descriptor List
   2200              pNwkDesc = NwkDescList;
   \                     ??ZDO_beaconNotifyIndCB_0:
   \   00001A   90....       MOV     DPTR,#NwkDescList
   \   00001D   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   2201              pLastNwkDesc = NwkDescList;
   \                     ??CrossCallReturnLabel_92:
   \   000020   90....       MOV     DPTR,#NwkDescList
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F5..         MOV     ?V0 + 2,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 3,A
   \   00002A   802D         SJMP    ??CrossCallReturnLabel_96
   2202              while (pNwkDesc)
   2203              {
   2204                if ((pNwkDesc->panId == pBeacon->panID) &&
   2205                    (pNwkDesc->logicalChannel == pBeacon->logicalChannel))
   \                     ??ZDO_beaconNotifyIndCB_2:
   \   00002C   12....       LCALL   ?Subroutine18 & 0xFFFF
   \                     ??CrossCallReturnLabel_83:
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   68           XRL     A,R0
   \   000037   7003         JNZ     ??ZDO_beaconNotifyIndCB_3
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   69           XRL     A,R1
   \                     ??ZDO_beaconNotifyIndCB_3:
   \   00003C   7014         JNZ     ??ZDO_beaconNotifyIndCB_4
   \   00003E   8E82         MOV     DPL,R6
   \   000040   8F83         MOV     DPH,R7
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F8           MOV     R0,A
   \   000046   8A82         MOV     DPL,R2
   \   000048   8B83         MOV     DPH,R3
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   68           XRL     A,R0
   \   000050   605F         JZ      ??ZDO_beaconNotifyIndCB_5
   2206                {
   2207                  found = true;
   2208                  break;
   2209                }
   2210                pLastNwkDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_4:
   \   000052   8E..         MOV     ?V0 + 2,R6
   \   000054   8F..         MOV     ?V0 + 3,R7
   2211                pNwkDesc = pNwkDesc->nextDesc;
   \   000056   12....       LCALL   ?Subroutine21 & 0xFFFF
   2212              }
   \                     ??CrossCallReturnLabel_96:
   \   000059   EE           MOV     A,R6
   \   00005A   4F           ORL     A,R7
   \   00005B   70CF         JNZ     ??ZDO_beaconNotifyIndCB_2
   2213          
   2214              // If no existing descriptor found, make a new one and add to the list
   2215              if (found == false)
   2216              {
   2217                pNwkDesc = osal_mem_alloc( sizeof(networkDesc_t)  );
   \   00005D                ; Setup parameters for call to function osal_mem_alloc
   \   00005D   7A16         MOV     R2,#0x16
   \   00005F   7B00         MOV     R3,#0x0
   \   000061   12....       LCALL   ??osal_mem_alloc?relay
   \   000064   8A..         MOV     ?V0 + 4,R2
   \   000066   8B..         MOV     ?V0 + 5,R3
   \   000068   AE..         MOV     R6,?V0 + 4
   \   00006A   AF..         MOV     R7,?V0 + 5
   2218                if ( !pNwkDesc )
   \   00006C   EE           MOV     A,R6
   \   00006D   4F           ORL     A,R7
   \   00006E   7003         JNZ     $+5
   \   000070   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2219                {
   2220                  // Memory alloc failed, discard this beacon
   2221                  return;
   2222                }
   2223          
   2224                // Clear the network descriptor
   2225                osal_memset( pNwkDesc, 0, sizeof(networkDesc_t)  );
   \   000073                ; Setup parameters for call to function osal_memset
   \   000073   7C16         MOV     R4,#0x16
   \   000075   7D00         MOV     R5,#0x0
   \   000077   7900         MOV     R1,#0x0
   \   000079   12....       LCALL   ??osal_memset?relay
   2226          
   2227                // Initialize the descriptor
   2228                pNwkDesc->chosenRouter = INVALID_NODE_ADDR;
   \   00007C   8E82         MOV     DPL,R6
   \   00007E   8F83         MOV     DPH,R7
   \   000080   A3           INC     DPTR
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   74FE         MOV     A,#-0x2
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   A3           INC     DPTR
   \   00008B   04           INC     A
   \   00008C   12....       LCALL   ?Subroutine11 & 0xFFFF
   2229                pNwkDesc->chosenRouterDepth = 0xFF;
   \                     ??CrossCallReturnLabel_5:
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   F0           MOVX    @DPTR,A
   2230          
   2231                // Save new entry into the descriptor list
   2232                if ( !NwkDescList )
   \   000094   90....       MOV     DPTR,#NwkDescList
   \   000097   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   00009A   7005         JNZ     ??ZDO_beaconNotifyIndCB_6
   2233                {
   2234                  NwkDescList = pNwkDesc;
   \   00009C   90....       MOV     DPTR,#NwkDescList
   \   00009F   800B         SJMP    ??CrossCallReturnLabel_117
   2235                }
   2236                else
   2237                {
   2238                  pLastNwkDesc->nextDesc = pNwkDesc;
   \                     ??ZDO_beaconNotifyIndCB_6:
   \   0000A1   E5..         MOV     A,?V0 + 2
   \   0000A3   2414         ADD     A,#0x14
   \   0000A5   F582         MOV     DPL,A
   \   0000A7   E5..         MOV     A,?V0 + 3
   \   0000A9   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   2239                }
   2240              }
   \                     ??CrossCallReturnLabel_117:
   \   0000AC   EE           MOV     A,R6
   \   0000AD   F0           MOVX    @DPTR,A
   \   0000AE   A3           INC     DPTR
   \   0000AF   EF           MOV     A,R7
   \   0000B0   F0           MOVX    @DPTR,A
   2241          
   2242              // Update the descriptor with the incoming beacon
   2243              pNwkDesc->stackProfile   = pBeacon->stackProfile;
   \                     ??ZDO_beaconNotifyIndCB_5:
   \   0000B1   85..82       MOV     DPL,?V0 + 0
   \   0000B4   85..83       MOV     DPH,?V0 + 1
   \   0000B7   A3           INC     DPTR
   \   0000B8   A3           INC     DPTR
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   A3           INC     DPTR
   \   0000BC   A3           INC     DPTR
   \   0000BD   A3           INC     DPTR
   \   0000BE   A3           INC     DPTR
   \   0000BF   A3           INC     DPTR
   \   0000C0   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_34:
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   F0           MOVX    @DPTR,A
   2244              pNwkDesc->version        = pBeacon->protocolVersion;
   \   0000C7   E5..         MOV     A,?V0 + 0
   \   0000C9   2408         ADD     A,#0x8
   \   0000CB   F8           MOV     R0,A
   \   0000CC   E5..         MOV     A,?V0 + 1
   \   0000CE   3400         ADDC    A,#0x0
   \   0000D0   F9           MOV     R1,A
   \   0000D1   8882         MOV     DPL,R0
   \   0000D3   8983         MOV     DPH,R1
   \   0000D5   12....       LCALL   ?Subroutine27 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   0000D8   12....       LCALL   ?Subroutine15 & 0xFFFF
   2245              pNwkDesc->logicalChannel = pBeacon->logicalChannel;
   \                     ??CrossCallReturnLabel_10:
   \   0000DB   A3           INC     DPTR
   \   0000DC   A3           INC     DPTR
   \   0000DD   E0           MOVX    A,@DPTR
   \   0000DE   8E82         MOV     DPL,R6
   \   0000E0   8F83         MOV     DPH,R7
   \   0000E2   12....       LCALL   ?Subroutine15 & 0xFFFF
   2246              pNwkDesc->panId          = pBeacon->panID;
   \                     ??CrossCallReturnLabel_11:
   \   0000E5   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   0000E8   8E82         MOV     DPL,R6
   \   0000EA   8F83         MOV     DPH,R7
   \   0000EC   12....       LCALL   ??Subroutine63_0 & 0xFFFF
   2247              pNwkDesc->updateId       = pBeacon->updateID;
   \                     ??CrossCallReturnLabel_128:
   \   0000EF   E5..         MOV     A,?V0 + 0
   \   0000F1   240C         ADD     A,#0xc
   \   0000F3   F582         MOV     DPL,A
   \   0000F5   E5..         MOV     A,?V0 + 1
   \   0000F7   12....       LCALL   ??Subroutine62_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_108:
   \   0000FA   C0E0         PUSH    A
   \   0000FC   EE           MOV     A,R6
   \   0000FD   2413         ADD     A,#0x13
   \   0000FF   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_119:
   \   000102   D0E0         POP     A
   \   000104   F0           MOVX    @DPTR,A
   2248          
   2249              // Save the extended PAN ID from the beacon payload only if 1.1 version network
   2250              if ( pBeacon->protocolVersion != ZB_PROT_V1_0 )
   \   000105   8882         MOV     DPL,R0
   \   000107   8983         MOV     DPH,R1
   \   000109   E0           MOVX    A,@DPTR
   \   00010A   6401         XRL     A,#0x1
   \   00010C   6011         JZ      ??ZDO_beaconNotifyIndCB_7
   2251              {
   2252                osal_cpyExtAddr( pNwkDesc->extendedPANID, pBeacon->extendedPanID );
   \   00010E                ; Setup parameters for call to function sAddrExtCpy
   \   00010E   E5..         MOV     A,?V0 + 0
   \   000110   240D         ADD     A,#0xd
   \   000112   FC           MOV     R4,A
   \   000113   E5..         MOV     A,?V0 + 1
   \   000115   3400         ADDC    A,#0x0
   \   000117   12....       LCALL   ?Subroutine36 & 0xFFFF
   2253              }
   \                     ??CrossCallReturnLabel_76:
   \   00011A   12....       LCALL   ??sAddrExtCpy?relay
   \   00011D   800C         SJMP    ??ZDO_beaconNotifyIndCB_8
   2254              else
   2255              {
   2256                osal_memset( pNwkDesc->extendedPANID, 0xFF, Z_EXTADDR_LEN );
   \                     ??ZDO_beaconNotifyIndCB_7:
   \   00011F                ; Setup parameters for call to function osal_memset
   \   00011F   7C08         MOV     R4,#0x8
   \   000121   7D00         MOV     R5,#0x0
   \   000123   79FF         MOV     R1,#-0x1
   \   000125   12....       LCALL   ??Subroutine49_0 & 0xFFFF
   2257              }
   \                     ??CrossCallReturnLabel_74:
   \   000128   12....       LCALL   ??osal_memset?relay
   2258          
   2259              // check if this device is a better choice to join...
   2260              // ...dont bother checking assocPermit flag is doing a rejoin
   2261              if ( ( pBeacon->LQI > gMIN_TREE_LINK_COST ) &&
   2262                  ( ( pBeacon->permitJoining == TRUE ) || ( _tmpRejoinState ) ) )
   \                     ??ZDO_beaconNotifyIndCB_8:
   \   00012B   85..82       MOV     DPL,?V0 + 0
   \   00012E   85..83       MOV     DPH,?V0 + 1
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   A3           INC     DPTR
   \   000135   A3           INC     DPTR
   \   000136   A3           INC     DPTR
   \   000137   A3           INC     DPTR
   \   000138   A3           INC     DPTR
   \   000139   A3           INC     DPTR
   \   00013A   A3           INC     DPTR
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   F8           MOV     R0,A
   \   00013D   90....       MOV     DPTR,#gMIN_TREE_LINK_COST
   \   000140   E0           MOVX    A,@DPTR
   \   000141   C3           CLR     C
   \   000142   98           SUBB    A,R0
   \   000143   4003         JC      $+5
   \   000145   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   \   000148   85..82       MOV     DPL,?V0 + 0
   \   00014B   85..83       MOV     DPH,?V0 + 1
   \   00014E   A3           INC     DPTR
   \   00014F   A3           INC     DPTR
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   6401         XRL     A,#0x1
   \   000156   6009         JZ      ??ZDO_beaconNotifyIndCB_9
   \   000158   90....       MOV     DPTR,#_tmpRejoinState
   \   00015B   E0           MOVX    A,@DPTR
   \   00015C   7003         JNZ     $+5
   \   00015E   02....       LJMP    ??ZDO_beaconNotifyIndCB_1 & 0xFFFF
   2263              {
   2264                uint8 selected = FALSE;
   \                     ??ZDO_beaconNotifyIndCB_9:
   \   000161   7900         MOV     R1,#0x0
   2265                uint8 capacity = FALSE;
   2266          
   2267                if ( _NIB.nwkAddrAlloc == NWK_ADDRESSING_STOCHASTIC )
   \   000163   90....       MOV     DPTR,#_NIB + 96
   \   000166   E0           MOVX    A,@DPTR
   \   000167   6402         XRL     A,#0x2
   \   000169   7030         JNZ     ??ZDO_beaconNotifyIndCB_10
   2268                {
   2269                  if ( ((pBeacon->LQI   > pNwkDesc->chosenRouterLinkQuality) &&
   2270                        (pBeacon->depth < MAX_NODE_DEPTH)) ||
   2271                      ((pBeacon->LQI   == pNwkDesc->chosenRouterLinkQuality) &&
   2272                       (pBeacon->depth < pNwkDesc->chosenRouterDepth)) )
   \   00016B   8E82         MOV     DPL,R6
   \   00016D   8F83         MOV     DPH,R7
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   A3           INC     DPTR
   \   000173   A3           INC     DPTR
   \   000174   A3           INC     DPTR
   \   000175   A3           INC     DPTR
   \   000176   A3           INC     DPTR
   \   000177   A3           INC     DPTR
   \   000178   E0           MOVX    A,@DPTR
   \   000179   C3           CLR     C
   \   00017A   98           SUBB    A,R0
   \   00017B   500D         JNC     ??ZDO_beaconNotifyIndCB_11
   \   00017D   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_55:
   \   000180   12....       LCALL   ??Subroutine62_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_109:
   \   000183   C3           CLR     C
   \   000184   9414         SUBB    A,#0x14
   \   000186   402D         JC      ??ZDO_beaconNotifyIndCB_12
   \   000188   802C         SJMP    ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_11:
   \   00018A   8E82         MOV     DPL,R6
   \   00018C   8F83         MOV     DPH,R7
   \   00018E   A3           INC     DPTR
   \   00018F   A3           INC     DPTR
   \   000190   A3           INC     DPTR
   \   000191   A3           INC     DPTR
   \   000192   A3           INC     DPTR
   \   000193   A3           INC     DPTR
   \   000194   A3           INC     DPTR
   \   000195   A3           INC     DPTR
   \   000196   A3           INC     DPTR
   \   000197   E0           MOVX    A,@DPTR
   \   000198   68           XRL     A,R0
   \   000199   701B         JNZ     ??ZDO_beaconNotifyIndCB_13
   \                     ??ZDO_beaconNotifyIndCB_10:
   \   00019B   8E82         MOV     DPL,R6
   \   00019D   8F83         MOV     DPH,R7
   \   00019F   A3           INC     DPTR
   \   0001A0   A3           INC     DPTR
   \   0001A1   A3           INC     DPTR
   \   0001A2   A3           INC     DPTR
   \   0001A3   A3           INC     DPTR
   \   0001A4   A3           INC     DPTR
   \   0001A5   A3           INC     DPTR
   \   0001A6   A3           INC     DPTR
   \   0001A7   A3           INC     DPTR
   \   0001A8   A3           INC     DPTR
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   F8           MOV     R0,A
   \   0001AB   12....       LCALL   ?Subroutine38 & 0xFFFF
   \                     ??CrossCallReturnLabel_56:
   \   0001AE   12....       LCALL   ??Subroutine62_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_110:
   \   0001B1   C3           CLR     C
   \   0001B2   98           SUBB    A,R0
   \   0001B3   5001         JNC     ??ZDO_beaconNotifyIndCB_13
   2273                  {
   2274                    selected = TRUE;
   \                     ??ZDO_beaconNotifyIndCB_12:
   \   0001B5   09           INC     R1
   2275                  }
   2276                }
   2277                else
   2278                {
   2279                  if ( pBeacon->depth < pNwkDesc->chosenRouterDepth )
   2280                  {
   2281                    selected = TRUE;
   2282                  }
   2283                }
   2284          
   2285                if ( ZSTACK_ROUTER_BUILD )
   2286                {
   2287                  capacity = pBeacon->routerCapacity;
   2288                }
   2289                else if ( ZSTACK_END_DEVICE_BUILD )
   2290                {
   2291                  capacity = pBeacon->deviceCapacity;
   2292                }
   2293          
   2294                if ( (capacity) && (selected) )
   \                     ??ZDO_beaconNotifyIndCB_13:
   \   0001B6   85..82       MOV     DPL,?V0 + 0
   \   0001B9   85..83       MOV     DPH,?V0 + 1
   \   0001BC   A3           INC     DPTR
   \   0001BD   A3           INC     DPTR
   \   0001BE   A3           INC     DPTR
   \   0001BF   A3           INC     DPTR
   \   0001C0   A3           INC     DPTR
   \   0001C1   A3           INC     DPTR
   \   0001C2   A3           INC     DPTR
   \   0001C3   E0           MOVX    A,@DPTR
   \   0001C4   6042         JZ      ??ZDO_beaconNotifyIndCB_14
   \   0001C6   E9           MOV     A,R1
   \   0001C7   A2E0         MOV     C,0xE0 /* A   */.0
   \   0001C9   5032         JNC     ??ZDO_beaconNotifyIndCB_15
   2295                {
   2296                  // this is the new chosen router for joining...
   2297                  pNwkDesc->chosenRouter            = pBeacon->sourceAddr;
   \   0001CB   85..82       MOV     DPL,?V0 + 0
   \   0001CE   85..83       MOV     DPH,?V0 + 1
   \   0001D1   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_78:
   \   0001D4   8E82         MOV     DPL,R6
   \   0001D6   8F83         MOV     DPH,R7
   \   0001D8   A3           INC     DPTR
   \   0001D9   A3           INC     DPTR
   \   0001DA   A3           INC     DPTR
   \   0001DB   A3           INC     DPTR
   \   0001DC   A3           INC     DPTR
   \   0001DD   A3           INC     DPTR
   \   0001DE   A3           INC     DPTR
   \   0001DF   E8           MOV     A,R0
   \   0001E0   F0           MOVX    @DPTR,A
   \   0001E1   A3           INC     DPTR
   \   0001E2   E9           MOV     A,R1
   \   0001E3   12....       LCALL   ?Subroutine9 & 0xFFFF
   2298                  pNwkDesc->chosenRouterLinkQuality = pBeacon->LQI;
   \                     ??CrossCallReturnLabel_0:
   \   0001E6   A3           INC     DPTR
   \   0001E7   A3           INC     DPTR
   \   0001E8   A3           INC     DPTR
   \   0001E9   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   0001EC   F0           MOVX    @DPTR,A
   2299                  pNwkDesc->chosenRouterDepth       = pBeacon->depth;
   \   0001ED   12....       LCALL   ?Subroutine38 & 0xFFFF
   2300                }
   \                     ??CrossCallReturnLabel_57:
   \   0001F0   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_118:
   \   0001F3   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   0001F6   A3           INC     DPTR
   \   0001F7   12....       LCALL   ?Subroutine9 & 0xFFFF
   2301          
   2302                if ( pBeacon->deviceCapacity )
   \                     ??CrossCallReturnLabel_1:
   \   0001FA   E0           MOVX    A,@DPTR
   \   0001FB   600B         JZ      ??ZDO_beaconNotifyIndCB_14
   2303                  pNwkDesc->deviceCapacity = 1;
   \                     ??ZDO_beaconNotifyIndCB_15:
   \   0001FD   8E82         MOV     DPL,R6
   \   0001FF   8F83         MOV     DPH,R7
   \   000201   A3           INC     DPTR
   \   000202   A3           INC     DPTR
   \   000203   A3           INC     DPTR
   \   000204   A3           INC     DPTR
   \   000205   7401         MOV     A,#0x1
   \   000207   F0           MOVX    @DPTR,A
   2304          
   2305                if ( pBeacon->routerCapacity )
   \                     ??ZDO_beaconNotifyIndCB_14:
   \   000208   85..82       MOV     DPL,?V0 + 0
   \   00020B   85..83       MOV     DPH,?V0 + 1
   \   00020E   A3           INC     DPTR
   \   00020F   A3           INC     DPTR
   \   000210   A3           INC     DPTR
   \   000211   A3           INC     DPTR
   \   000212   A3           INC     DPTR
   \   000213   A3           INC     DPTR
   \   000214   E0           MOVX    A,@DPTR
   \   000215   600A         JZ      ??ZDO_beaconNotifyIndCB_1
   2306                  pNwkDesc->routerCapacity = 1;
   \   000217   8E82         MOV     DPL,R6
   \   000219   8F83         MOV     DPH,R7
   \   00021B   A3           INC     DPTR
   \   00021C   A3           INC     DPTR
   \   00021D   A3           INC     DPTR
   \   00021E   7401         MOV     A,#0x1
   \   000220   F0           MOVX    @DPTR,A
   2307              }
   2308            }
   \                     ??ZDO_beaconNotifyIndCB_1:
   \   000221   02....       LJMP    ?Subroutine4 & 0xFFFF
   2309          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   E5..         MOV     A,?V0 + 0
   \   000002   240B         ADD     A,#0xb
   \   000004   F582         MOV     DPL,A
   \   000006   E5..         MOV     A,?V0 + 1
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine27:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_61:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_60:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   A3           INC     DPTR
   \   000001   A3           INC     DPTR
   \   000002   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   85..82       MOV     DPL,?V0 + 0
   \   000004   85..83       MOV     DPH,?V0 + 1
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   12....       LCALL   ?Subroutine39 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine62_0:
   \   000000   12....       LCALL   ??Subroutine57_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_124:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   22           RET
   2310          
   2311          /*********************************************************************
   2312           * @fn          ZDO_StartRouterConfirmCB
   2313           *
   2314           * @brief       This function reports the results of the request to
   2315           *              start functioning as a router in a network.
   2316           *
   2317           * @param       Status - Result of NLME_StartRouterRequest()
   2318           *
   2319           * @return      none
   2320           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2321          void ZDO_StartRouterConfirmCB( ZStatus_t Status )
   \                     ZDO_StartRouterConfirmCB:
   2322          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   2323            nwkStatus = (byte)Status;
   \   000006   90....       MOV     DPTR,#nwkStatus
   \   000009   F0           MOVX    @DPTR,A
   2324          
   2325            if ( Status == ZSUCCESS )
   \   00000A   700A         JNZ     ??ZDO_StartRouterConfirmCB_0
   2326            {
   2327              // LED on shows Router started
   2328              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   00000C                ; Setup parameters for call to function HalLedSet
   \   00000C   12....       LCALL   ?Subroutine28 & 0xFFFF
   2329              // LED off forgets HOLD_AUTO_START
   2330              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2331              if ( devState == DEV_HOLD )
   \                     ??CrossCallReturnLabel_37:
   \   00000F   700C         JNZ     ??ZDO_StartRouterConfirmCB_1
   2332              {
   2333                // Began with HOLD_AUTO_START
   2334                devState = DEV_END_DEVICE;
   \   000011   7406         MOV     A,#0x6
   \   000013   F0           MOVX    @DPTR,A
   \   000014   8007         SJMP    ??ZDO_StartRouterConfirmCB_1
   2335              }
   2336            }
   2337          #if defined(BLINK_LEDS)
   2338            else
   2339            {
   2340              HalLedSet( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_StartRouterConfirmCB_0:
   \   000016                ; Setup parameters for call to function HalLedSet
   \   000016   7A04         MOV     R2,#0x4
   \   000018   7904         MOV     R1,#0x4
   \   00001A   12....       LCALL   ??HalLedSet?relay
   2341            }
   2342          #endif
   2343          
   2344            osal_set_event( ZDAppTaskID, ZDO_ROUTER_START );
   \                     ??ZDO_StartRouterConfirmCB_1:
   \   00001D                ; Setup parameters for call to function osal_set_event
   \   00001D   7A20         MOV     R2,#0x20
   \   00001F   02....       LJMP    ?Subroutine0 & 0xFFFF
   2345          }
   2346          
   2347          /*********************************************************************
   2348           * @fn          ZDO_JoinConfirmCB
   2349           *
   2350           * @brief       This function allows the next hight layer to be notified
   2351           *              of the results of its request to join itself or another
   2352           *              device to a network.
   2353           *
   2354           * @param       Status - Result of NLME_JoinRequest()
   2355           *
   2356           * @return      none
   2357           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2358          void ZDO_JoinConfirmCB( uint16 PanId, ZStatus_t Status )
   \                     ZDO_JoinConfirmCB:
   2359          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   2360            (void)PanId;  // remove if this parameter is used.
   2361          
   2362            nwkStatus = (byte)Status;
   \   00000C   90....       MOV     DPTR,#nwkStatus
   \   00000F   F0           MOVX    @DPTR,A
   2363          
   2364            if ( Status == ZSUCCESS )
   \   000010   700D         JNZ     ??ZDO_JoinConfirmCB_0
   2365            {
   2366              // LED on shows device joined
   2367              HalLedSet ( HAL_LED_3, HAL_LED_MODE_ON );
   \   000012                ; Setup parameters for call to function HalLedSet
   \   000012   12....       LCALL   ?Subroutine28 & 0xFFFF
   2368              // LED off forgets HOLD_AUTO_START
   2369              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF);
   2370              if ( (devState == DEV_HOLD) )
   \                     ??CrossCallReturnLabel_38:
   \   000015   7003         JNZ     ??ZDO_JoinConfirmCB_1
   2371              {
   2372                // Began with HOLD_AUTO_START
   2373                devState = DEV_NWK_JOINING;
   \   000017   7403         MOV     A,#0x3
   \   000019   F0           MOVX    @DPTR,A
   2374              }
   2375          
   2376              if ( !ZG_SECURE_ENABLED )
   2377              {
   2378                // Notify to save info into NV
   2379                ZDApp_NVUpdate();
   \                     ??ZDO_JoinConfirmCB_1:
   \   00001A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00001A   12....       LCALL   ??ZDApp_NVUpdate?relay
   \   00001D   8007         SJMP    ??ZDO_JoinConfirmCB_2
   2380              }
   2381            }
   2382            else
   2383            {
   2384          #if defined(BLINK_LEDS)
   2385              HalLedSet ( HAL_LED_3, HAL_LED_MODE_FLASH );  // Flash LED to show failure
   \                     ??ZDO_JoinConfirmCB_0:
   \   00001F                ; Setup parameters for call to function HalLedSet
   \   00001F   7A04         MOV     R2,#0x4
   \   000021   7904         MOV     R1,#0x4
   \   000023   12....       LCALL   ??HalLedSet?relay
   2386          #endif
   2387            }
   2388          
   2389            // Pass the join confirm to higher layer if callback registered
   2390            if (zdoCBFunc[ZDO_JOIN_CNF_CBID] != NULL )
   \                     ??ZDO_JoinConfirmCB_2:
   \   000026   90....       MOV     DPTR,#zdoCBFunc + 8
   \   000029   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   00002C   6033         JZ      ??ZDO_JoinConfirmCB_3
   2391            {
   2392              zdoJoinCnf_t joinCnf;
   2393          
   2394              joinCnf.status = Status;
   \   00002E   EE           MOV     A,R6
   \   00002F   85..82       MOV     DPL,?XSP + 0
   \   000032   85..83       MOV     DPH,?XSP + 1
   \   000035   F0           MOVX    @DPTR,A
   2395              joinCnf.deviceAddr = _NIB.nwkDevAddress;
   \   000036   90....       MOV     DPTR,#_NIB + 20
   \   000039   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_79:
   \   00003C   7401         MOV     A,#0x1
   \   00003E   12....       LCALL   ?XSTACK_DISP0_8
   \   000041   E8           MOV     A,R0
   \   000042   F0           MOVX    @DPTR,A
   \   000043   A3           INC     DPTR
   \   000044   E9           MOV     A,R1
   \   000045   F0           MOVX    @DPTR,A
   2396              joinCnf.parentAddr = _NIB.nwkCoordAddress;
   \   000046   90....       MOV     DPTR,#_NIB + 23
   \   000049   12....       LCALL   ??Subroutine50_0 & 0xFFFF
   2397          
   2398              zdoCBFunc[ZDO_JOIN_CNF_CBID]( (void*)&joinCnf );
   2399            }
   \                     ??CrossCallReturnLabel_80:
   \   00004C   7403         MOV     A,#0x3
   \   00004E   12....       LCALL   ?XSTACK_DISP0_8
   \   000051   E8           MOV     A,R0
   \   000052   F0           MOVX    @DPTR,A
   \   000053   A3           INC     DPTR
   \   000054   E9           MOV     A,R1
   \   000055   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000058   90....       MOV     DPTR,#zdoCBFunc + 8
   \   00005B   12....       LCALL   ??Subroutine59_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_104:
   \   00005E   12....       LCALL   ?CALL_IND
   2400          
   2401            // Notify ZDApp
   2402            ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_IND, sizeof(osal_event_hdr_t), (byte*)NULL );
   \                     ??ZDO_JoinConfirmCB_3:
   \   000061                ; Setup parameters for call to function ZDApp_SendMsg
   \   000061   7C00         MOV     R4,#0x0
   \   000063   7D00         MOV     R5,#0x0
   \   000065   7B02         MOV     R3,#0x2
   \   000067   7A02         MOV     R2,#0x2
   \   000069   12....       LCALL   ?Subroutine23 & 0xFFFF
   2403          
   2404          }
   \                     ??CrossCallReturnLabel_26:
   \   00006C                REQUIRE ?Subroutine5
   \   00006C                ; // Fall through to label ?Subroutine5

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   7405         MOV     A,#0x5
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005   02....       LJMP    ??Subroutine54_0 & 0xFFFF
   2405          
   2406          /*********************************************************************
   2407           * @fn          ZDO_AddrChangeIndicationCB
   2408           *
   2409           * @brief       This function notifies the application that this
   2410           *              device's address has changed.  Could happen in
   2411           *              a network with stochastic addressing (PRO).
   2412           *
   2413           * @param       newAddr - the new address
   2414           *
   2415           * @return      none
   2416           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2417          void ZDO_AddrChangeIndicationCB( uint16 newAddr )
   \                     ZDO_AddrChangeIndicationCB:
   2418          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   2419            ZDO_AddrChangeInd_t *pZDOAddrChangeMsg;
   2420            epList_t *pItem = epList;
   \   000009   90....       MOV     DPTR,#epList
   \   00000C   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   2421          
   2422            // Notify to save info into NV
   2423            ZDApp_NVUpdate();
   \                     ??CrossCallReturnLabel_93:
   \   00000F                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000F   12....       LCALL   ??ZDApp_NVUpdate?relay
   2424          
   2425            // Notify the applications
   2426            osal_set_event( ZDAppTaskID, ZDO_STATE_CHANGE_EVT );
   \   000012                ; Setup parameters for call to function osal_set_event
   \   000012   12....       LCALL   ?Subroutine19 & 0xFFFF
   \                     ??CrossCallReturnLabel_67:
   \   000015   8033         SJMP    ??ZDO_AddrChangeIndicationCB_0
   2427          
   2428            while (pItem != NULL)
   2429            {
   2430              if (pItem->epDesc->endPoint != ZDO_EP)
   \                     ??ZDO_AddrChangeIndicationCB_1:
   \   000017   12....       LCALL   ?Subroutine17 & 0xFFFF
   \                     ??CrossCallReturnLabel_106:
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   6026         JZ      ??ZDO_AddrChangeIndicationCB_2
   2431              {
   2432                pZDOAddrChangeMsg = (ZDO_AddrChangeInd_t *)osal_msg_allocate( sizeof( ZDO_AddrChangeInd_t ) );
   \   00001D                ; Setup parameters for call to function osal_msg_allocate
   \   00001D   7A04         MOV     R2,#0x4
   \   00001F   7B00         MOV     R3,#0x0
   \   000021   12....       LCALL   ??osal_msg_allocate?relay
   2433                if (pZDOAddrChangeMsg != NULL)
   \   000024   EA           MOV     A,R2
   \   000025   4B           ORL     A,R3
   \   000026   601B         JZ      ??ZDO_AddrChangeIndicationCB_2
   2434                {
   2435                  pZDOAddrChangeMsg->hdr.event = ZDO_ADDR_CHANGE_IND;
   \   000028   8A82         MOV     DPL,R2
   \   00002A   8B83         MOV     DPH,R3
   \   00002C   74D6         MOV     A,#-0x2a
   \   00002E   F0           MOVX    @DPTR,A
   2436                  pZDOAddrChangeMsg->shortAddr = newAddr;
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   E5..         MOV     A,?V0 + 0
   \   000033   F0           MOVX    @DPTR,A
   \   000034   A3           INC     DPTR
   \   000035   E5..         MOV     A,?V0 + 1
   \   000037   F0           MOVX    @DPTR,A
   2437                  osal_msg_send( *(pItem->epDesc->task_id), (uint8 *)pZDOAddrChangeMsg );
   \   000038                ; Setup parameters for call to function osal_msg_send
   \   000038   12....       LCALL   ?Subroutine17 & 0xFFFF
   2438                }
   2439              }
   \                     ??CrossCallReturnLabel_107:
   \   00003B   12....       LCALL   ??Subroutine58_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_105:
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F9           MOV     R1,A
   \   000040   12....       LCALL   ??osal_msg_send?relay
   2440              pItem = pItem->nextDesc;
   \                     ??ZDO_AddrChangeIndicationCB_2:
   \   000043   12....       LCALL   ?Subroutine18 & 0xFFFF
   2441            }
   \                     ??CrossCallReturnLabel_84:
   \   000046   E8           MOV     A,R0
   \   000047   FE           MOV     R6,A
   \   000048   E9           MOV     A,R1
   \   000049   FF           MOV     R7,A
   \                     ??ZDO_AddrChangeIndicationCB_0:
   \   00004A   EE           MOV     A,R6
   \   00004B   4F           ORL     A,R7
   \   00004C   70C9         JNZ     ??ZDO_AddrChangeIndicationCB_1
   2442          
   2443            // Send out a device announce
   2444            ZDApp_AnnounceNewAddress();
   \   00004E                ; Setup parameters for call to function ZDApp_AnnounceNewAddress
   \   00004E   12....       LCALL   ??ZDApp_AnnounceNewAddress?relay
   2445          }
   \   000051   02....       LJMP    ??Subroutine47_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004   A3           INC     DPTR
   \   000005                REQUIRE ??Subroutine58_0
   \   000005                ; // Fall through to label ??Subroutine58_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine58_0:
   \   000000   A3           INC     DPTR
   \   000001                REQUIRE ??Subroutine59_0
   \   000001                ; // Fall through to label ??Subroutine59_0
   2446          
   2447          /*********************************************************************
   2448           * @fn          ZDO_JoinIndicationCB
   2449           *
   2450           * @brief       This function allows the next higher layer of a
   2451           *              coordinator to be notified of a remote join request.
   2452           *
   2453           * @param       ShortAddress - 16-bit address
   2454           * @param       ExtendedAddress - IEEE (64-bit) address
   2455           * @param       CapabilityFlags - Association Capability Flags
   2456           * @param       type - of joining -
   2457           *                          NWK_ASSOC_JOIN
   2458           *                          NWK_ASSOC_REJOIN_UNSECURE
   2459           *                          NWK_ASSOC_REJOIN_SECURE
   2460           *
   2461           * @return      ZStatus_t
   2462           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2463          ZStatus_t ZDO_JoinIndicationCB(uint16 ShortAddress, uint8 *ExtendedAddress,
   \                     ZDO_JoinIndicationCB:
   2464                                          uint8 CapabilityFlags, uint8 type)
   2465          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2466            (void)ShortAddress;
   2467            (void)ExtendedAddress;
   2468          #if ZDO_NV_SAVE_RFDs
   2469            (void)CapabilityFlags;
   2470          
   2471          #else  // if !ZDO_NV_SAVE_RFDs
   2472            if (CapabilityFlags & CAPINFO_DEVICETYPE_FFD)
   2473          #endif
   2474            {
   2475              ZDApp_NVUpdate();  // Notify to save info into NV.
   \   000004                ; Setup parameters for call to function ZDApp_NVUpdate
   \   000004   12....       LCALL   ??ZDApp_NVUpdate?relay
   2476            }
   2477          
   2478            if (ZG_SECURE_ENABLED)  // Send notification to TC of new device.
   2479            {
   2480              if (type == NWK_ASSOC_JOIN || type == NWK_ASSOC_REJOIN_UNSECURE)
   2481              {
   2482                osal_start_timerEx( ZDAppTaskID, ZDO_NEW_DEVICE, 600 );
   2483              }
   2484            }
   2485          
   2486            return ZSuccess;
   \   000007   7900         MOV     R1,#0x0
   \   000009   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2487          }
   2488          
   2489          /*********************************************************************
   2490           * @fn          ZDO_ConcentratorIndicationCB
   2491           *
   2492           * @brief       This function allows the next higher layer of a
   2493           *              device to be notified of existence of the concentrator.
   2494           *
   2495           * @param       nwkAddr - 16-bit NWK address of the concentrator
   2496           * @param       extAddr - pointer to extended Address
   2497           *                        NULL if not available
   2498           * @param       pktCost - PktCost from RREQ
   2499           *
   2500           * @return      void
   2501           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2502          void ZDO_ConcentratorIndicationCB( uint16 nwkAddr, uint8 *extAddr, uint8 pktCost )
   \                     ZDO_ConcentratorIndicationCB:
   2503          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2504            zdoConcentratorInd_t conInd;
   2505          
   2506            conInd.nwkAddr = nwkAddr;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
   2507            conInd.extAddr = extAddr;
   \                     ??CrossCallReturnLabel_131:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   EC           MOV     A,R4
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   ED           MOV     A,R5
   \   000016   F0           MOVX    @DPTR,A
   2508            conInd.pktCost = pktCost;
   \   000017   7404         MOV     A,#0x4
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E9           MOV     A,R1
   \   00001D   F0           MOVX    @DPTR,A
   2509          
   2510            if( zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc + 2
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   000024   6013         JZ      ??ZDO_ConcentratorIndicationCB_0
   2511            {
   2512              zdoCBFunc[ZDO_CONCENTRATOR_IND_CBID]( (void*)&conInd );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   90....       MOV     DPTR,#zdoCBFunc + 3
   \   000033   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   2513            }
   \                     ??CrossCallReturnLabel_99:
   \   000036   12....       LCALL   ?CALL_IND
   2514          }
   \                     ??ZDO_ConcentratorIndicationCB_0:
   \   000039   02....       LJMP    ?Subroutine5 & 0xFFFF
   2515          
   2516          /*********************************************************************
   2517           * @fn          ZDO_LeaveCnf
   2518           *
   2519           * @brief       This function allows the next higher layer to be
   2520           *              notified of the results of its request for this or
   2521           *              a child device to leave the network.
   2522           *
   2523           * @param       cnf - NLME_LeaveCnf_t
   2524           *
   2525           * @return      none
   2526           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2527          void ZDO_LeaveCnf( NLME_LeaveCnf_t* cnf )
   \                     ZDO_LeaveCnf:
   2528          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2529            // Check for this device
   2530            if ( osal_ExtAddrEqual( cnf->extAddr,
   2531                                    NLME_GetExtAddr() ) == TRUE )
   \   000009                ; Setup parameters for call to function sAddrExtCmp
   \   000009                ; Setup parameters for call to function NLME_GetExtAddr
   \   000009   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000C   EA           MOV     A,R2
   \   00000D   FC           MOV     R4,A
   \   00000E   EB           MOV     A,R3
   \   00000F   FD           MOV     R5,A
   \   000010   EE           MOV     A,R6
   \   000011   2402         ADD     A,#0x2
   \   000013   FA           MOV     R2,A
   \   000014   EF           MOV     A,R7
   \   000015   3400         ADDC    A,#0x0
   \   000017   FB           MOV     R3,A
   \   000018   12....       LCALL   ??sAddrExtCmp?relay
   \   00001B   E9           MOV     A,R1
   \   00001C   6401         XRL     A,#0x1
   \   00001E   701F         JNZ     ??CrossCallReturnLabel_43
   2532            {
   2533              // Pass the leave confirm to higher layer if callback registered
   2534              if ( ( zdoCBFunc[ZDO_LEAVE_CNF_CBID] == NULL ) ||
   2535                   ( (*zdoCBFunc[ZDO_LEAVE_CNF_CBID])( cnf ) == NULL ) )
   \   000020   90....       MOV     DPTR,#zdoCBFunc + 10
   \   000023   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000026   6011         JZ      ??ZDO_LeaveCnf_0
   \   000028                ; Setup parameters for indirect call
   \   000028   EE           MOV     A,R6
   \   000029   FA           MOV     R2,A
   \   00002A   EF           MOV     A,R7
   \   00002B   FB           MOV     R3,A
   \   00002C   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_100:
   \   00002F   12....       LCALL   ?CALL_IND
   \   000032   8B..         MOV     ?V0 + 1,R3
   \   000034   EA           MOV     A,R2
   \   000035   45..         ORL     A,?V0 + 1
   \   000037   7006         JNZ     ??CrossCallReturnLabel_43
   2536              {
   2537                // Prepare to leave with reset
   2538                ZDApp_LeaveReset( cnf->rejoin );
   \                     ??ZDO_LeaveCnf_0:
   \   000039                ; Setup parameters for call to function ZDApp_LeaveReset
   \   000039   EE           MOV     A,R6
   \   00003A   240B         ADD     A,#0xb
   \   00003C   12....       LCALL   ?Subroutine31 & 0xFFFF
   2539              }
   2540            }
   2541            else if ( ZSTACK_ROUTER_BUILD )
   2542            {
   2543              // Remove device address(optionally descendents) from data
   2544              ZDApp_LeaveUpdate( cnf->dstAddr,
   2545                                 cnf->extAddr,
   2546                                 cnf->removeChildren );
   2547            }
   2548          }
   \                     ??CrossCallReturnLabel_43:
   \   00003F   02....       LJMP    ??Subroutine44_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   12....       LCALL   ??Subroutine56_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_121:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   12....       LCALL   ??ZDApp_LeaveReset?relay
   \   000008   22           RET
   2549          
   2550          /*********************************************************************
   2551           * @fn          ZDO_LeaveInd
   2552           *
   2553           * @brief       This function allows the next higher layer of a
   2554           *              device to be notified of a remote leave request or
   2555           *              indication.
   2556           *
   2557           * @param       ind - NLME_LeaveInd_t
   2558           *
   2559           * @return      none
   2560           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2561          void ZDO_LeaveInd( NLME_LeaveInd_t* ind )
   \                     ZDO_LeaveInd:
   2562          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2563            uint8 leave;
   2564          
   2565          
   2566            // Parent is requesting the leave - NWK layer filters out illegal
   2567            // requests
   2568            if ( ind->request == TRUE )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   A3           INC     DPTR
   \   000012   A3           INC     DPTR
   \   000013   A3           INC     DPTR
   \   000014   A3           INC     DPTR
   \   000015   A3           INC     DPTR
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6401         XRL     A,#0x1
   \   00001A   7008         JNZ     ??ZDO_LeaveInd_0
   2569            {
   2570              // Notify network of leave
   2571              if ( ZSTACK_ROUTER_BUILD )
   2572              {
   2573                NLME_LeaveRsp_t rsp;
   2574                rsp.rejoin         = ind->rejoin;
   2575                rsp.removeChildren = ind->removeChildren;
   2576                NLME_LeaveRsp( &rsp );
   2577              }
   2578          
   2579              // Prepare to leave with reset
   2580              ZDApp_LeaveReset( ind->rejoin );
   \                     ??ZDO_LeaveInd_1:
   \   00001C                ; Setup parameters for call to function ZDApp_LeaveReset
   \   00001C   EE           MOV     A,R6
   \   00001D   240C         ADD     A,#0xc
   \   00001F   12....       LCALL   ?Subroutine31 & 0xFFFF
   2581            }
   \                     ??CrossCallReturnLabel_44:
   \   000022   803F         SJMP    ??ZDO_LeaveInd_2
   2582            else
   2583            {
   2584              leave = FALSE;
   2585          
   2586              // Check if this device needs to leave as a child or descendent
   2587              if ( ind->srcAddr == NLME_GetCoordShortAddr() )
   \                     ??ZDO_LeaveInd_0:
   \   000024                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   000024   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000027   8A..         MOV     ?V0 + 0,R2
   \   000029   8B..         MOV     ?V0 + 1,R3
   \   00002B   A8..         MOV     R0,?V0 + 0
   \   00002D   A9..         MOV     R1,?V0 + 1
   \   00002F   8E82         MOV     DPL,R6
   \   000031   8F83         MOV     DPH,R7
   \   000033   E0           MOVX    A,@DPTR
   \   000034   68           XRL     A,R0
   \   000035   7003         JNZ     ??ZDO_LeaveInd_3
   \   000037   A3           INC     DPTR
   \   000038   E0           MOVX    A,@DPTR
   \   000039   69           XRL     A,R1
   \                     ??ZDO_LeaveInd_3:
   \   00003A   7011         JNZ     ??ZDO_LeaveInd_4
   2588              {
   2589                if ( ( ind->removeChildren == TRUE               ) ||
   2590                     ( ZDO_Config_Node_Descriptor.LogicalType ==
   2591                       NODETYPE_DEVICE                           )    )
   \   00003C   12....       LCALL   ?Subroutine33 & 0xFFFF
   2592                {
   2593                  leave = TRUE;
   2594                }
   2595              }
   \                     ??CrossCallReturnLabel_114:
   \   00003F   6401         XRL     A,#0x1
   \   000041   60D9         JZ      ??ZDO_LeaveInd_1
   \   000043   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000046   E0           MOVX    A,@DPTR
   \   000047   5407         ANL     A,#0x7
   \   000049   6402         XRL     A,#0x2
   \   00004B   60CF         JZ      ??ZDO_LeaveInd_1
   2596              else if ( ind->removeChildren == TRUE )
   2597              {
   2598                // Check NWK address allocation algorithm
   2599                //leave = RTG_ANCESTOR(nwkAddr,thisAddr);
   2600              }
   2601          
   2602              if ( leave == TRUE )
   2603              {
   2604                // Prepare to leave with reset
   2605                ZDApp_LeaveReset( ind->rejoin );
   2606              }
   2607              else
   2608              {
   2609                // Remove device address(optionally descendents) from data
   2610                ZDApp_LeaveUpdate( ind->srcAddr,
   2611                                   ind->extAddr,
   2612                                   ind->removeChildren );
   \                     ??ZDO_LeaveInd_4:
   \   00004D                ; Setup parameters for call to function ZDApp_LeaveUpdate
   \   00004D   12....       LCALL   ?Subroutine33 & 0xFFFF
   2613              }
   2614            }
   \                     ??CrossCallReturnLabel_115:
   \   000050   F9           MOV     R1,A
   \   000051   EE           MOV     A,R6
   \   000052   2402         ADD     A,#0x2
   \   000054   FC           MOV     R4,A
   \   000055   EF           MOV     A,R7
   \   000056   3400         ADDC    A,#0x0
   \   000058   FD           MOV     R5,A
   \   000059   8E82         MOV     DPL,R6
   \   00005B   8F83         MOV     DPH,R7
   \   00005D   12....       LCALL   ?Subroutine25 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   000060   12....       LCALL   ??ZDApp_LeaveUpdate?relay
   2615          
   2616            // Pass the leave indication to higher layer if callback registered.
   2617            if (zdoCBFunc[ZDO_LEAVE_IND_CBID] != NULL)
   \                     ??ZDO_LeaveInd_2:
   \   000063   90....       MOV     DPTR,#zdoCBFunc + 12
   \   000066   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   000069   600A         JZ      ??ZDO_LeaveInd_5
   2618            {
   2619              (void)zdoCBFunc[ZDO_LEAVE_IND_CBID](ind);
   \   00006B                ; Setup parameters for indirect call
   \   00006B   EE           MOV     A,R6
   \   00006C   FA           MOV     R2,A
   \   00006D   EF           MOV     A,R7
   \   00006E   FB           MOV     R3,A
   \   00006F   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   2620            }
   \                     ??CrossCallReturnLabel_101:
   \   000072   12....       LCALL   ?CALL_IND
   2621          }
   \                     ??ZDO_LeaveInd_5:
   \   000075   02....       LJMP    ??Subroutine44_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   EE           MOV     A,R6
   \   000001   240B         ADD     A,#0xb
   \   000003                REQUIRE ??Subroutine61_0
   \   000003                ; // Fall through to label ??Subroutine61_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine61_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine62_0
   \   000003                ; // Fall through to label ??Subroutine62_0
   2622          
   2623          /*********************************************************************
   2624           * @fn          ZDO_SyncIndicationCB
   2625           *
   2626           * @brief       This function allows the next higher layer of a
   2627           *              coordinator to be notified of a loss of synchronization
   2628           *                          with the parent/child device.
   2629           *
   2630           * @param       type: 0 - child; 1 - parent
   2631           *
   2632           *
   2633           * @return      none
   2634           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2635          void ZDO_SyncIndicationCB( uint8 type, uint16 shortAddr )
   \                     ZDO_SyncIndicationCB:
   2636          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2637            (void)shortAddr;  // Remove this line if this parameter is used.
   2638          
   2639            if ( ZSTACK_END_DEVICE_BUILD
   2640              || (ZSTACK_ROUTER_BUILD && ((_NIB.CapabilityFlags & ZMAC_ASSOC_CAPINFO_FFD_TYPE) == 0)))
   2641            {
   2642              if ( type == 1 )
   \   000007   7401         MOV     A,#0x1
   \   000009   6E           XRL     A,R6
   \   00000A   700E         JNZ     ??CrossCallReturnLabel_27
   2643              {
   2644                // We lost contact with our parent.  Clear the neighbor Table.
   2645                nwkNeighborInitTable();
   \   00000C                ; Setup parameters for call to function nwkNeighborInitTable
   \   00000C   12....       LCALL   ??nwkNeighborInitTable?relay
   2646          
   2647                // Start the rejoin process.
   2648                ZDApp_SendMsg( ZDAppTaskID, ZDO_NWK_JOIN_REQ, sizeof(osal_event_hdr_t), NULL );
   \   00000F                ; Setup parameters for call to function ZDApp_SendMsg
   \   00000F   7C00         MOV     R4,#0x0
   \   000011   7D00         MOV     R5,#0x0
   \   000013   7B02         MOV     R3,#0x2
   \   000015   7A03         MOV     R2,#0x3
   \   000017   12....       LCALL   ?Subroutine23 & 0xFFFF
   2649              }
   2650            }
   2651          }
   \                     ??CrossCallReturnLabel_27:
   \   00001A   02....       LJMP    ??Subroutine54_0 & 0xFFFF
   2652          
   2653          /*********************************************************************
   2654           * @fn          ZDO_ManytoOneFailureIndicationCB
   2655           *
   2656           * @brief       This function allows the next higher layer of a
   2657           *              concentrator to be notified of a many-to-one route
   2658           *              failure.
   2659           *
   2660           * @param       none
   2661           *
   2662           *
   2663           * @return      none
   2664           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2665          void ZDO_ManytoOneFailureIndicationCB()
   \                     ZDO_ManytoOneFailureIndicationCB:
   2666          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2667            // By default, the concentrator automatically redo many-to-one route
   2668            // discovery to update all many-to-one routes in the network
   2669            // If you want anything processing other than the default,
   2670            // please replace the following code.
   2671          
   2672            RTG_MTORouteReq();
   \   000004                ; Setup parameters for call to function RTG_MTORouteReq
   \   000004   12....       LCALL   ??RTG_MTORouteReq?relay
   2673          }
   \   000007   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2674          
   2675          /*********************************************************************
   2676           * @fn          ZDO_PollConfirmCB
   2677           *
   2678           * @brief       This function allows the next higher layer to be
   2679           *              notified of a Poll Confirm.
   2680           *
   2681           * @param       none
   2682           *
   2683           * @return      none
   2684           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2685          void ZDO_PollConfirmCB( uint8 status )
   \                     ZDO_PollConfirmCB:
   2686          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2687            (void)status;  // Remove this line if this parameter is used.
   2688            return;
   \   000000   02....       LJMP    ?BRET
   2689          }
   2690          
   2691          /******************************************************************************
   2692           * @fn          ZDApp_NwkWriteNVRequest (stubs AddrMgrWriteNVRequest)
   2693           *
   2694           * @brief       Stub routine implemented by NHLE. NHLE should call
   2695           *              <AddrMgrWriteNV> when appropriate.
   2696           *
   2697           * @param       none
   2698           *
   2699           * @return      none
   2700           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2701          void ZDApp_NwkWriteNVRequest( void )
   \                     AddrMgrWriteNVRequest:
   2702          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2703          #if defined ( NV_RESTORE )
   2704            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000005                ; Setup parameters for call to function osal_get_timeoutEx
   \   000005   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   000008   7003         JNZ     ??AddrMgrWriteNVRequest_0
   2705            {
   2706              // Trigger to save info into NV
   2707              ZDApp_NVUpdate();
   \   00000A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000A   12....       LCALL   ??ZDApp_NVUpdate?relay
   2708            }
   2709          #endif
   2710          }
   \                     ??AddrMgrWriteNVRequest_0:
   \   00000D   02....       LJMP    ??Subroutine44_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   7A00         MOV     R2,#0x0
   \   000002   7B02         MOV     R3,#0x2
   \   000004   90....       MOV     DPTR,#ZDAppTaskID
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F9           MOV     R1,A
   \   000009   12....       LCALL   ??osal_get_timeoutEx?relay
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EA           MOV     A,R2
   \   00000F   45..         ORL     A,?V0 + 1
   \   000011   22           RET
   2711          
   2712          /*********************************************************************
   2713           * Call Back Functions from Security  - API
   2714           */
   2715          
   2716           /*********************************************************************
   2717           * @fn          ZDO_UpdateDeviceIndication
   2718           *
   2719           * @brief       This function notifies the "Trust Center" of a
   2720           *              network when a device joins or leaves the network.
   2721           *
   2722           * @param       extAddr - pointer to 64 bit address of new device
   2723           * @param       status  - 0 if a new device joined securely
   2724           *                      - 1 if a new device joined un-securely
   2725           *                      - 2 if a device left the network
   2726           *
   2727           * @return      true if newly joined device should be allowed to
   2728           *                                              remain on network
   2729           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2730          ZStatus_t ZDO_UpdateDeviceIndication( uint8 *extAddr, uint8 status )
   \                     ZDO_UpdateDeviceIndication:
   2731          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2732            // can implement a network access policy based on the
   2733            // IEEE address of newly joining devices...
   2734            (void)extAddr;
   2735            (void)status;
   2736          
   2737            return ZSuccess;
   \   000000   7900         MOV     R1,#0x0
   \   000002   02....       LJMP    ?BRET
   2738          }
   2739          
   2740          /*********************************************************************
   2741           * @fn          ZDApp_InMsgCB
   2742           *
   2743           * @brief       This function is called to pass up any message that is
   2744           *              not yet supported.  This allows for the developer to
   2745           *              support features themselves..
   2746           *
   2747           * @return      none
   2748           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2749          void ZDApp_InMsgCB( zdoIncomingMsg_t *inMsg )
   \                     ZDApp_InMsgCB:
   2750          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2751            if ( inMsg->clusterID & ZDO_RESPONSE_BIT )
   \   000009   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_122:
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   5480         ANL     A,#0x80
   \   000010   704A         JNZ     ??ZDApp_InMsgCB_0
   2752            {
   2753              // Handle the response message
   2754            }
   2755            else
   2756            {
   2757              // Handle the request message by sending a generic "not supported".
   2758              // Device Announce doesn't have a response.
   2759              if ( !(inMsg->wasBroadcast) && inMsg->clusterID != Device_annce )
   \   000012   12....       LCALL   ?Subroutine33 & 0xFFFF
   \                     ??CrossCallReturnLabel_116:
   \   000015   7045         JNZ     ??ZDApp_InMsgCB_0
   \   000017   EE           MOV     A,R6
   \   000018   240C         ADD     A,#0xc
   \   00001A   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_111:
   \   00001D   6413         XRL     A,#0x13
   \   00001F   7002         JNZ     ??ZDApp_InMsgCB_1
   \   000021   A3           INC     DPTR
   \   000022   E0           MOVX    A,@DPTR
   \                     ??ZDApp_InMsgCB_1:
   \   000023   6037         JZ      ??ZDApp_InMsgCB_0
   2760              {
   2761                ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_NOT_SUPPORTED, 0,
   2762                                (uint16)(inMsg->clusterID | ZDO_RESPONSE_BIT), inMsg->SecurityUse );
   \   000025                ; Setup parameters for call to function ZDP_GenericRsp
   \   000025   12....       LCALL   ?Subroutine32 & 0xFFFF
   2763              }
   2764            }
   \                     ??CrossCallReturnLabel_46:
   \   000028   4480         ORL     A,#0x80
   \   00002A   F5..         MOV     ?V0 + 1,A
   \   00002C   78..         MOV     R0,#?V0 + 0
   \   00002E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000031   E4           CLR     A
   \   000032   F5..         MOV     ?V0 + 0,A
   \   000034   F5..         MOV     ?V0 + 1,A
   \   000036   78..         MOV     R0,#?V0 + 0
   \   000038   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003B   EE           MOV     A,R6
   \   00003C   240E         ADD     A,#0xe
   \   00003E   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_112:
   \   000041   FD           MOV     R5,A
   \   000042   7C84         MOV     R4,#-0x7c
   \   000044   EE           MOV     A,R6
   \   000045   2402         ADD     A,#0x2
   \   000047   0A           INC     R2
   \   000048   0A           INC     R2
   \   000049   EF           MOV     A,R7
   \   00004A   3400         ADDC    A,#0x0
   \   00004C   FB           MOV     R3,A
   \   00004D   EE           MOV     A,R6
   \   00004E   240F         ADD     A,#0xf
   \   000050   12....       LCALL   ??Subroutine61_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_113:
   \   000053   F9           MOV     R1,A
   \   000054   12....       LCALL   ??ZDP_GenericRsp?relay
   \   000057   7404         MOV     A,#0x4
   \   000059   12....       LCALL   ?DEALLOC_XSTACK8
   2765          }
   \                     ??ZDApp_InMsgCB_0:
   \   00005C   02....       LJMP    ??Subroutine44_0 & 0xFFFF
   2766          
   2767          
   2768          /*********************************************************************
   2769           * @fn      ZDApp_ChangeMatchDescRespPermission()
   2770           *
   2771           * @brief   Changes the Match Descriptor Response permission.
   2772           *
   2773           * @param   endpoint - endpoint to allow responses
   2774           * @param   action - true to allow responses, false to not
   2775           *
   2776           * @return  none
   2777           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2778          void ZDApp_ChangeMatchDescRespPermission( uint8 endpoint, uint8 action )
   \                     ZDApp_ChangeMatchDescRespPermission:
   2779          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2780            // Store the action
   2781            afSetMatch( endpoint, action );
   \   000005                ; Setup parameters for call to function afSetMatch
   \   000005   12....       LCALL   ??afSetMatch?relay
   2782          }
   \   000008   02....       LJMP    ??Subroutine54_0 & 0xFFFF
   2783          
   2784          /*********************************************************************
   2785           * @fn      ZDApp_NetworkInit()
   2786           *
   2787           * @brief   Used to start the network joining process
   2788           *
   2789           * @param   delay - mSec delay to wait before starting
   2790           *
   2791           * @return  none
   2792           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2793          void ZDApp_NetworkInit( uint16 delay )
   \                     ZDApp_NetworkInit:
   2794          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2795            if ( delay )
   \   000004   EA           MOV     A,R2
   \   000005   4B           ORL     A,R3
   \   000006   600D         JZ      ??ZDApp_NetworkInit_0
   2796            {
   2797              // Wait awhile before starting the device
   2798              osal_start_timerEx( ZDAppTaskID, ZDO_NETWORK_INIT, delay );
   \   000008                ; Setup parameters for call to function osal_start_timerEx
   \   000008   EA           MOV     A,R2
   \   000009   FC           MOV     R4,A
   \   00000A   EB           MOV     A,R3
   \   00000B   FD           MOV     R5,A
   \   00000C   7A01         MOV     R2,#0x1
   \   00000E   7B00         MOV     R3,#0x0
   \   000010   12....       LCALL   ?Subroutine26 & 0xFFFF
   2799            }
   \                     ??CrossCallReturnLabel_90:
   \   000013   8005         SJMP    ??CrossCallReturnLabel_70
   2800            else
   2801            {
   2802              osal_set_event( ZDAppTaskID, ZDO_NETWORK_INIT );
   \                     ??ZDApp_NetworkInit_0:
   \   000015                ; Setup parameters for call to function osal_set_event
   \   000015   7A01         MOV     R2,#0x1
   \   000017   12....       LCALL   ??Subroutine45_0 & 0xFFFF
   2803            }
   2804          }
   \                     ??CrossCallReturnLabel_70:
   \   00001A   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2805          
   2806          /*********************************************************************
   2807           * @fn      ZDApp_NwkStateUpdateCB()
   2808           *
   2809           * @brief   This function notifies that this device's network
   2810           *          state info has been changed.
   2811           *
   2812           * @param   none
   2813           *
   2814           * @return  none
   2815           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2816          void ZDApp_NwkStateUpdateCB( void )
   \                     ZDApp_NwkStateUpdateCB:
   2817          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2818            // Notify to save info into NV
   2819            if ( !osal_get_timeoutEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV ) )
   \   000005                ; Setup parameters for call to function osal_get_timeoutEx
   \   000005   12....       LCALL   ?Subroutine24 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   000008   7003         JNZ     ??ZDApp_NwkStateUpdateCB_0
   2820            {
   2821              // Trigger to save info into NV
   2822              ZDApp_NVUpdate();
   \   00000A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00000A   12....       LCALL   ??ZDApp_NVUpdate?relay
   2823            }
   2824          }
   \                     ??ZDApp_NwkStateUpdateCB_0:
   \   00000D   02....       LJMP    ??Subroutine44_0 & 0xFFFF
   2825          
   2826          /*********************************************************************
   2827           * @fn      ZDApp_NodeProfileSync()
   2828           *
   2829           * @brief   Sync node with stack profile.
   2830           *
   2831           * @param   stackProfile - stack profile of the network to join
   2832           *
   2833           * @return  none
   2834           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2835          void ZDApp_NodeProfileSync( uint8 stackProfile )
   \                     ZDApp_NodeProfileSync:
   2836          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   2837            if ( ZDO_Config_Node_Descriptor.CapabilityFlags & CAPINFO_DEVICETYPE_FFD  )
   \   000007   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   A2E1         MOV     C,0xE0 /* A   */.1
   \   00000D   501A         JNC     ??ZDApp_NodeProfileSync_0
   2838            {
   2839              if ( stackProfile != zgStackProfile )
   \   00000F   90....       MOV     DPTR,#zgStackProfile
   \   000012   E0           MOVX    A,@DPTR
   \   000013   6E           XRL     A,R6
   \   000014   6013         JZ      ??ZDApp_NodeProfileSync_0
   2840              {
   2841                ZDO_Config_Node_Descriptor.LogicalType = NODETYPE_DEVICE;
   \   000016   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   54F8         ANL     A,#0xf8
   \   00001C   4402         ORL     A,#0x2
   \   00001E   F0           MOVX    @DPTR,A
   2842                ZDO_Config_Node_Descriptor.CapabilityFlags = CAPINFO_DEVICETYPE_RFD | CAPINFO_POWER_AC | CAPINFO_RCVR_ON_IDLE;
   \   00001F   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000022   740C         MOV     A,#0xc
   \   000024   F0           MOVX    @DPTR,A
   2843                NLME_SetBroadcastFilter( ZDO_Config_Node_Descriptor.CapabilityFlags );
   \   000025                ; Setup parameters for call to function NLME_SetBroadcastFilter
   \   000025   F9           MOV     R1,A
   \   000026   12....       LCALL   ??NLME_SetBroadcastFilter?relay
   2844              }
   2845            }
   2846          }
   \                     ??ZDApp_NodeProfileSync_0:
   \   000029   02....       LJMP    ??Subroutine54_0 & 0xFFFF
   2847          
   2848          /*********************************************************************
   2849           * @fn      ZDApp_StartJoiningCycle()
   2850           *
   2851           * @brief   Starts the joining cycle of a device.  This will only
   2852           *          continue an already started (or stopped) joining cycle.
   2853           *
   2854           * @param   none
   2855           *
   2856           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2857           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2858          uint8 ZDApp_StartJoiningCycle( void )
   \                     ZDApp_StartJoiningCycle:
   2859          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2860            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StartJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7011         JNZ     ??ZDApp_StartJoiningCycle_1
   2861            {
   2862              continueJoining = TRUE;
   \                     ??ZDApp_StartJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   7401         MOV     A,#0x1
   \   000016   F0           MOVX    @DPTR,A
   2863              ZDApp_NetworkInit( 0 );
   \   000017                ; Setup parameters for call to function ZDApp_NetworkInit
   \   000017   7A00         MOV     R2,#0x0
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   12....       LCALL   ??ZDApp_NetworkInit?relay
   2864          
   2865              return ( TRUE );
   \   00001E   7901         MOV     R1,#0x1
   \   000020   8002         SJMP    ??ZDApp_StartJoiningCycle_2
   2866            }
   2867            else
   2868              return ( FALSE );
   \                     ??ZDApp_StartJoiningCycle_1:
   \   000022   7900         MOV     R1,#0x0
   \                     ??ZDApp_StartJoiningCycle_2:
   \   000024   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2869          }
   2870          
   2871          /*********************************************************************
   2872           * @fn      ZDApp_StopJoiningCycle()
   2873           *
   2874           * @brief   Stops the joining or rejoining process of a device.
   2875           *
   2876           * @param   none
   2877           *
   2878           * @return  TRUE if joining stopped, FALSE if joining or rejoining
   2879           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2880          uint8 ZDApp_StopJoiningCycle( void )
   \                     ZDApp_StopJoiningCycle:
   2881          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2882            if ( devState == DEV_INIT || devState == DEV_NWK_DISC )
   \   000004   90....       MOV     DPTR,#devState
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6401         XRL     A,#0x1
   \   00000A   6005         JZ      ??ZDApp_StopJoiningCycle_0
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6402         XRL     A,#0x2
   \   00000F   7009         JNZ     ??ZDApp_StopJoiningCycle_1
   2883            {
   2884              continueJoining = FALSE;
   \                     ??ZDApp_StopJoiningCycle_0:
   \   000011   90....       MOV     DPTR,#continueJoining
   \   000014   E4           CLR     A
   \   000015   F0           MOVX    @DPTR,A
   2885              return ( TRUE );
   \   000016   7901         MOV     R1,#0x1
   \   000018   8002         SJMP    ??ZDApp_StopJoiningCycle_2
   2886            }
   2887            else
   2888              return ( FALSE );
   \                     ??ZDApp_StopJoiningCycle_1:
   \   00001A   7900         MOV     R1,#0x0
   \                     ??ZDApp_StopJoiningCycle_2:
   \   00001C   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   2889          }
   2890          
   2891          /*********************************************************************
   2892           * @fn      ZDApp_AnnounceNewAddress()
   2893           *
   2894           * @brief   Send Device Announce and hold all transmissions for
   2895           *          new address timeout.
   2896           *
   2897           * @param   none
   2898           *
   2899           * @return  none
   2900           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2901          void ZDApp_AnnounceNewAddress( void )
   \                     ZDApp_AnnounceNewAddress:
   2902          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2903          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2904            // Turn off data request hold
   2905            APSME_HoldDataRequests( 0 );
   \   000005                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000005   7A00         MOV     R2,#0x0
   \   000007   7B00         MOV     R3,#0x0
   \   000009   12....       LCALL   ??APSME_HoldDataRequests?relay
   2906          #endif
   2907          
   2908            ZDP_DeviceAnnce( NLME_GetShortAddr(), NLME_GetExtAddr(),
   2909                               ZDO_Config_Node_Descriptor.CapabilityFlags, 0 );
   \   00000C                ; Setup parameters for call to function NLME_GetExtAddr
   \   00000C   12....       LCALL   ??NLME_GetExtAddr?relay
   \   00000F   8A..         MOV     ?V0 + 0,R2
   \   000011   8B..         MOV     ?V0 + 1,R3
   \   000013   AE..         MOV     R6,?V0 + 0
   \   000015                ; Setup parameters for call to function NLME_GetShortAddr
   \   000015   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000018                ; Setup parameters for call to function ZDP_DeviceAnnce
   \   000018   75..00       MOV     ?V0 + 0,#0x0
   \   00001B   78..         MOV     R0,#?V0 + 0
   \   00001D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000020   90....       MOV     DPTR,#ZDO_Config_Node_Descriptor + 2
   \   000023   E0           MOVX    A,@DPTR
   \   000024   F9           MOV     R1,A
   \   000025   EE           MOV     A,R6
   \   000026   FC           MOV     R4,A
   \   000027   AD..         MOV     R5,?V0 + 1
   \   000029   12....       LCALL   ??ZDP_DeviceAnnce?relay
   \   00002C   7401         MOV     A,#0x1
   \   00002E   12....       LCALL   ?DEALLOC_XSTACK8
   2910          
   2911          #if defined ( ZIGBEE_NWK_UNIQUE_ADDR_CHECK )
   2912            // Setup the timeout
   2913            APSME_HoldDataRequests( ZDAPP_HOLD_DATA_REQUESTS_TIMEOUT );
   \   000031                ; Setup parameters for call to function APSME_HoldDataRequests
   \   000031   7A00         MOV     R2,#0x0
   \   000033   7B00         MOV     R3,#0x0
   \   000035   12....       LCALL   ??APSME_HoldDataRequests?relay
   2914          #endif
   2915          }
   \   000038   02....       LJMP    ??Subroutine44_0 & 0xFFFF
   2916          
   2917          /*********************************************************************
   2918           * @fn          ZDApp_NVUpdate
   2919           *
   2920           * @brief       Set the NV Update Timer.
   2921           *
   2922           * @param       none
   2923           *
   2924           * @return      none
   2925           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2926          void ZDApp_NVUpdate( void )
   \                     ZDApp_NVUpdate:
   2927          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2928          #if defined ( NV_RESTORE )
   2929            osal_start_timerEx( ZDAppTaskID, ZDO_NWK_UPDATE_NV, ZDAPP_UPDATE_NWK_NV_TIME );
   \   000004                ; Setup parameters for call to function osal_start_timerEx
   \   000004   7CBC         MOV     R4,#-0x44
   \   000006   7D02         MOV     R5,#0x2
   \   000008   7A00         MOV     R2,#0x0
   \   00000A   7B02         MOV     R3,#0x2
   \   00000C   02....       LJMP    ?Subroutine3 & 0xFFFF
   2930          #endif
   2931          }
   2932          
   2933          /*********************************************************************
   2934           * @fn      ZDApp_CoordStartPANIDConflictCB()
   2935           *
   2936           * @brief   Returns a PAN ID for the network layer to use during
   2937           *          a coordinator start and there is another network with
   2938           *          the intended PANID.
   2939           *
   2940           * @param   panid - the intended PAN ID
   2941           *
   2942           * @return  PANID to try
   2943           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2944          uint16 ZDApp_CoordStartPANIDConflictCB( uint16 panid )
   \                     ZDApp_CoordStartPANIDConflictCB:
   2945          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   2946            return ( panid + 1 );
   \   000000   EA           MOV     A,R2
   \   000001   2401         ADD     A,#0x1
   \   000003   0A           INC     R2
   \   000004   EB           MOV     A,R3
   \   000005   3400         ADDC    A,#0x0
   \   000007   FB           MOV     R3,A
   \   000008   02....       LJMP    ?BRET
   2947          }
   2948          
   2949          /*********************************************************************
   2950           * @fn          ZDO_SrcRtgIndCB
   2951           *
   2952           * @brief       This function notifies the ZDO available src route record received.
   2953           *
   2954           * @param       srcAddr - source address of the source route
   2955           * @param       relayCnt - number of devices in the relay list
   2956           * @param       relayList - relay list of the source route
   2957           *
   2958           * @return      none
   2959           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2960          void ZDO_SrcRtgIndCB (uint16 srcAddr, uint8 relayCnt, uint16* pRelayList )
   \                     ZDO_SrcRtgIndCB:
   2961          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 5
   \   000005   74FB         MOV     A,#-0x5
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   2962            zdoSrcRtg_t srcRtg;
   2963          
   2964            srcRtg.srcAddr = srcAddr;
   \   00000A   12....       LCALL   ?Subroutine13 & 0xFFFF
   2965            srcRtg.relayCnt = relayCnt;
   \                     ??CrossCallReturnLabel_132:
   \   00000D   7402         MOV     A,#0x2
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   E9           MOV     A,R1
   \   000013   F0           MOVX    @DPTR,A
   2966            srcRtg.pRelayList = pRelayList;
   \   000014   7403         MOV     A,#0x3
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   EC           MOV     A,R4
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   A3           INC     DPTR
   \   00001C   ED           MOV     A,R5
   \   00001D   F0           MOVX    @DPTR,A
   2967          
   2968            if( zdoCBFunc[ZDO_SRC_RTG_IND_CBID] != NULL )
   \   00001E   90....       MOV     DPTR,#zdoCBFunc
   \   000021   12....       LCALL   ?Subroutine16 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   000024   6013         JZ      ??ZDO_SrcRtgIndCB_0
   2969            {
   2970              zdoCBFunc[ZDO_SRC_RTG_IND_CBID]( (void*)&srcRtg );
   \   000026                ; Setup parameters for indirect call
   \   000026   85..82       MOV     DPL,?XSP + 0
   \   000029   85..83       MOV     DPH,?XSP + 1
   \   00002C   AA82         MOV     R2,DPL
   \   00002E   AB83         MOV     R3,DPH
   \   000030   90....       MOV     DPTR,#zdoCBFunc + 1
   \   000033   12....       LCALL   ??Subroutine60_0 & 0xFFFF
   2971            }
   \                     ??CrossCallReturnLabel_102:
   \   000036   12....       LCALL   ?CALL_IND
   2972          }
   \                     ??ZDO_SrcRtgIndCB_0:
   \   000039   02....       LJMP    ?Subroutine5 & 0xFFFF
   2973          
   2974          /*********************************************************************
   2975           * @fn          ZDApp_InitZdoCBFunc
   2976           *
   2977           * @brief       Call this function to initialize zdoCBFunc[]
   2978           *
   2979           * @param       none
   2980           *
   2981           * @return      none
   2982           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2983          void ZDApp_InitZdoCBFunc( void )
   \                     ZDApp_InitZdoCBFunc:
   2984          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   2985            uint8 i;
   2986          
   2987            for ( i=0; i< MAX_ZDO_CB_FUNC; i++ )
   \   000004   7A00         MOV     R2,#0x0
   2988            {
   2989              zdoCBFunc[i] = NULL;
   \                     ??ZDApp_InitZdoCBFunc_0:
   \   000006   12....       LCALL   ?Subroutine30 & 0xFFFF
   2990            }
   \                     ??CrossCallReturnLabel_41:
   \   000009   0A           INC     R2
   \   00000A   EA           MOV     A,R2
   \   00000B   C3           CLR     C
   \   00000C   9407         SUBB    A,#0x7
   \   00000E   40F6         JC      ??ZDApp_InitZdoCBFunc_0
   2991          }
   \   000010   02....       LJMP    ??Subroutine52_0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   EA           MOV     A,R2
   \   000001   12....       LCALL   ?Subroutine42 & 0xFFFF
   \                     ??CrossCallReturnLabel_63:
   \   000004   E4           CLR     A
   \   000005   F0           MOVX    @DPTR,A
   \   000006   A3           INC     DPTR
   \   000007   F0           MOVX    @DPTR,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine42:
   \   000000   C3           CLR     C
   \   000001   33           RLC     A
   \   000002   F8           MOV     R0,A
   \   000003   E4           CLR     A
   \   000004   33           RLC     A
   \   000005   F9           MOV     R1,A
   \   000006   74..         MOV     A,#zdoCBFunc & 0xff
   \   000008   28           ADD     A,R0
   \   000009   F582         MOV     DPL,A
   \   00000B   74..         MOV     A,#(zdoCBFunc >> 8) & 0xff
   \   00000D   39           ADDC    A,R1
   \   00000E   F583         MOV     DPH,A
   \   000010   22           RET
   2992          
   2993          /*********************************************************************
   2994           * @fn          ZDO_RegisterForZdoCB
   2995           *
   2996           * @brief       Call this function to register the higher layer (for
   2997           *              example, the Application layer or MT layer) with ZDO
   2998           *              callbacks to get notified of some ZDO indication like
   2999           *              existence of a concentrator or receipt of a source
   3000           *              route record.
   3001           *
   3002           * @param       indID - ZDO Indication ID
   3003           * @param       pFn   - Callback function pointer
   3004           *
   3005           * @return      ZSuccess - successful, ZInvalidParameter if not
   3006           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3007          ZStatus_t ZDO_RegisterForZdoCB( uint8 indID, pfnZdoCb pFn )
   \                     ZDO_RegisterForZdoCB:
   3008          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FC           MOV     R4,A
   3009            // Check the range of the indication ID
   3010            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   500B         JNC     ??ZDO_RegisterForZdoCB_0
   3011            {
   3012              zdoCBFunc[indID] = pFn;
   \   00000B   EC           MOV     A,R4
   \   00000C   12....       LCALL   ?Subroutine42 & 0xFFFF
   \                     ??CrossCallReturnLabel_62:
   \   00000F   12....       LCALL   ??Subroutine63_0 & 0xFFFF
   3013              return ZSuccess;
   \                     ??CrossCallReturnLabel_129:
   \   000012   7900         MOV     R1,#0x0
   \   000014   8002         SJMP    ??ZDO_RegisterForZdoCB_1
   3014            }
   3015          
   3016            return ZInvalidParameter;
   \                     ??ZDO_RegisterForZdoCB_0:
   \   000016   7902         MOV     R1,#0x2
   \                     ??ZDO_RegisterForZdoCB_1:
   \   000018   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   3017          }
   3018          
   3019          /*********************************************************************
   3020           * @fn          ZDO_DeregisterForZdoCB
   3021           *
   3022           * @brief       Call this function to de-register the higher layer (for
   3023           *              example, the Application layer or MT layer) with ZDO
   3024           *              callbacks to get notified of some ZDO indication like
   3025           *              existence of a concentrator or receipt of a source
   3026           *              route record.
   3027           *
   3028           * @param       indID - ZDO Indication ID
   3029           *
   3030           * @return      ZSuccess - successful, ZInvalidParameter if not
   3031           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   3032          ZStatus_t ZDO_DeregisterForZdoCB( uint8 indID )
   \                     ZDO_DeregisterForZdoCB:
   3033          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
   \   000004   E9           MOV     A,R1
   \   000005   FA           MOV     R2,A
   3034            // Check the range of the indication ID
   3035            if ( indID < MAX_ZDO_CB_FUNC )
   \   000006   C3           CLR     C
   \   000007   9407         SUBB    A,#0x7
   \   000009   5006         JNC     ??ZDO_DeregisterForZdoCB_0
   3036            {
   3037              zdoCBFunc[indID] = NULL;
   \   00000B   12....       LCALL   ?Subroutine30 & 0xFFFF
   3038              return ZSuccess;
   \                     ??CrossCallReturnLabel_42:
   \   00000E   F9           MOV     R1,A
   \   00000F   8002         SJMP    ??ZDO_DeregisterForZdoCB_1
   3039            }
   3040          
   3041            return ZInvalidParameter;
   \                     ??ZDO_DeregisterForZdoCB_0:
   \   000011   7902         MOV     R1,#0x2
   \                     ??ZDO_DeregisterForZdoCB_1:
   \   000013   02....       LJMP    ??Subroutine52_0 & 0xFFFF
   3042          }

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zdoDiscCounter>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for continueJoining>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for devState>`:
   \   000000   01           DB 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_epDesc>`:
   \   000000   00           DB 0
   \   000001   ....         DW ZDAppTaskID
   \   000003   0000         DW 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDApp_SavedPollRate>`:
   \   000000   E803         DW 1000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_1:
   \   000000   01000000     DD 1

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SecInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SecInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDOInitDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDOInitDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ReadNetworkRestoreState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ReadNetworkRestoreState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppDetermineDeviceType?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppDetermineDeviceType

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkStartEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkStartEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceAuthEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceAuthEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNetworkStateEvt?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNetworkStateEvt

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNetworkState?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNetworkState

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitUserDesc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitUserDesc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDAppCheckForHoldKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDAppCheckForHoldKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessOSALMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessOSALMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessMsgCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessMsgCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RegisterCBs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RegisterCBs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessSecMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessSecMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ProcessNetworkJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ProcessNetworkJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SaveNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SaveNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_RestoreNwkKey?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_RestoreNwkKey

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerStart?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerStart

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ResetTimerCancel?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ResetTimerCancel

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlSet?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlSet

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlBypass?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlBypass

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveCtrlStartup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveCtrlStartup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveReset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveReset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_LeaveUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_LeaveUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkDiscoveryReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkDiscoveryReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_JoinReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_JoinReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_DeviceConfigured?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_DeviceConfigured

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendEventMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendEventMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_SendMsg?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_SendMsg

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkDiscoveryConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkDiscoveryConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkDescListProcessing?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkDescListProcessing

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_NetworkFormationConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_NetworkFormationConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_beaconNotifyIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_beaconNotifyIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartRouterConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartRouterConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AddrChangeIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AddrChangeIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_JoinIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_JoinIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConcentratorIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConcentratorIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveCnf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveCnf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_LeaveInd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_LeaveInd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SyncIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SyncIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ManytoOneFailureIndicationCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ManytoOneFailureIndicationCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_PollConfirmCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_PollConfirmCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??AddrMgrWriteNVRequest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    AddrMgrWriteNVRequest

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateDeviceIndication?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateDeviceIndication

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InMsgCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InMsgCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_ChangeMatchDescRespPermission?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_ChangeMatchDescRespPermission

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NetworkInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NetworkInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NwkStateUpdateCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NwkStateUpdateCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NodeProfileSync?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NodeProfileSync

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StartJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StartJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_StopJoiningCycle?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_StopJoiningCycle

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_AnnounceNewAddress?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_AnnounceNewAddress

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_NVUpdate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_NVUpdate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_CoordStartPANIDConflictCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_CoordStartPANIDConflictCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SrcRtgIndCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SrcRtgIndCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDApp_InitZdoCBFunc?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDApp_InitZdoCBFunc

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RegisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RegisterForZdoCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_DeregisterForZdoCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_DeregisterForZdoCB
   3043          
   3044          /*********************************************************************
   3045          *********************************************************************/

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     AddrMgrWriteNVRequest              0      0     34
       -> osal_get_timeoutEx            0      0     20
       -> ZDApp_NVUpdate                0      0     20
     ZDAppCheckForHoldKey               2      0      9
       -> HalKeyRead                    4      0      0
     ZDAppDetermineDeviceType           2      0     14
       -> nwk_ExtPANIDValid             4      0      0
     ZDApp_AnnounceNewAddress           0      0     23
       -> APSME_HoldDataRequests        0      0     20
       -> NLME_GetExtAddr               0      0     20
       -> NLME_GetShortAddr             0      0     20
       -> ZDP_DeviceAnnce               0      0     22
       -> APSME_HoldDataRequests        0      0     20
     ZDApp_ChangeMatchDescRespPermission
                                        0      0      9
       -> afSetMatch                    0      0     18
     ZDApp_CoordStartPANIDConflictCB
                                        0      0      0
     ZDApp_DeviceAuthEvt                2      0      9
       -> ZDApp_ResetTimerCancel        4      0      0
       -> osal_set_event                4      0      0
       -> ZDApp_NVUpdate                4      0      0
       -> ZDApp_SaveNwkKey              4      0      0
       -> ZDApp_AnnounceNewAddress      4      0      0
       -> NLME_SetPollRate              4      0      0
       -> ZDApp_NVUpdate                4      0      0
     ZDApp_DeviceConfigured             0      0     16
       -> osal_nv_read                  0      0     32
     ZDApp_InMsgCB                      0      0     14
       -> ZDP_GenericRsp                0      0     28
     ZDApp_Init                         0      0      9
       -> NLME_GetExtAddr               0      0     18
       -> ZDAppCheckForHoldKey          0      0     18
       -> ZDO_Init                      0      0     18
       -> afRegister                    0      0     18
       -> ZDApp_InitUserDesc            0      0     18
       -> ZDOInitDevice                 0      0     18
       -> ZDOInitDevice                 0      0     18
       -> HalLedBlink                   0      0     18
       -> ZDApp_InitZdoCBFunc           0      0     18
       -> ZDApp_RegisterCBs             0      0     18
     ZDApp_InitUserDesc                 0      0     40
       -> osal_memset                   0      0     54
       -> osal_nv_item_init             0      0     58
       -> osal_nv_read                  0      0     62
     ZDApp_InitZdoCBFunc                2      0      9
     ZDApp_JoinReq                      0      0     22
       -> ZDApp_NodeProfileSync         0      0     28
       -> NLME_JoinRequest              0      0     36
     ZDApp_LeaveCtrlBypass              2      0      0
     ZDApp_LeaveCtrlInit                0      0     28
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
     ZDApp_LeaveCtrlReset               0      0     14
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlSet                 0      0     23
       -> osal_nv_write                 0      0     28
     ZDApp_LeaveCtrlStartup             2      0     14
       -> ZDApp_LeaveCtrlReset          4      0      0
     ZDApp_LeaveReset                   0      0     19
       -> ZDApp_LeaveCtrlSet            0      0     18
       -> ZDApp_ResetTimerStart         0      0     18
     ZDApp_LeaveUpdate                  0      0     37
       -> ZDSecMgrDeviceRemoveByExtAddr
                                        0      0     48
       -> ZDSecMgrAddrClear             0      0     48
       -> osal_memcpy                   0      0     54
       -> RTG_RemoveRtgEntry            0      0     48
       -> nwkNeighborRemove             0      0     48
       -> AddrMgrWriteNVRequest         0      0     48
     ZDApp_NVUpdate                     2      0     14
       -> osal_start_timerEx            4      0      0
     ZDApp_NetworkDiscoveryReq          0      0     12
       -> NLME_NetworkDiscoveryRequest
                                        0      0     24
     ZDApp_NetworkInit                  2      0     14
       -> osal_start_timerEx            4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NetworkStartEvt              2      0      0
       -> HalLedSet                     4      0      0
       -> osal_pwrmgr_device            4      0      0
       -> osal_set_event                4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_GetEnergyThreshold       4      0      0
       -> NLME_SetEnergyThreshold       4      0      0
       -> osal_set_event                4      0      0
       -> osal_set_event                4      0      0
     ZDApp_NodeProfileSync              0      0     23
       -> NLME_SetBroadcastFilter       0      0     18
     ZDApp_NwkDescListProcessing        0      0     25
       -> nwk_getNwkDescList            0      0     28
       -> nwk_getNwkDescList            0      0     28
       -> nwk_ExtPANIDValid             0      0     28
       -> sAddrExtCmp                   0      0     28
     ZDApp_NwkStateUpdateCB             0      0     10
       -> osal_get_timeoutEx            0      0     20
       -> ZDApp_NVUpdate                0      0     20
     ZDApp_ProcessMsgCBs                0      0     42
       -> ZDO_ParseAddrRsp              0      0     62
       -> ZDO_UpdateAddrManager         0      0     62
       -> osal_mem_free                 0      0     62
       -> ZDO_ParseBindUnbindReq        0      0     62
       -> ZDO_ProcessBindUnbindReq      0      0     62
     ZDApp_ProcessNetworkJoin           0      0     23
       -> osal_set_event                0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> HalLedSet                     0      0     24
       -> NLME_GetShortAddr             0      0     24
       -> ZMacSetReq                    0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> osal_set_event                0      0     24
       -> NLME_SetPollRate              0      0     24
       -> NLME_SetQueuedPollRate        0      0     24
       -> NLME_SetResponseRate          0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> nwkNeighborInitTable          0      0     24
       -> NLME_NwkDiscTerm              0      0     24
       -> osal_rand                     0      0     24
       -> ZDApp_NetworkInit             0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
       -> osal_set_event                0      0     24
     ZDApp_ProcessOSALMsg               0      0     25
       -> ZDP_IncomingData              0      0     22
       -> ZDApp_ProcessMsgCBs           0      0     22
       -> ZDApp_NwkDescListProcessing
                                        0      0     22
       -> ZDApp_NodeProfileSync         0      0     22
       -> NLME_JoinRequest              0      0     30
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> osal_rand                     0      0     22
       -> ZMacSetReq                    0      0     22
       -> ZMacSetReq                    0      0     22
       -> ZMacSetReq                    0      0     22
       -> NLME_ReJoinRequest            0      0     22
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> NLME_SetPollRate              0      0     22
       -> NLME_SetQueuedPollRate        0      0     22
       -> NLME_SetResponseRate          0      0     22
       -> osal_rand                     0      0     22
       -> ZDApp_NetworkInit             0      0     22
       -> ZDApp_ProcessNetworkJoin      0      0     22
       -> sAddrExtCpy                   0      0     22
       -> ZDApp_NetworkInit             0      0     22
     ZDApp_ProcessSecEvent              0      0      9
       -> ZDApp_DeviceAuthEvt           0      0     18
       -> ZDApp_SaveNwkKey              0      0     18
       -> ZDSecMgrSaveApsLinkKey        0      0     18
       -> ZDSecMgrSaveTCLinkKey         0      0     18
     ZDApp_ProcessSecMsg                2      0      0
       -> ZDSecMgrTransportKeyInd       4      0      0
       -> ZDSecMgrSwitchKeyInd          4      0      0
     ZDApp_ReadNetworkRestoreState      0      0     23
       -> zgReadStartupOptions          0      0     18
     ZDApp_RegisterCBs                  2      0      9
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
       -> ZDO_RegisterForZDOMsg         4      0      0
     ZDApp_ResetNwkKey                  0      0     35
       -> osal_memset                   0      0     62
       -> osal_nv_write                 0      0     70
     ZDApp_ResetTimerCancel             2      0      0
       -> osal_stop_timerEx             4      0      0
     ZDApp_ResetTimerStart              2      0      9
       -> osal_start_timerEx            4      0      0
     ZDApp_RestoreNetworkState          0      0     23
       -> NLME_InitNV                   0      0     18
       -> NLME_RestoreFromNV            0      0     18
       -> NLME_GetShortAddr             0      0     18
       -> sAddrExtCpy                   0      0     18
     ZDApp_RestoreNwkKey                0      0     37
       -> osal_nv_read                  0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SaveNetworkStateEvt          2      0     10
       -> NLME_UpdateNV                 4      0      0
       -> zgWriteStartupOptions         4      0      0
     ZDApp_SaveNwkKey                   0      0     46
       -> SSP_ReadNwkActiveKey          0      0     66
       -> osal_nv_write                 0      0     74
       -> osal_memset                   0      0     66
     ZDApp_SecInit                      0      0      9
       -> ZDSecMgrInit                  0      0     18
     ZDApp_SendEventMsg                 0      0      9
       -> ZDApp_SendMsg                 0      0     18
     ZDApp_SendMsg                      1      0     33
       -> osal_msg_allocate             0      0     32
       -> osal_memcpy                   0      0     38
       -> osal_msg_send                 0      0     32
     ZDApp_StartJoiningCycle            2      0      0
       -> ZDApp_NetworkInit             4      0      0
     ZDApp_StopJoiningCycle             2      0      0
     ZDApp_event_loop                   0      0     10
       -> osal_set_event                0      0     20
       -> ZDO_StartDevice               0      0     20
       -> ZDApp_ProcessOSALMsg          0      0     20
       -> osal_msg_deallocate           0      0     20
       -> osal_msg_receive              0      0     20
       -> ZDO_UpdateNwkStatus           0      0     20
       -> osal_start_timerEx            0      0     20
       -> ZDApp_SaveNetworkStateEvt     0      0     20
       -> zgWriteStartupOptions         0      0     20
       -> Onboard_soft_reset            0      0     20
     ZDOInitDevice                      0      0     23
       -> zgInitItems                   0      0     28
       -> ZDConfig_InitDescriptors      0      0     28
       -> HalKeyRead                    0      0     28
       -> NLME_InitNV                   0      0     28
       -> NLME_SetDefaultNV             0      0     28
       -> ZDSecMgrClearNVKeyValues      0      0     28
       -> ZDAppDetermineDeviceType      0      0     28
       -> osal_rand                     0      0     28
       -> ZDSecMgrInit                  0      0     28
       -> ZDApp_LeaveCtrlInit           0      0     28
       -> ZDApp_LeaveCtrlStartup        0      0     28
       -> zgWriteStartupOptions         0      0     28
       -> osal_set_event                0      0     28
       -> ZDApp_ReadNetworkRestoreState
                                        0      0     28
       -> ZDApp_RestoreNetworkState     0      0     28
       -> ZDApp_NetworkInit             0      0     28
       -> NLME_SetBroadcastFilter       0      0     28
     ZDO_AddrChangeIndicationCB         0      0     12
       -> ZDApp_NVUpdate                0      0     24
       -> osal_set_event                0      0     24
       -> osal_msg_allocate             0      0     24
       -> osal_msg_send                 0      0     24
       -> ZDApp_AnnounceNewAddress      0      0     24
     ZDO_ConcentratorIndicationCB       1      0     14
     ZDO_DeregisterForZdoCB             2      0      0
     ZDO_JoinConfirmCB                  1      0     14
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> ZDApp_NVUpdate                0      0     28
       -> HalLedSet                     0      0     28
       -> ZDApp_SendMsg                 0      0     28
     ZDO_JoinIndicationCB               2      0      1
       -> ZDApp_NVUpdate                4      0      0
     ZDO_LeaveCnf                       0      0     10
       -> NLME_GetExtAddr               0      0     20
       -> sAddrExtCmp                   0      0     20
       -> ZDApp_LeaveReset              0      0     20
     ZDO_LeaveInd                       0      0     10
       -> ZDApp_LeaveReset              0      0     20
       -> NLME_GetCoordShortAddr        0      0     20
       -> ZDApp_LeaveUpdate             0      0     20
     ZDO_ManytoOneFailureIndicationCB
                                        2      0      0
       -> RTG_MTORouteReq               4      0      0
     ZDO_NetworkDiscoveryConfirmCB      3      0      3
       -> ZDApp_SendMsg                 4      0      6
     ZDO_NetworkFormationConfirmCB      0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_PollConfirmCB                  0      0      0
     ZDO_RegisterForZdoCB               2      0      0
     ZDO_SrcRtgIndCB                    1      0     14
     ZDO_StartRouterConfirmCB           0      0      9
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> HalLedSet                     0      0     18
       -> osal_set_event                0      0     18
     ZDO_SyncIndicationCB               0      0      9
       -> nwkNeighborInitTable          0      0     18
       -> ZDApp_SendMsg                 0      0     18
     ZDO_UpdateDeviceIndication         0      0      0
     ZDO_beaconNotifyIndCB              1      0     14
       -> osal_mem_alloc                0      0     28
       -> osal_memset                   0      0     28
       -> sAddrExtCpy                   0      0     28
       -> osal_memset                   0      0     28


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     zdoDiscCounter                                 1
     ZDAppNwkAddr                                   9
     zdappMgmtNwkDiscRspTransSeq                    1
     zdappMgmtNwkDiscReqInProgress                  1
     zdappMgmtNwkDiscRspAddr                        9
     zdappMgmtNwkDiscStartIndex                     1
     zdappMgmtSavedNwkState                         1
     nwkFrameCounterChanges                         2
     continueJoining                                1
     _tmpRejoinState                                1
     ZDO_UseExtendedPANID                           8
     zdoCBFunc                                     14
     ZDAppTaskID                                    1
     nwkStatus                                      1
     ZDApp_AutoFindMode_epDesc                      2
     ZDApp_LeaveCtrl                                1
     devState                                       1
     devStartMode                                   1
     retryCnt                                       1
     ZDApp_epDesc                                   6
     ZDApp_SavedPollRate                            2
     ZDApp_Init                                    88
     ??Subroutine54_0                               5
     ZDApp_SecInit                                 11
     ZDApp_event_loop                             174
     ??Subroutine44_0                               5
     ??Subroutine48_0                              14
     ??Subroutine53_0                               6
     ZDApp_ProcessSecEvent                        106
     ??Subroutine50_0                               6
     ??Subroutine63_0                               6
     ZDOInitDevice                                200
     ?Subroutine19                                  2
     ??Subroutine45_0                              11
     ??Subroutine46_0                               3
     ??Subroutine47_0                               5
     ?Subroutine13                                  6
     ZDApp_ReadNetworkRestoreState                 21
     ZDAppDetermineDeviceType                      74
     ??Subroutine52_0                               7
     ZDApp_NetworkStartEvt                         81
     ?Subroutine14                                  9
     ZDApp_DeviceAuthEvt                           52
     ?Subroutine8                                   5
     ?Subroutine25                                  6
     ZDApp_SaveNetworkStateEvt                     19
     ZDApp_RestoreNetworkState                     65
     ?Subroutine10                                 13
     ?Subroutine16                                  8
     ??Subroutine43_0                               3
     ZDApp_InitUserDesc                            89
     ?Subroutine35                                 32
     ?Subroutine37                                  8
     ZDAppCheckForHoldKey                          20
     ZDApp_ProcessOSALMsg                         425
     ?Subroutine36                                  1
     ??Subroutine49_0                               9
     ?Subroutine18                                  4
     ?Subroutine34                                 22
     ?Subroutine29                                 15
     ?Subroutine11                                 12
     ZDApp_ProcessMsgCBs                          118
     ?Subroutine6                                   5
     ?Subroutine41                                  3
     ??Subroutine56_0                               3
     ??Subroutine57_0                               5
     ?Subroutine32                                  9
     ZDApp_RegisterCBs                             31
     ?Subroutine22                                  2
     ??Subroutine51_0                               9
     ZDApp_ProcessSecMsg                           56
     ZDApp_ProcessNetworkJoin                     332
     ?Subroutine7                                   5
     ?Subroutine12                                 12
     ?Subroutine2                                   2
     ZDApp_SaveNwkKey                             112
     ZDApp_ResetNwkKey                             48
     ZDApp_RestoreNwkKey                          141
     ZDApp_ResetTimerStart                         15
     ?Subroutine3                                   3
     ?Subroutine26                                  3
     ZDApp_ResetTimerCancel                        19
     ZDApp_LeaveCtrlInit                           71
     ?Subroutine1                                  35
     ZDApp_LeaveCtrlSet                            22
     ZDApp_LeaveCtrlReset                          13
     ZDApp_LeaveCtrlBypass                         15
     ZDApp_LeaveCtrlStartup                        47
     ZDApp_LeaveReset                              17
     ZDApp_LeaveUpdate                            137
     ??Subroutine59_0                               3
     ??Subroutine60_0                               6
     ZDApp_NetworkDiscoveryReq                     11
     ZDApp_JoinReq                                 84
     ?Subroutine4                                   5
     ZDApp_DeviceConfigured                        87
     ZDApp_SendEventMsg                            17
     ?Subroutine23                                  9
     ZDApp_SendMsg                                 90
     ZDO_NetworkDiscoveryConfirmCB                 78
     ZDApp_NwkDescListProcessing                  266
     ?Subroutine21                                  6
     ??Subroutine55_0                               6
     ?Subroutine0                                   3
     ZDO_NetworkFormationConfirmCB                 34
     ?Subroutine28                                 19
     ZDO_beaconNotifyIndCB                        548
     ?Subroutine38                                  9
     ?Subroutine27                                  4
     ?Subroutine40                                  9
     ?Subroutine20                                 10
     ?Subroutine15                                  6
     ?Subroutine39                                 10
     ?Subroutine9                                   9
     ??Subroutine62_0                               5
     ZDO_StartRouterConfirmCB                      34
     ZDO_JoinConfirmCB                            108
     ?Subroutine5                                   8
     ZDO_AddrChangeIndicationCB                    84
     ?Subroutine17                                  5
     ??Subroutine58_0                               1
     ZDO_JoinIndicationCB                          12
     ZDO_ConcentratorIndicationCB                  60
     ZDO_LeaveCnf                                  66
     ?Subroutine31                                  9
     ZDO_LeaveInd                                 120
     ?Subroutine33                                  3
     ??Subroutine61_0                               3
     ZDO_SyncIndicationCB                          29
     ZDO_ManytoOneFailureIndicationCB
                                                   10
     ZDO_PollConfirmCB                              3
     AddrMgrWriteNVRequest                         16
     ?Subroutine24                                 18
     ZDO_UpdateDeviceIndication                     5
     ZDApp_InMsgCB                                 95
     ZDApp_ChangeMatchDescRespPermission
                                                   11
     ZDApp_NetworkInit                             29
     ZDApp_NwkStateUpdateCB                        16
     ZDApp_NodeProfileSync                         44
     ZDApp_StartJoiningCycle                       39
     ZDApp_StopJoiningCycle                        31
     ZDApp_AnnounceNewAddress                      59
     ZDApp_NVUpdate                                15
     ZDApp_CoordStartPANIDConflictCB
                                                   11
     ZDO_SrcRtgIndCB                               60
     ZDApp_InitZdoCBFunc                           19
     ?Subroutine30                                  9
     ?Subroutine42                                 17
     ZDO_RegisterForZdoCB                          27
     ZDO_DeregisterForZdoCB                        22
     ?<Initializer for zdoDiscCounter>              1
     ?<Initializer for continueJoining>             1
     ?<Initializer for devState>                    1
     ?<Initializer for ZDApp_epDesc>                6
     ?<Initializer for ZDApp_SavedPollRate>         2
     __Constant_1                                   4
     __Constant_3e8                                 4
     ??ZDApp_Init?relay                             6
     ??ZDApp_SecInit?relay                          6
     ??ZDApp_event_loop?relay                       6
     ??ZDApp_ProcessSecEvent?relay                  6
     ??ZDOInitDevice?relay                          6
     ??ZDApp_ReadNetworkRestoreState?relay          6
     ??ZDAppDetermineDeviceType?relay               6
     ??ZDApp_NetworkStartEvt?relay                  6
     ??ZDApp_DeviceAuthEvt?relay                    6
     ??ZDApp_SaveNetworkStateEvt?relay              6
     ??ZDApp_RestoreNetworkState?relay              6
     ??ZDApp_InitUserDesc?relay                     6
     ??ZDAppCheckForHoldKey?relay                   6
     ??ZDApp_ProcessOSALMsg?relay                   6
     ??ZDApp_ProcessMsgCBs?relay                    6
     ??ZDApp_RegisterCBs?relay                      6
     ??ZDApp_ProcessSecMsg?relay                    6
     ??ZDApp_ProcessNetworkJoin?relay               6
     ??ZDApp_SaveNwkKey?relay                       6
     ??ZDApp_ResetNwkKey?relay                      6
     ??ZDApp_RestoreNwkKey?relay                    6
     ??ZDApp_ResetTimerStart?relay                  6
     ??ZDApp_ResetTimerCancel?relay                 6
     ??ZDApp_LeaveCtrlInit?relay                    6
     ??ZDApp_LeaveCtrlSet?relay                     6
     ??ZDApp_LeaveCtrlReset?relay                   6
     ??ZDApp_LeaveCtrlBypass?relay                  6
     ??ZDApp_LeaveCtrlStartup?relay                 6
     ??ZDApp_LeaveReset?relay                       6
     ??ZDApp_LeaveUpdate?relay                      6
     ??ZDApp_NetworkDiscoveryReq?relay              6
     ??ZDApp_JoinReq?relay                          6
     ??ZDApp_DeviceConfigured?relay                 6
     ??ZDApp_SendEventMsg?relay                     6
     ??ZDApp_SendMsg?relay                          6
     ??ZDO_NetworkDiscoveryConfirmCB?relay          6
     ??ZDApp_NwkDescListProcessing?relay            6
     ??ZDO_NetworkFormationConfirmCB?relay          6
     ??ZDO_beaconNotifyIndCB?relay                  6
     ??ZDO_StartRouterConfirmCB?relay               6
     ??ZDO_JoinConfirmCB?relay                      6
     ??ZDO_AddrChangeIndicationCB?relay             6
     ??ZDO_JoinIndicationCB?relay                   6
     ??ZDO_ConcentratorIndicationCB?relay           6
     ??ZDO_LeaveCnf?relay                           6
     ??ZDO_LeaveInd?relay                           6
     ??ZDO_SyncIndicationCB?relay                   6
     ??ZDO_ManytoOneFailureIndicationCB?relay       6
     ??ZDO_PollConfirmCB?relay                      6
     ??AddrMgrWriteNVRequest?relay                  6
     ??ZDO_UpdateDeviceIndication?relay             6
     ??ZDApp_InMsgCB?relay                          6
     ??ZDApp_ChangeMatchDescRespPermission?relay    6
     ??ZDApp_NetworkInit?relay                      6
     ??ZDApp_NwkStateUpdateCB?relay                 6
     ??ZDApp_NodeProfileSync?relay                  6
     ??ZDApp_StartJoiningCycle?relay                6
     ??ZDApp_StopJoiningCycle?relay                 6
     ??ZDApp_AnnounceNewAddress?relay               6
     ??ZDApp_NVUpdate?relay                         6
     ??ZDApp_CoordStartPANIDConflictCB?relay        6
     ??ZDO_SrcRtgIndCB?relay                        6
     ??ZDApp_InitZdoCBFunc?relay                    6
     ??ZDO_RegisterForZdoCB?relay                   6
     ??ZDO_DeregisterForZdoCB?relay                 6

 
 5 370 bytes in segment BANKED_CODE
   390 bytes in segment BANK_RELAYS
    11 bytes in segment XDATA_I
    11 bytes in segment XDATA_ID
     8 bytes in segment XDATA_ROM_C
    54 bytes in segment XDATA_Z
 
 5 771 bytes of CODE  memory
     0 bytes of CONST memory (+ 8 bytes shared)
    65 bytes of XDATA memory

Errors: none
Warnings: none
